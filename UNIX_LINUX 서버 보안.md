# 1. 계정관리
## 1.1 root 계정 원격접속 제한
### 취약점 개요
#### 점검내용 
  * 시스템 정책에 root 계정의 원격터미널 접속차단 설정이 적용되어 있는지 점검
#### 점검목적
  * 관리자계정 탈취로 인한 시스템 장악을 방지하기 위해 외부 비인가자의 root 계정 접근 시도를 원천적으로 차단하기 위함
#### 보안위협
  * root 계정은 운영체제의 모든기능을 설정 및 변경이 가능하여(프로세스, 커널변경 등) root 계정을 탈취하여 외부에서 원격을 이용한 시스템 장악 및 각종 공격으로(무작위 대입 공격) 인한 root 계정 사용 불가 위협
#### 참고
  * root 계정: 여러 사용자가 사용하는 컴퓨터에서 모든 기능을 관리할 수 있는 총괄권한을 가진 유일한 특별 계정. 유닉스 시스템의 루트는 시스템 관리자인 운용 관리자(Super User)로서 윈도우의 Administrator 보다 높은 System 계정에 해당하며, 사용자 계정을 생성하거나 소프트웨어를 설치하고, 환경 및 설정을 변경하거나 시스템의 동작을 감시 및 제어할 수 있음
  * 무작위 대입 공격(Brute Force Attack): 특정한 암호를 풀기 위해 가능한 모든 값을 대입하는 공격 방법
  * 사전 대입 공격(Dictionary Attack): 사전에 있는 단어를 입력하여 암호를 알아내거나 암호를 해독하는 데 사용되는 공격 방법

### 점검대상 및 판단기준
#### 대상 
  * SOLARIS, LINUX, AIX, HP-UX 등
#### 판단기준
  * 양호 : 원격 터미널 서비스를 사용하지 않거나, 사용 시 root 직접 접속을 차단한 경우
  * 취약 : 원격 터미널 서비스 사용 시 root 직접 접속을 허용한 경우
#### 조치방법
  * 원격 접속 시 root 계정으로 바로 접속 할 수 없도록 설정파일 수정

### 점검 및 조치사례

||OS별 점검 파일 위치 및 점검 방법|
|:-:|:-|
|SOLARIS|**[Telnet]** </br>#cat /etc/default/login </br>CONSOLE=/dev/console </br>**[SSH]** </br>#cat /etc/ssh/sshd_config </br>PermitRootLogin no|
|LINUX|**[Telnet]** </br>#cat /etc/pam.d/login </br>auth required /lib/security/pam_securetty.so </br>#cat /etc/securetty </br>pts/0 ~ pts/x 관련 설정이 존재하지 않음 </br>**[SSH]** </br>#cat /etc/ssh/sshd_config </br>PermitRootLogin no|
|AIX|**[Telnet]** </br>#cat /etc/security/user </br>rlogin = false </br>**[SSH]** </br>#cat /etc/sshd_config </br>PermitRootLogin no|
|HP-UX|**[Telnet]** </br>#cat /etc/securetty </br>console </br>**[SSH]** </br>#cat /etc/sshd_config </br>PermitRootLogin no|
||위에 제시한 내용으로 설정되어 있을 경우 root 원격 접속이 차단됨 / 내용 설정에 대해서는 아래의 보안설정방법을 참고함|

**SOLARIS**   
[Telnet 서비스 사용시]   
Step 1) vi 편집기를 이용하여 "/etc/default/login" 파일 열기   
Step 2) 아래와 같이 주석 제거 또는, 신규 삽입   
(수정 전) #CONSOLE=/dev/console   
(수정 후) CONSOLE=/dev/console
</br>   
[SSH 서비스 사용시]   
Step 1) vi 편집기를 이용하여 "/etc/ssh/sshd_config" 파일 열기   
Step 2) 아래와 같이 주석 제거 또는, 신규 삽입   
(수정 전) #PermitRootLogin Yes   
(수정 후) PermitRootLogin No   
</br>   
**LINUX**   
[Telnet 서비스 사용시]   

![image](https://github.com/zzzangmans1/Technical_vulnerability_analysis_evaluation_method_detailed_guide/assets/52357235/e68f290a-fda9-4492-8d51-a0c882e0dcf3)

Step 1) "/etc/securetty" 파일에서 pts0/ ~ pts/x 설정 제거 또는, 주석 처리   

![image](https://github.com/zzzangmans1/Technical_vulnerability_analysis_evaluation_method_detailed_guide/assets/52357235/f4ecfb9f-9c18-4ec0-9443-8740e261a0f3)

Step 2) "/etc/pam.d/login" 파일 수정 또는, 신규 삽입   
(수정 전) #auth required /lib/security/pam_securetty.so   
(수정 후) auth required /lib/security/pam_securetty.so   
   
※ /etc/securetty : Telnet 접속 시 root 접근 제한 설정 파일   
"/etc/securetty" 파일 내 *pts/x 관련 설정이 존재하는 경우 PAM 모듈 설정과 관계없이 root 계정 접속을 허용하므로 반드시 "securetty"파일에서 pts/x 관련 설정 제거 필요   
   
*pts/0 ~ pts/x 설정 :   
![image](https://github.com/zzzangmans1/Technical_vulnerability_analysis_evaluation_method_detailed_guide/assets/52357235/97eb5838-95b8-4bea-87d2-dd046933e84f)
   
tty(terminal-teletype) : 서버와 연결된 모니터, 키보드 등을 통해 사용자가 콘솔로 직접 로그인함   
pts(pseudo-teminal, 가상터미널) : Telnet, SSH, 터미널 등을 이용하여 접속함   
</br>
[SSH 서비스 사용시]   
Step 1) vi 편집기를 이용하여 "/etc/ssh/sshd_config" 파일 열기   
Step 2) 아래와 같이 주석 제거 또는, 신규 삽입   
(수정 전) #PermitRootLogin Yes   
(수정 후) PermitRootLogin No

**AIX**   
[Telnet 서비스 사용시]   
Step 1) vi 편집기를 이용하여 "/etc/security/user" 파일 열기   
Step 2) rlogin 설정을 아래와 같이 수정 또는, 신규 삽입 (root 설정에 해당되는 부분 수정)   
(수정 전) rlogin = true   
(수정 후) rlogin = false   
rlogin(remote-login): 자주 접속하는 호스트에 대해 자동으로 원격 접속을 할 수 있도록 사용하는 명령어    
</br>   
[ssh 서비스 사용시]   
Step 1) vi 편집기를 이용하여 "/etc/ssh/sshd_config" 파일 열기   
Step 2) 아래와 같이 주석 제거 또는, 신규 삽입   
(수정 전) #PermitRootLogin Yes   
(수정 후) PermitRootLogin No   
</br>
**HP-UX**   
[Telnet 서비스 사용시]   
Step 1) vi 편집기를 이용하여 "/etc/securetty" 파일 열기   
Step 2) 아래와 같이 주석 제거 또는, 신규 삽입   
(수정 전) #console   
(수정 후) console
</br>
※ "/etc/securetty" 파일은 디폴트로 존재하지 않으므로 /etc 디렉터리 내에 "securetty" 파일이 존재하지 않는 경우 새로 생성한 후 적용함 (※ vi 편집기를 사용한 파일 내용 수정: 부록 참고)   
#vi /etc/securetty   
</br>
[SSH 서비스 사용시]   
Step 1) vi 편집기를 이용하여 "/etc/ssh/sshd_config" 파일 열기   
Step 2) 아래와 같이 주석 제거 또는, 신규 삽입   
(수정 전) #PermitRootLogin Yes   
(수정 후) PermitRootLogin No   

## 1.2 패스워드 복잡성 설정
### 취약점 개요
#### 점검내용 
 * 시스템 정책에 사용자 계정(root 및 일반계정 모두 해당) 패스워드 복잡성 관련 설정이 되어 있는지 점검
#### 점검목적
 * 패스워드 복잡성 관련 정책이 설정되어 있는지 점검하여 비인가지의 공격(무작위 대입 공격, 사전 대입 공격 등)에 대비가 되어 있는지 확인하기 위함
#### 보안위협
 * 복잡성 설정이 되어있지 않은 패스워드는 사회공학적인 유추가 가능 할 수 있으며 암호화된 패스워드 해시값을 무작위 대입공격, 사전대입 공격 등으로 단시간에 패스워드 크렉이 가능함
####  참고
 ※ 패스워드 복잡성: 사용자 패스워드 설정 시 영문(대문자, 소문자), 숫자, 특수문자가 혼합된 일정 길이 이상으로 패스워드를 설정하는 방법
### 점검대상 및 판단기준
#### 대상
 * SOLARIS, LINUX, AIX, HP-UX 등
#### 판단기준
 * 양호 : 패스워드 최소길이 8자리 이상, 영문,숫자,특수문자 최소 입력 기능이 설정된 경우
 * 취약 : 패스워드 최소길이 8자리 이하로 설정된 경우
#### 조치방법
 * 계정과 유사하지 않은 8자 이상의 영문, 숫자, 특수문자의 조합으로 암호 설정 및 패스워드 복잡성 옵션 설정
### 점검 및 조치 사례
||OS별 점검 파일 위치 및 점검 방법|
|:-:|:-|
|SOLARIS|/etc/default/passwd|
|LINUX - RHEL5|/etc/pam.d/system-auth|
|LINUX - RHEL7|/etc/security/pwquality.conf|
|AIX|/etc/security/user|
|HP-UX|/etc/default/security|
||OS별 점검 파일을 열어 패스워드 복잡도 관련 설정 확인 후 아래의 보안설정방법에 따라 설정을 변경함(최소길이, 특수문자, 숫자 포함 등 설정|

* SOLARIS, LINUX, AIX, HP-UX
<부적절한 패스워드 유형>
1. 사전에 나오는 단어나 이들의 조합
2. 길이가 너무 짧거나, NULL인 패스워드
3. 키보드 자판의 일련의 나열 (예) abcd, qwert, etc
4. 사용자 계정 정보에서 유추 가능한 단어들

<패스워드 관리 방법>
1. 영문, 숫자, 특수문자를 조합하여 계정명과 상이한 8자 이상의 패스워드 설정
2. 시스템마다 상이한 패스워드 사용
3. 패스워드를 기록해 놓을 경우 변형하여 기록

<패스워드 설정 파일 정리>   
**SOLARIS [10 이상버젼]**   
Step 1) 패스워드 복잡성 설정 (/etc/default/passwd)   

|권장 값|기능|설명|
|-|-|-|
|HISTORY=10|이전 패스워드 기억 개수|이전 10개의 암호를 기억함|
|MINDIFF=4|이전 암호와 차이|이전 암호와 4자 이상 차이 요구|
|MINALPHA=1|최소 문자 요구|최소 1자 이상 문자 요구|
|MINNONALPHA=1|최소 숫자 또는 특수문자 요구|숫자 또는 특수문자 1자 이상 요구|
|MINUPPER=1|최소 대문자 요구|최소 1자 이상 대문자 요구|
|MINLOWER=1|최소 소문자 요구|최소 1자 이상 소문자 요구|
|MAXREPEATS=0|연속문자 사용 허용|0일 경우 문자 연속 사용이 불가|
|MINSPECIAL=1|최소 특수문자 요구|최소 1자 이상 특수문자 요구|
|MINDIGIT=1|최소 숫자 요구|최소 1자 이상 숫자 요구|
|NAMECHECK=YES|아이디와 패스워드 동일 검증|아이디와 동일한 패스워드 사용 불가|
|||※ DIGIT 이나 SPECAIL 이 설정되어 있을 경우 NONALPHA 설정 안 됨|

**Linux - RHEL5**   
Step 1) 패스워드 복잡성 설정 파일 확인 (/etc/pam.d/system-auth, /etc/login.defs 내용을 내부 정책에 맞도록 편집   
Step 2) /etc/pam.d/system-auth 파일 설정   
 - 패스워드 정책 설정 예시
```
vi /etc/pam.d/system-auth

password requisite /lib/security/$ISA/pam_cracklib.so retry=3 minlen=8 lcredit=-1 ucredit=-1 dcredit=-1 ocredit=-1
```

**LINUX - RHEL7**   
Step 1) 패스워드 복잡성 설정 파일 확인 (/etc/security/pwquality.conf 파일 수정)   
 - 패스워드 정책 설정 예시
```
vi /etc/security/pwquality.conf

password requisite pam_cracklib.so try_first_pass retry=3 minlen=8 lcredit=-1 ucredit=-1 dcredit=-1 ocredit=-1
```
※ 각 변수에 대한 설명 / 각 항목에서 -1 값은 반드시 해당하는 문자를 포함시켜야 함   

|권장 값|기능|설명|
|-|-|-|
|lcredit=-1|최소 소문자 요구|소문자 최소 1자 이상 요구|
|ucredit=-1|최소 대문자 요구|최소 대문자 1자 이상 요구|
|dcredit=-1|최소 숫자 요구|최소 숫자 1자 이상 요구|
|ocredit=-1|최소 특수문자 요구|최소 특수문자 1자 이상 요구|
|minlen=8|최소 패스워드 길이 설정|최소 8자리 이상 설정|
|difok=N|기존 패스워드와 비교|기본값 10(50%)|

**AIX**   
Step 1) 패스워드 복잡성 설정 파일 확인 (/etc/security/user 파일 내용을 내부 정책에 맞도록 설정)   

|권장 값|기능|설명|
|-|-|-|
|dictionlist=/usr/share/dict/words|unix 명령어 포함 여부|검증경로 설정|
|histextpire=26|동일한 패스워드 재사용 기간|26주 후 사용가능|
|histsize=10|이전 패스워드 기억 개수|이전 10개 패스워드 기억(사용불가)|
|maxrepeats=2|반복 가능한 동일 문자의 최대 수|2개이상 동일문자 사용 금지|
|minalpha=2|최소 알파벳 문자 포함|2개 이상 알파벳 사용|
|minother=2|최소 알파벳 문자 이외의 문자 수|2개 이상 숫자, 특수문자 사용|
|mindiff=4|이전 패스워드와 동일문자 수|이전 패스워드와 4개까지 동일문자 사용|
|minlen=8|패스워드 최소 길이|8자리 이상 패스워드 작성|

**HP-UX**   
Step 1) 패스워드 복잡성 설정 (/etc/default/security 내용을 내부 정책에 맞도록 편집)   

|권장 값|기능|설명|
|-|-|-|
|MIN_PASSWORDE_LENGTH=8|암호의 최소 길이|최소 8자리 패스워드|
|PASSWORD_MIN_UPPER_CASE_CHARS=1|최소 대문자 필요 개수|최소 1개의 대문자|
|PASSWORD_MIN_LOWER_CASE_CHARS=1|최소 소문자 필요 개수|최소 1개의 소문자|
|PASSWORD_MIN_DIGIT_CHARS=1|최소 숫자 필요 개수|최소 1개의 숫자|
|PASSWORD_MIN_SPECIAL_CHARS=1|최소 특수문자 필요 개수|최소 1개의 특수문자|

* 조치 시 영향 : 패스워드 변경 시 Web, WAS, DB연동 구간에서 문제가 발생할 수 있으므로 연동 구간에 미칠 수 있는 영향을 고려하여 적용 필요

## 1.3 계정 잠금 임계값 설정

||취약점 개요|
|:-:|:-|
|점검내용|사용자 계정 로그인 실패 시 계정잠금 임계값이 설정되어 있는지 점검|
|점검목적|계정탈취 목적의 무작위 대입 공격 시 해당 계정을 잠금하여 인증 요청에 응답하는 리소스 낭비를 차단하고 대입 공격으로 인한 비밀번호 노출 공격을 무력화하기 위함|
|보안위협|패스워드 탈취 공격(무작위 대입 공격, 사전 대입 공격, 추측 공격 등)의 인증 요청에 대해 설정된 패스워드와 일치할 때까지 지속적으로 응답하여 해당 계정의 패스워드가 유출될 수 있음 |
|참고|※ 사용자 로그인 실패 임계 값: 시스템에 로그인 시 몇 번의 로그인 실패에 로그인을 차단할 것인지 결정하는 값|
||점검대상 및 판단기준|
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 계정 잠금 임계값이 10회 이하의 값으로 설정되어 있는 경우 </br>취약 : 계정 잠금 임계값이 설정되어 있지 않거나, 10회 이하의 값으로 설정되지 않은 경우|
|조치방법|계정 잠금 임계값을 10회 이하로 설정|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|

* **SOLARIS**
  * **- SOLARIS 5.9 이하 버전 -**
  * Step 1) vi 편집기를 이용하여 "/etc/default/login" 파일 열기
  * Step 2) 아래와 같이 수전 또는, 신규 삽입
    * (수정 전) #RETRIES=2
    * (수정 후) RETRIES=10 
  * **- SOLARIS 5.9 이상 버전 -** 
  * Step 1) vi 편집기를 이용하여 "/etc/default/login" 파일 열기
  * Step 2) 아래와 같이 수정 또는, 신규 삽입 (계정 잠금 횟수 설정)
    * (수정 전) #RETRIES=2
    * (수정 후) RETRIES=10
  * Step 3) vi 편집기를 이용하여 "/etc/security/policy.conf" 파일 열기
  * Step 4) 아래와 같이 수정 또는, 신규 삽입 (계정 잠금 정책사용 설정)
    * (수정 전) #LOCK_AFTER_RETRIES=NO
    * (수정 후) LOCK_AFTER_RETRIES=YES
* **LINUX**
  * Step 1) vi 편집기를 이용하여 "/etc/pam.d/system-auth" 파일 열기
  * Step 2) 아래와 같이 수정 또는, 신규 삽입
    * auth required /lib/security/pam_tally.so deny=5 unlock_time=120 no_magic_root
    * account required /lib/security/pam_tally.so no_magic_root reset

![image](https://github.com/zzzangmans1/Technical_vulnerability_analysis_evaluation_method_detailed_guide/assets/52357235/a3b4623d-ac04-4174-ad76-0aeb8a15954e)

|옵션|설명|
|:-:|:-|
|no_magic_root|root에게는 패스워드 잠금 설정을 적용하지 않음|
|deny=5|5회 입력 실패 시 패스워드 잠금|
|unlock_time|계정 잠김 후 마지막 게정 실패 시간부터 설정된 시간이 지나면 자동 계정 잠김 해제 (단위:초)|
|reset|접속 시도 성공 시 실패한 횟수 초기화|

* **AIX**
  * Step 1) vi 편집기를이용하여 "/etc/security/user" 파일 열기
  * Step 2) 아래와 같이 수정 또는, 신규 삽입
    * (수정 전) loginretries = 0
    * (수정 후) loginretries = 10

* **HP-UX**
  * **- HP-UX 11v2 이하 버전 -**
  * Step 1) vi 편집기를 이용하여 /tcb/files/auth/system/default 파일 열기
  * Step 2) 아래와 같이 수정 또는, 신규 삽입
    * (수정 전) u_maxtries#
    * (수정 후) u_maxtries#10

※ HP-UX 서버에 계정 잠금 정책 설정을 위해서는 HP-UX 서버가 Trusted Mode로 동작하고 있어야하므로 Trusted Mode로 전환한 후 잠금 정책 적용

  * **- HP-UX 11v3 이상 버전 -**
  * Step 1) vi 편집기를 이용하여 /etc/default/security 팡리 열기
  * Step 2) 아래와 같이 수정 또는, 신규 삽입
    * (수정 전) #AUTH_MAXTRIES=0
    * (수정 후) AUTH_MAXTRIES=10

※ Standard and Shadow modes only

### 조치 시 영향
HP-UX 경우 Trusted Mode로 전환 시 파일시스템 구조가 변경되어 운영 중인 서비스에 문제가 발생할 수 있으므로 충분한 테스트를 거친 후 Trusted Mode로의 전환이 필요함   
Linux의 pam.d/system-auth의 내용 수정 시 해당 라이브러리가 실제 존재하는지 확인 필요(/lib/security/pam_tally.so - 파일 미존재시 모든 계정 로그인 안되는 장애가 발생될수 있음) 

## 1.4 패스워드 파일 보호

||취약점 개요|
|:-:|:-|
|점검내용|시스템의 사용자 계정(root, 일반계정) 정보가저장된 파일(예 /etc/passwd, /etc/shadow)에 사용자 계정 패스워드가 암호화되어 있는지 점검|
|점검목적|일부 오래된 시스템의 경우 /etc/passwd 파일에 패스워드가 평문으로 저장되므로 사용자 계정 패스워드가 암호화되어 있는지 점검하여 비인가자의 패스워드 파일 접근 시에도 사용자 계정 패스워드가 안전하게 관리되고 있는지 확인하기 위함|
|보안위협|사용자 계정 패스워드가 저장된 파일이 유출 또는 탈취 시 평문으로 저장된 패스워드 정보가 노출될 수 있음|
||점검대상 및 판단기준|
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 쉐도우 패스워드를 사용하거나, 패스워드를 암호화하여 저장하는 경우 </br>취약 : 쉐도우 패스워드를 사용하지 않고, 패스워드를 암호화하여 저장하지 않는 경우|
|조치방법|패스워드 암호화 저장, 관리 설정 적용|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|

* **SOLARIS, LINUX**
  * Step 1) pwconv ---> 쉐도우 패스워드 정책 적용 방법
  * Step 2) pwunconv ---> 일반 패스워드 정책 적용 방법

* **AIX**
  * Step 1) #cat /etc/security/passwd
  * Step 2) 패스워드 암호화 여부 확인

※ AIX 서버는 기본적으로 "/etc/security/passwd" 파일에 패스워드를 암호화하여 저장, 관리

* **HP-UX**
  * HP-UX 서버는 Trusted Mode로 전환할 경우 패스워드를 암호화하여 "/tcb/files/auth" 디렉터리에 계정 이니셜과 계정 이름에 따라 파일로 저장,관리할 수 있으므로 Trusted Mode인지 확인 후 UnTrusted Mode인 경우 모드를 전환함
  * Step 1) Trusted Mode 전환 방법: root 계정으로 로그인한 후 아래 명령 수행
    * /etc/tsconvert 
  * Step 2) UnTrusted Mode 전환 방법: root 계정으로 로그인한 후 아래 명령 수행
    * /etc/tsconvert -r2

### 조치 시 영향
HP-UX 경우 Trusted Mode로 전환 시 파일시스템 구조가 변경되어 운영 중인 서비스에 문제가 발생할 수 있으므로 충분한 테스트를 거친 후 Trusted Mode로의 전환 필요

# 2. 파일 및 디렉토리 관리
## 2.1 root홈, 패스 디렉터리 권한 및 패스 설정

||취약점 개요|
|:-:|:-|
|점검내용|root 계정의 PATH 환경변수에 "."이(마침표) 포함되어 있는지 점검|
|점검목적|비인가자가 불법적으로 생성한 디렉터리 및 명령어를 우선으로 실행되지 않도록 설정하기 위해 환경변수 점검이 필요함|
|보안위협|root 계정의 PATH(환경변수)에 정상적인 관리자 명령어(예: ls, mv, cp 등)의 디렉터리 경로 보다 현재 디렉터리를 지칭하는 "." 표시가 우선하면 현재 디렉터리에 변조된 명령어를 삽입하여 관리자 명령어 입력 시 악의적인 기능이 실행될 수 있음|
|참고|※ 환경변수: 프로세스가 컴퓨터에서 동작하는 방식에 영향을 미치는 동적인 값들의 집합으로 Path 환경변수는 실행파일을 찾는 경로에 대한 변수|
||점검대상 및 판단기준|
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : PATH 환경변수에 "." 이 맨 앞이나 중간에 포함되지 않은 경우 </br>취약 : PATH 환경변수에 "." 이 맨 앞이나 중간에 포함되어 있는 경우|
|조치방법|root 계정의 환경변수 설정파일("/.profile", "/.cshrc" 등)과 "/etc/profile" 등에서 PATH 환경변수에 포함되어 있는 현재 디렉터리를 나타내는 "."을 PATH 환경변수의 마지막으로 이동 </br>※"/etc/profile", root 계정의 환경변수 파일, 일반계정의 환경변수 파일을 순차적으로 검색하여 확인|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|

## SHELL에 따라 참조되는 환경 설정파일
* /bin/sh : /etc/profile, $HOME/.profile
* /bin/csh : $HOME/.cshrc, $HOME/.login, /etc/.login
* /bin/ksh : /etc/profile, $HOME/.profile, $HOME/kshrc
* /bin/bash : /etc/profile, $HOME/.bash_profile

![image](https://github.com/zzzangmans1/Technical_vulnerability_analysis_evaluation_method_detailed_guide/assets/52357235/9798261a-6380-4d5b-a44d-6f7823e4b02d)

* **SOLARIS, LINUX, AIX, HP-UX**
  * Step 1) vi 편집기를 이용하여 root 계정의 설정파일(~/.profile 과 /etc/profile) 열기
    * vi /etc/profile
  * Step 2) 아래와 같이 수정
    * (수정 전) PATH=.:$PATH:$HOME/bin
    * (수정 후) PATH=$PATH:$HOME/bin:.

## 2.2 파일 및 디렉터리 소유자 설정

||취약점 개요|
|:-:|:-|
|점검내용|소유자 불분명한 파일이나 디렉터리가 존재하는지 여부를 점검|
|점검목적|소유자가 존재하지 않는 파일 및 디렉터리를 삭제 및 관리하여 임의의 사용자가 해당파일을 열람, 수정하는 행위를 사전에 차단하기 위함|
|보안위협|소유자가 존재하지 않는 파일의 UID와 동일한 값으로 특정계정의 UID값을 변경하면 해당 파일의 소유자가 되어 모든 작업이 가능함|
|참고|※ 소유자가 존재하지 않는 파일 및 디렉터리는 퇴직자의 자료이거나 관리 소홀로 인해 생긴 파일인 경우 또는 해킹으로 인한 공격자가 만들어 놓은 악의적인 파일인 경우가 있음|
||점검대상 및 판단기준|
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 소유자가 존재하지 않는 파일 및 디렉터리가 존재하지 않는 경우 </br>취약 : 소유자가 존재하지 않는 파일 및 디렉터리가 존재하는 경우|
|조치방법|소유자가 존재하지 않는 파일 및 디렉터리 삭제 또는, 소유자 변경|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, AIX|소유자가 nouser, nogroup인 파일이나 디렉터리 검색 </br>find / -nouser -o -nogroup -xdev -ls 2 > /dev/null|
|HP-UX|find / \( -nouser -o -nogroup \) -xdev -exec ls -al {} \; 2> /dev/null|
|LINUX|find / -nouser -o -nogroup|
||※ 소유자 또는 그룹이 없는 파일은 파일 속성 해당 필드에 숫자로 표시됨 </br>예시) rwxr-xr-x 500 500 test.txt </br>※ 소유자가 nouser, nogroup인 파일이나 디렉터리 존재하는 경우 아래의 보안설정방법에 따라 디렉터리 및 파일 삭제 또는, 소유자 및 그룹을 변경함|

* **SOLARIS, LINUX, AIX, HP-UX**
  * Step 1) 소유자가 존재하지 않는 파일이나 디렉터리가 불필요한 경우 rm 명령으로 삭제
    * rm <file_name>
    * rm <directory_name>
  * Step 2) 필요한 경우 chown 명령으로 소유자 및 그룹 변경
    * chown <user_name>:<group_name> <file_name>

## 2.3 /etc/passwd 파일 소유자 및 권한 설정

||취약점 개요|
|:-:|:-|
|점검내용|/etc/passwd 파일 권한 적절성 점검|
|점검목적| /etc/passwd 파일의 임의적인 변경을 차단하기 위함을 통해 비인가자가 권한 상승하는 것을 막기 위함|
|보안위협|관리자(root) 외 사용자가 "/etc/passwd" 파일의 사용자 정보를 변조하여 shell 변경, 사용자 추가/삭제 등 root를 포함한 사용자 권한 획득 가능|
|참고|※ /etc/passwd: 사용자의 ID, 패스워드, UID, GID, 홈 디렉터리, 쉘 정보를 담고 있는 파일|
||점검대상 및 판단기준|
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : /etc/passwd 파일의 소유자가 root이고, 권한이 644 이하인 경우 </br>취약 : /etc/passwd 파일의 소유자가 root가 아니거나, 권한이 644 이하가 아닌 경우|
|조치방법|"/etc/passwd" 파일의 소유자 및 권한 변경 (소유자 root, 권한 644)|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|"/etc/passwd" 파일의 소유자 및 권한 확인 </br>#ls -al /etc/passwd </br>rw-r--r-- root <passwd 파일>|
||"passwd" 파일의 소유자가 root가 아니거나 파일의 권한이 644 이하가 아닌 경우 아래의 보안설정방법에 따라 설정을 변경함|

* **SOLARIS, LINUX, AIX, HP-UX**
* "/etc/passwd" 파일의 소유자 및 권한 변경 (소유자 root, 권한 644)
  * #chown root /etc/passwd
  * #chmod 644 /etc/passwd

## 2.4 /etc/shadow 파일 소유자 및 권한 설정

||취약점 개요|
|:-:|:-|
|점검내용|/etc/shadow 파일 권한 적절성 점검|
|점검목적|/etc/shadow 파일을 관리자만 제어할 수 있게 하여 비인가자들의 접근을 차단하도록 shadow 파일 소유자 및 권한을 관리해야함|
|보안위협|shadow파일은 패스워드를 암호화하여 저장하는 파일이며 해당 파일의 암호화된 해쉬값을 복호화하여(크래킹) 비밀번호를 탈취할 수 있음|
|참고|※ /etc/shadow: 시스템에 등록된 모든 계정의 패스워드를 암호화된 형태로 저장 및 관리하고 있는 파일|
||점검대상 및 판단기준|
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : /etc/shadow 파일의 소유자가 root이고, 권한이 400 이하인 경우 </br> 취약 : /etc/shadow 파일의 소유자가 root가 아니거나, 권한이 400 이하가 아닌 경우|
|조치방법|"/etc/shadow" 파일의 소유자 및 권한 변경 (소유자 root, 권한 400)|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX|# ls -l /etc/shadow (shadow 파일 구조: 부록 참고) </br>r-------- root <shadow 파일>|
|AIX|# ls -ld /etc/security/passwd (passwd 파일 구조: 부록 참고) </br>r-------- root <passwd 파일>|
|HP-UX|# ls -ld /tcb/files/auth </br>r-------- root <auth 디렉터리>|
||위에 제시된 파일 및 디렉터리의 소유자가 root가 아니거나 파일의 권한이 400이 아닌 경우 아래의 보안설정방법에 따라 설정을 변경함|

* **SOLARIS, LINUX**
* Step 1) "/etc/shadow" 파일의 소유자 및 권한 확인
  * #ls -al /etc/shadow
* Step 2) "/etc/shadow" 파일의 소유자 및 권한 변경 (소유자 root, 권한 400)
  * #chown root /etc/shadow
  * #chmod 400 /etc/shadow

* **AIX**
AIX 서버는 기본적으로 "/etc/security/passwd" 파일에 패스워드를 암호화하여 저장, 관리하므로 해당 디렉터리 권한을 기준에 맞게 설정
* Step 1) /etc/security/passwd 디렉터리의 소유자 및 권한 확인
  * #ls -ld /etc/security/passwd
* Step 2) "/etc/security/passwd" 파일의 소유자 및 권한 변경 (소유자 root, 권한 400)
  * #chown root /etc/security/passwd
  * #chmod 400 /etc/security/passwd

* **HP-UX**
HP-UX 서버는 Trusted Mode로 전환할 경우 패스워드를 암호화하여 "/tcb/files/auth" 디렉터리에 계정 이니셜과 계정명에 따라 파일로 저장, 관리 가능
* Step 1) /tcb/files/auth 디렉터리의 소유자 및 권한 확인
  * #ls -ld /tcb/files/auth
* Step 2) "/tcb/file/auth" 파일의 소유자 및 권한 변경 (소유자 root, 권한 400)
  * #chown root /tcb/files/auth
  * #chmod 400 /tcb/files/auth
