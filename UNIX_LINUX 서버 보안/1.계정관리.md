# 1. 계정관리
## 1.1 root 계정 원격접속 제한
### 취약점 개요
#### 점검내용 
  * 시스템 정책에 root 계정의 원격터미널 접속차단 설정이 적용되어 있는지 점검
#### 점검목적
  * 관리자계정 탈취로 인한 시스템 장악을 방지하기 위해 외부 비인가자의 root 계정 접근 시도를 원천적으로 차단하기 위함
#### 보안위협
  * root 계정은 운영체제의 모든기능을 설정 및 변경이 가능하여(프로세스, 커널변경 등) root 계정을 탈취하여 외부에서 원격을 이용한 시스템 장악 및 각종 공격으로(무작위 대입 공격) 인한 root 계정 사용 불가 위협
#### 참고
  * root 계정: 여러 사용자가 사용하는 컴퓨터에서 모든 기능을 관리할 수 있는 총괄권한을 가진 유일한 특별 계정. 유닉스 시스템의 루트는 시스템 관리자인 운용 관리자(Super User)로서 윈도우의 Administrator 보다 높은 System 계정에 해당하며, 사용자 계정을 생성하거나 소프트웨어를 설치하고, 환경 및 설정을 변경하거나 시스템의 동작을 감시 및 제어할 수 있음
  * 무작위 대입 공격(Brute Force Attack): 특정한 암호를 풀기 위해 가능한 모든 값을 대입하는 공격 방법
  * 사전 대입 공격(Dictionary Attack): 사전에 있는 단어를 입력하여 암호를 알아내거나 암호를 해독하는 데 사용되는 공격 방법

### 점검대상 및 판단기준
#### 대상 
  * SOLARIS, LINUX, AIX, HP-UX 등
#### 판단기준
  * 양호 : 원격 터미널 서비스를 사용하지 않거나, 사용 시 root 직접 접속을 차단한 경우
  * 취약 : 원격 터미널 서비스 사용 시 root 직접 접속을 허용한 경우
#### 조치방법
  * 원격 접속 시 root 계정으로 바로 접속 할 수 없도록 설정파일 수정

### 점검 및 조치사례

||OS별 점검 파일 위치 및 점검 방법|
|:-:|:-|
|SOLARIS|**[Telnet]** </br>#cat /etc/default/login </br>CONSOLE=/dev/console </br>**[SSH]** </br>#cat /etc/ssh/sshd_config </br>PermitRootLogin no|
|LINUX|**[Telnet]** </br>#cat /etc/pam.d/login </br>auth required /lib/security/pam_securetty.so </br>#cat /etc/securetty </br>pts/0 ~ pts/x 관련 설정이 존재하지 않음 </br>**[SSH]** </br>#cat /etc/ssh/sshd_config </br>PermitRootLogin no|
|AIX|**[Telnet]** </br>#cat /etc/security/user </br>rlogin = false </br>**[SSH]** </br>#cat /etc/sshd_config </br>PermitRootLogin no|
|HP-UX|**[Telnet]** </br>#cat /etc/securetty </br>console </br>**[SSH]** </br>#cat /etc/sshd_config </br>PermitRootLogin no|
||위에 제시한 내용으로 설정되어 있을 경우 root 원격 접속이 차단됨 / 내용 설정에 대해서는 아래의 보안설정방법을 참고함|

**SOLARIS**   
[Telnet 서비스 사용시]   
Step 1) vi 편집기를 이용하여 "/etc/default/login" 파일 열기   
Step 2) 아래와 같이 주석 제거 또는, 신규 삽입   
(수정 전) #CONSOLE=/dev/console   
(수정 후) CONSOLE=/dev/console
</br>   
[SSH 서비스 사용시]   
Step 1) vi 편집기를 이용하여 "/etc/ssh/sshd_config" 파일 열기   
Step 2) 아래와 같이 주석 제거 또는, 신규 삽입   
(수정 전) #PermitRootLogin Yes   
(수정 후) PermitRootLogin No   
</br>   
**LINUX**   
[Telnet 서비스 사용시]   

![image](https://github.com/zzzangmans1/Technical_vulnerability_analysis_evaluation_method_detailed_guide/assets/52357235/e68f290a-fda9-4492-8d51-a0c882e0dcf3)

Step 1) "/etc/securetty" 파일에서 pts0/ ~ pts/x 설정 제거 또는, 주석 처리   

![image](https://github.com/zzzangmans1/Technical_vulnerability_analysis_evaluation_method_detailed_guide/assets/52357235/f4ecfb9f-9c18-4ec0-9443-8740e261a0f3)

Step 2) "/etc/pam.d/login" 파일 수정 또는, 신규 삽입   
(수정 전) #auth required /lib/security/pam_securetty.so   
(수정 후) auth required /lib/security/pam_securetty.so   
   
※ /etc/securetty : Telnet 접속 시 root 접근 제한 설정 파일   
"/etc/securetty" 파일 내 *pts/x 관련 설정이 존재하는 경우 PAM 모듈 설정과 관계없이 root 계정 접속을 허용하므로 반드시 "securetty"파일에서 pts/x 관련 설정 제거 필요   
   
*pts/0 ~ pts/x 설정 :   
![image](https://github.com/zzzangmans1/Technical_vulnerability_analysis_evaluation_method_detailed_guide/assets/52357235/97eb5838-95b8-4bea-87d2-dd046933e84f)
   
tty(terminal-teletype) : 서버와 연결된 모니터, 키보드 등을 통해 사용자가 콘솔로 직접 로그인함   
pts(pseudo-teminal, 가상터미널) : Telnet, SSH, 터미널 등을 이용하여 접속함   
</br>
[SSH 서비스 사용시]   
Step 1) vi 편집기를 이용하여 "/etc/ssh/sshd_config" 파일 열기   
Step 2) 아래와 같이 주석 제거 또는, 신규 삽입   
(수정 전) #PermitRootLogin Yes   
(수정 후) PermitRootLogin No

**AIX**   
[Telnet 서비스 사용시]   
Step 1) vi 편집기를 이용하여 "/etc/security/user" 파일 열기   
Step 2) rlogin 설정을 아래와 같이 수정 또는, 신규 삽입 (root 설정에 해당되는 부분 수정)   
(수정 전) rlogin = true   
(수정 후) rlogin = false   
rlogin(remote-login): 자주 접속하는 호스트에 대해 자동으로 원격 접속을 할 수 있도록 사용하는 명령어    
</br>   
[ssh 서비스 사용시]   
Step 1) vi 편집기를 이용하여 "/etc/ssh/sshd_config" 파일 열기   
Step 2) 아래와 같이 주석 제거 또는, 신규 삽입   
(수정 전) #PermitRootLogin Yes   
(수정 후) PermitRootLogin No   
</br>
**HP-UX**   
[Telnet 서비스 사용시]   
Step 1) vi 편집기를 이용하여 "/etc/securetty" 파일 열기   
Step 2) 아래와 같이 주석 제거 또는, 신규 삽입   
(수정 전) #console   
(수정 후) console
</br>
※ "/etc/securetty" 파일은 디폴트로 존재하지 않으므로 /etc 디렉터리 내에 "securetty" 파일이 존재하지 않는 경우 새로 생성한 후 적용함 (※ vi 편집기를 사용한 파일 내용 수정: 부록 참고)   
#vi /etc/securetty   
</br>
[SSH 서비스 사용시]   
Step 1) vi 편집기를 이용하여 "/etc/ssh/sshd_config" 파일 열기   
Step 2) 아래와 같이 주석 제거 또는, 신규 삽입   
(수정 전) #PermitRootLogin Yes   
(수정 후) PermitRootLogin No   

## 1.2 패스워드 복잡성 설정
### 취약점 개요
#### 점검내용 
 * 시스템 정책에 사용자 계정(root 및 일반계정 모두 해당) 패스워드 복잡성 관련 설정이 되어 있는지 점검
#### 점검목적
 * 패스워드 복잡성 관련 정책이 설정되어 있는지 점검하여 비인가지의 공격(무작위 대입 공격, 사전 대입 공격 등)에 대비가 되어 있는지 확인하기 위함
#### 보안위협
 * 복잡성 설정이 되어있지 않은 패스워드는 사회공학적인 유추가 가능 할 수 있으며 암호화된 패스워드 해시값을 무작위 대입공격, 사전대입 공격 등으로 단시간에 패스워드 크렉이 가능함
####  참고
 ※ 패스워드 복잡성: 사용자 패스워드 설정 시 영문(대문자, 소문자), 숫자, 특수문자가 혼합된 일정 길이 이상으로 패스워드를 설정하는 방법
### 점검대상 및 판단기준
#### 대상
 * SOLARIS, LINUX, AIX, HP-UX 등
#### 판단기준
 * 양호 : 패스워드 최소길이 8자리 이상, 영문,숫자,특수문자 최소 입력 기능이 설정된 경우
 * 취약 : 패스워드 최소길이 8자리 이하로 설정된 경우
#### 조치방법
 * 계정과 유사하지 않은 8자 이상의 영문, 숫자, 특수문자의 조합으로 암호 설정 및 패스워드 복잡성 옵션 설정
### 점검 및 조치 사례
||OS별 점검 파일 위치 및 점검 방법|
|:-:|:-|
|SOLARIS|/etc/default/passwd|
|LINUX - RHEL5|/etc/pam.d/system-auth|
|LINUX - RHEL7|/etc/security/pwquality.conf|
|AIX|/etc/security/user|
|HP-UX|/etc/default/security|
||OS별 점검 파일을 열어 패스워드 복잡도 관련 설정 확인 후 아래의 보안설정방법에 따라 설정을 변경함(최소길이, 특수문자, 숫자 포함 등 설정|

* SOLARIS, LINUX, AIX, HP-UX
<부적절한 패스워드 유형>
1. 사전에 나오는 단어나 이들의 조합
2. 길이가 너무 짧거나, NULL인 패스워드
3. 키보드 자판의 일련의 나열 (예) abcd, qwert, etc
4. 사용자 계정 정보에서 유추 가능한 단어들

<패스워드 관리 방법>
1. 영문, 숫자, 특수문자를 조합하여 계정명과 상이한 8자 이상의 패스워드 설정
2. 시스템마다 상이한 패스워드 사용
3. 패스워드를 기록해 놓을 경우 변형하여 기록

<패스워드 설정 파일 정리>   
**SOLARIS [10 이상버젼]**   
Step 1) 패스워드 복잡성 설정 (/etc/default/passwd)   

|권장 값|기능|설명|
|-|-|-|
|HISTORY=10|이전 패스워드 기억 개수|이전 10개의 암호를 기억함|
|MINDIFF=4|이전 암호와 차이|이전 암호와 4자 이상 차이 요구|
|MINALPHA=1|최소 문자 요구|최소 1자 이상 문자 요구|
|MINNONALPHA=1|최소 숫자 또는 특수문자 요구|숫자 또는 특수문자 1자 이상 요구|
|MINUPPER=1|최소 대문자 요구|최소 1자 이상 대문자 요구|
|MINLOWER=1|최소 소문자 요구|최소 1자 이상 소문자 요구|
|MAXREPEATS=0|연속문자 사용 허용|0일 경우 문자 연속 사용이 불가|
|MINSPECIAL=1|최소 특수문자 요구|최소 1자 이상 특수문자 요구|
|MINDIGIT=1|최소 숫자 요구|최소 1자 이상 숫자 요구|
|NAMECHECK=YES|아이디와 패스워드 동일 검증|아이디와 동일한 패스워드 사용 불가|
|||※ DIGIT 이나 SPECAIL 이 설정되어 있을 경우 NONALPHA 설정 안 됨|

**Linux - RHEL5**   
Step 1) 패스워드 복잡성 설정 파일 확인 (/etc/pam.d/system-auth, /etc/login.defs 내용을 내부 정책에 맞도록 편집   
Step 2) /etc/pam.d/system-auth 파일 설정   
 - 패스워드 정책 설정 예시
```
vi /etc/pam.d/system-auth

password requisite /lib/security/$ISA/pam_cracklib.so retry=3 minlen=8 lcredit=-1 ucredit=-1 dcredit=-1 ocredit=-1
```

**LINUX - RHEL7**   
Step 1) 패스워드 복잡성 설정 파일 확인 (/etc/security/pwquality.conf 파일 수정)   
 - 패스워드 정책 설정 예시
```
vi /etc/security/pwquality.conf

password requisite pam_cracklib.so try_first_pass retry=3 minlen=8 lcredit=-1 ucredit=-1 dcredit=-1 ocredit=-1
```
※ 각 변수에 대한 설명 / 각 항목에서 -1 값은 반드시 해당하는 문자를 포함시켜야 함   

|권장 값|기능|설명|
|-|-|-|
|lcredit=-1|최소 소문자 요구|소문자 최소 1자 이상 요구|
|ucredit=-1|최소 대문자 요구|최소 대문자 1자 이상 요구|
|dcredit=-1|최소 숫자 요구|최소 숫자 1자 이상 요구|
|ocredit=-1|최소 특수문자 요구|최소 특수문자 1자 이상 요구|
|minlen=8|최소 패스워드 길이 설정|최소 8자리 이상 설정|
|difok=N|기존 패스워드와 비교|기본값 10(50%)|

**AIX**   
Step 1) 패스워드 복잡성 설정 파일 확인 (/etc/security/user 파일 내용을 내부 정책에 맞도록 설정)   

|권장 값|기능|설명|
|-|-|-|
|dictionlist=/usr/share/dict/words|unix 명령어 포함 여부|검증경로 설정|
|histextpire=26|동일한 패스워드 재사용 기간|26주 후 사용가능|
|histsize=10|이전 패스워드 기억 개수|이전 10개 패스워드 기억(사용불가)|
|maxrepeats=2|반복 가능한 동일 문자의 최대 수|2개이상 동일문자 사용 금지|
|minalpha=2|최소 알파벳 문자 포함|2개 이상 알파벳 사용|
|minother=2|최소 알파벳 문자 이외의 문자 수|2개 이상 숫자, 특수문자 사용|
|mindiff=4|이전 패스워드와 동일문자 수|이전 패스워드와 4개까지 동일문자 사용|
|minlen=8|패스워드 최소 길이|8자리 이상 패스워드 작성|

**HP-UX**   
Step 1) 패스워드 복잡성 설정 (/etc/default/security 내용을 내부 정책에 맞도록 편집)   

|권장 값|기능|설명|
|-|-|-|
|MIN_PASSWORDE_LENGTH=8|암호의 최소 길이|최소 8자리 패스워드|
|PASSWORD_MIN_UPPER_CASE_CHARS=1|최소 대문자 필요 개수|최소 1개의 대문자|
|PASSWORD_MIN_LOWER_CASE_CHARS=1|최소 소문자 필요 개수|최소 1개의 소문자|
|PASSWORD_MIN_DIGIT_CHARS=1|최소 숫자 필요 개수|최소 1개의 숫자|
|PASSWORD_MIN_SPECIAL_CHARS=1|최소 특수문자 필요 개수|최소 1개의 특수문자|

* 조치 시 영향 : 패스워드 변경 시 Web, WAS, DB연동 구간에서 문제가 발생할 수 있으므로 연동 구간에 미칠 수 있는 영향을 고려하여 적용 필요

## 1.3 계정 잠금 임계값 설정

||취약점 개요|
|:-:|:-|
|점검내용|사용자 계정 로그인 실패 시 계정잠금 임계값이 설정되어 있는지 점검|
|점검목적|계정탈취 목적의 무작위 대입 공격 시 해당 계정을 잠금하여 인증 요청에 응답하는 리소스 낭비를 차단하고 대입 공격으로 인한 비밀번호 노출 공격을 무력화하기 위함|
|보안위협|패스워드 탈취 공격(무작위 대입 공격, 사전 대입 공격, 추측 공격 등)의 인증 요청에 대해 설정된 패스워드와 일치할 때까지 지속적으로 응답하여 해당 계정의 패스워드가 유출될 수 있음 |
|참고|※ 사용자 로그인 실패 임계 값: 시스템에 로그인 시 몇 번의 로그인 실패에 로그인을 차단할 것인지 결정하는 값|
||점검대상 및 판단기준|
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 계정 잠금 임계값이 10회 이하의 값으로 설정되어 있는 경우 </br>취약 : 계정 잠금 임계값이 설정되어 있지 않거나, 10회 이하의 값으로 설정되지 않은 경우|
|조치방법|계정 잠금 임계값을 10회 이하로 설정|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|

* **SOLARIS**
  * **- SOLARIS 5.9 이하 버전 -**
  * Step 1) vi 편집기를 이용하여 "/etc/default/login" 파일 열기
  * Step 2) 아래와 같이 수전 또는, 신규 삽입
    * (수정 전) #RETRIES=2
    * (수정 후) RETRIES=10 
  * **- SOLARIS 5.9 이상 버전 -** 
  * Step 1) vi 편집기를 이용하여 "/etc/default/login" 파일 열기
  * Step 2) 아래와 같이 수정 또는, 신규 삽입 (계정 잠금 횟수 설정)
    * (수정 전) #RETRIES=2
    * (수정 후) RETRIES=10
  * Step 3) vi 편집기를 이용하여 "/etc/security/policy.conf" 파일 열기
  * Step 4) 아래와 같이 수정 또는, 신규 삽입 (계정 잠금 정책사용 설정)
    * (수정 전) #LOCK_AFTER_RETRIES=NO
    * (수정 후) LOCK_AFTER_RETRIES=YES
* **LINUX**
  * Step 1) vi 편집기를 이용하여 "/etc/pam.d/system-auth" 파일 열기
  * Step 2) 아래와 같이 수정 또는, 신규 삽입
    * auth required /lib/security/pam_tally.so deny=5 unlock_time=120 no_magic_root
    * account required /lib/security/pam_tally.so no_magic_root reset

![image](https://github.com/zzzangmans1/Technical_vulnerability_analysis_evaluation_method_detailed_guide/assets/52357235/a3b4623d-ac04-4174-ad76-0aeb8a15954e)

|옵션|설명|
|:-:|:-|
|no_magic_root|root에게는 패스워드 잠금 설정을 적용하지 않음|
|deny=5|5회 입력 실패 시 패스워드 잠금|
|unlock_time|계정 잠김 후 마지막 게정 실패 시간부터 설정된 시간이 지나면 자동 계정 잠김 해제 (단위:초)|
|reset|접속 시도 성공 시 실패한 횟수 초기화|

* **AIX**
  * Step 1) vi 편집기를이용하여 "/etc/security/user" 파일 열기
  * Step 2) 아래와 같이 수정 또는, 신규 삽입
    * (수정 전) loginretries = 0
    * (수정 후) loginretries = 10

* **HP-UX**
  * **- HP-UX 11v2 이하 버전 -**
  * Step 1) vi 편집기를 이용하여 /tcb/files/auth/system/default 파일 열기
  * Step 2) 아래와 같이 수정 또는, 신규 삽입
    * (수정 전) u_maxtries#
    * (수정 후) u_maxtries#10

※ HP-UX 서버에 계정 잠금 정책 설정을 위해서는 HP-UX 서버가 Trusted Mode로 동작하고 있어야하므로 Trusted Mode로 전환한 후 잠금 정책 적용

  * **- HP-UX 11v3 이상 버전 -**
  * Step 1) vi 편집기를 이용하여 /etc/default/security 팡리 열기
  * Step 2) 아래와 같이 수정 또는, 신규 삽입
    * (수정 전) #AUTH_MAXTRIES=0
    * (수정 후) AUTH_MAXTRIES=10

※ Standard and Shadow modes only

### 조치 시 영향
HP-UX 경우 Trusted Mode로 전환 시 파일시스템 구조가 변경되어 운영 중인 서비스에 문제가 발생할 수 있으므로 충분한 테스트를 거친 후 Trusted Mode로의 전환이 필요함   
Linux의 pam.d/system-auth의 내용 수정 시 해당 라이브러리가 실제 존재하는지 확인 필요(/lib/security/pam_tally.so - 파일 미존재시 모든 계정 로그인 안되는 장애가 발생될수 있음) 

## 1.4 패스워드 파일 보호

||취약점 개요|
|:-:|:-|
|점검내용|시스템의 사용자 계정(root, 일반계정) 정보가저장된 파일(예 /etc/passwd, /etc/shadow)에 사용자 계정 패스워드가 암호화되어 있는지 점검|
|점검목적|일부 오래된 시스템의 경우 /etc/passwd 파일에 패스워드가 평문으로 저장되므로 사용자 계정 패스워드가 암호화되어 있는지 점검하여 비인가자의 패스워드 파일 접근 시에도 사용자 계정 패스워드가 안전하게 관리되고 있는지 확인하기 위함|
|보안위협|사용자 계정 패스워드가 저장된 파일이 유출 또는 탈취 시 평문으로 저장된 패스워드 정보가 노출될 수 있음|
||점검대상 및 판단기준|
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 쉐도우 패스워드를 사용하거나, 패스워드를 암호화하여 저장하는 경우 </br>취약 : 쉐도우 패스워드를 사용하지 않고, 패스워드를 암호화하여 저장하지 않는 경우|
|조치방법|패스워드 암호화 저장, 관리 설정 적용|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|

* **SOLARIS, LINUX**
  * Step 1) pwconv ---> 쉐도우 패스워드 정책 적용 방법
  * Step 2) pwunconv ---> 일반 패스워드 정책 적용 방법

* **AIX**
  * Step 1) #cat /etc/security/passwd
  * Step 2) 패스워드 암호화 여부 확인

※ AIX 서버는 기본적으로 "/etc/security/passwd" 파일에 패스워드를 암호화하여 저장, 관리

* **HP-UX**
  * HP-UX 서버는 Trusted Mode로 전환할 경우 패스워드를 암호화하여 "/tcb/files/auth" 디렉터리에 계정 이니셜과 계정 이름에 따라 파일로 저장,관리할 수 있으므로 Trusted Mode인지 확인 후 UnTrusted Mode인 경우 모드를 전환함
  * Step 1) Trusted Mode 전환 방법: root 계정으로 로그인한 후 아래 명령 수행
    * /etc/tsconvert 
  * Step 2) UnTrusted Mode 전환 방법: root 계정으로 로그인한 후 아래 명령 수행
    * /etc/tsconvert -r2

### 조치 시 영향
HP-UX 경우 Trusted Mode로 전환 시 파일시스템 구조가 변경되어 운영 중인 서비스에 문제가 발생할 수 있으므로 충분한 테스트를 거친 후 Trusted Mode로의 전환 필요

# 2. 파일 및 디렉토리 관리
## 2.1 root홈, 패스 디렉터리 권한 및 패스 설정

||취약점 개요|
|:-:|:-|
|점검내용|root 계정의 PATH 환경변수에 "."이(마침표) 포함되어 있는지 점검|
|점검목적|비인가자가 불법적으로 생성한 디렉터리 및 명령어를 우선으로 실행되지 않도록 설정하기 위해 환경변수 점검이 필요함|
|보안위협|root 계정의 PATH(환경변수)에 정상적인 관리자 명령어(예: ls, mv, cp 등)의 디렉터리 경로 보다 현재 디렉터리를 지칭하는 "." 표시가 우선하면 현재 디렉터리에 변조된 명령어를 삽입하여 관리자 명령어 입력 시 악의적인 기능이 실행될 수 있음|
|참고|※ 환경변수: 프로세스가 컴퓨터에서 동작하는 방식에 영향을 미치는 동적인 값들의 집합으로 Path 환경변수는 실행파일을 찾는 경로에 대한 변수|
||점검대상 및 판단기준|
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : PATH 환경변수에 "." 이 맨 앞이나 중간에 포함되지 않은 경우 </br>취약 : PATH 환경변수에 "." 이 맨 앞이나 중간에 포함되어 있는 경우|
|조치방법|root 계정의 환경변수 설정파일("/.profile", "/.cshrc" 등)과 "/etc/profile" 등에서 PATH 환경변수에 포함되어 있는 현재 디렉터리를 나타내는 "."을 PATH 환경변수의 마지막으로 이동 </br>※"/etc/profile", root 계정의 환경변수 파일, 일반계정의 환경변수 파일을 순차적으로 검색하여 확인|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|

## SHELL에 따라 참조되는 환경 설정파일
* /bin/sh : /etc/profile, $HOME/.profile
* /bin/csh : $HOME/.cshrc, $HOME/.login, /etc/.login
* /bin/ksh : /etc/profile, $HOME/.profile, $HOME/kshrc
* /bin/bash : /etc/profile, $HOME/.bash_profile

![image](https://github.com/zzzangmans1/Technical_vulnerability_analysis_evaluation_method_detailed_guide/assets/52357235/9798261a-6380-4d5b-a44d-6f7823e4b02d)

* **SOLARIS, LINUX, AIX, HP-UX**
  * Step 1) vi 편집기를 이용하여 root 계정의 설정파일(~/.profile 과 /etc/profile) 열기
    * vi /etc/profile
  * Step 2) 아래와 같이 수정
    * (수정 전) PATH=.:$PATH:$HOME/bin
    * (수정 후) PATH=$PATH:$HOME/bin:.

## 2.2 파일 및 디렉터리 소유자 설정

||취약점 개요|
|:-:|:-|
|점검내용|소유자 불분명한 파일이나 디렉터리가 존재하는지 여부를 점검|
|점검목적|소유자가 존재하지 않는 파일 및 디렉터리를 삭제 및 관리하여 임의의 사용자가 해당파일을 열람, 수정하는 행위를 사전에 차단하기 위함|
|보안위협|소유자가 존재하지 않는 파일의 UID와 동일한 값으로 특정계정의 UID값을 변경하면 해당 파일의 소유자가 되어 모든 작업이 가능함|
|참고|※ 소유자가 존재하지 않는 파일 및 디렉터리는 퇴직자의 자료이거나 관리 소홀로 인해 생긴 파일인 경우 또는 해킹으로 인한 공격자가 만들어 놓은 악의적인 파일인 경우가 있음|
||점검대상 및 판단기준|
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 소유자가 존재하지 않는 파일 및 디렉터리가 존재하지 않는 경우 </br>취약 : 소유자가 존재하지 않는 파일 및 디렉터리가 존재하는 경우|
|조치방법|소유자가 존재하지 않는 파일 및 디렉터리 삭제 또는, 소유자 변경|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, AIX|소유자가 nouser, nogroup인 파일이나 디렉터리 검색 </br>find / -nouser -o -nogroup -xdev -ls 2 > /dev/null|
|HP-UX|find / \( -nouser -o -nogroup \) -xdev -exec ls -al {} \; 2> /dev/null|
|LINUX|find / -nouser -o -nogroup|
||※ 소유자 또는 그룹이 없는 파일은 파일 속성 해당 필드에 숫자로 표시됨 </br>예시) rwxr-xr-x 500 500 test.txt </br>※ 소유자가 nouser, nogroup인 파일이나 디렉터리 존재하는 경우 아래의 보안설정방법에 따라 디렉터리 및 파일 삭제 또는, 소유자 및 그룹을 변경함|

* **SOLARIS, LINUX, AIX, HP-UX**
  * Step 1) 소유자가 존재하지 않는 파일이나 디렉터리가 불필요한 경우 rm 명령으로 삭제
    * rm <file_name>
    * rm <directory_name>
  * Step 2) 필요한 경우 chown 명령으로 소유자 및 그룹 변경
    * chown <user_name>:<group_name> <file_name>

## 2.3 /etc/passwd 파일 소유자 및 권한 설정

||취약점 개요|
|:-:|:-|
|점검내용|/etc/passwd 파일 권한 적절성 점검|
|점검목적| /etc/passwd 파일의 임의적인 변경을 차단하기 위함을 통해 비인가자가 권한 상승하는 것을 막기 위함|
|보안위협|관리자(root) 외 사용자가 "/etc/passwd" 파일의 사용자 정보를 변조하여 shell 변경, 사용자 추가/삭제 등 root를 포함한 사용자 권한 획득 가능|
|참고|※ /etc/passwd: 사용자의 ID, 패스워드, UID, GID, 홈 디렉터리, 쉘 정보를 담고 있는 파일|
||점검대상 및 판단기준|
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : /etc/passwd 파일의 소유자가 root이고, 권한이 644 이하인 경우 </br>취약 : /etc/passwd 파일의 소유자가 root가 아니거나, 권한이 644 이하가 아닌 경우|
|조치방법|"/etc/passwd" 파일의 소유자 및 권한 변경 (소유자 root, 권한 644)|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|"/etc/passwd" 파일의 소유자 및 권한 확인 </br>#ls -al /etc/passwd </br>rw-r--r-- root <passwd 파일>|
||"passwd" 파일의 소유자가 root가 아니거나 파일의 권한이 644 이하가 아닌 경우 아래의 보안설정방법에 따라 설정을 변경함|

* **SOLARIS, LINUX, AIX, HP-UX**
* "/etc/passwd" 파일의 소유자 및 권한 변경 (소유자 root, 권한 644)
  * #chown root /etc/passwd
  * #chmod 644 /etc/passwd

## 2.4 /etc/shadow 파일 소유자 및 권한 설정

||취약점 개요|
|:-:|:-|
|점검내용|/etc/shadow 파일 권한 적절성 점검|
|점검목적|/etc/shadow 파일을 관리자만 제어할 수 있게 하여 비인가자들의 접근을 차단하도록 shadow 파일 소유자 및 권한을 관리해야함|
|보안위협|shadow파일은 패스워드를 암호화하여 저장하는 파일이며 해당 파일의 암호화된 해쉬값을 복호화하여(크래킹) 비밀번호를 탈취할 수 있음|
|참고|※ /etc/shadow: 시스템에 등록된 모든 계정의 패스워드를 암호화된 형태로 저장 및 관리하고 있는 파일|
||점검대상 및 판단기준|
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : /etc/shadow 파일의 소유자가 root이고, 권한이 400 이하인 경우 </br> 취약 : /etc/shadow 파일의 소유자가 root가 아니거나, 권한이 400 이하가 아닌 경우|
|조치방법|"/etc/shadow" 파일의 소유자 및 권한 변경 (소유자 root, 권한 400)|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX|# ls -l /etc/shadow (shadow 파일 구조: 부록 참고) </br>r-------- root <shadow 파일>|
|AIX|# ls -ld /etc/security/passwd (passwd 파일 구조: 부록 참고) </br>r-------- root <passwd 파일>|
|HP-UX|# ls -ld /tcb/files/auth </br>r-------- root <auth 디렉터리>|
||위에 제시된 파일 및 디렉터리의 소유자가 root가 아니거나 파일의 권한이 400이 아닌 경우 아래의 보안설정방법에 따라 설정을 변경함|

* **SOLARIS, LINUX**
* Step 1) "/etc/shadow" 파일의 소유자 및 권한 확인
  * #ls -al /etc/shadow
* Step 2) "/etc/shadow" 파일의 소유자 및 권한 변경 (소유자 root, 권한 400)
  * #chown root /etc/shadow
  * #chmod 400 /etc/shadow

* **AIX**   
AIX 서버는 기본적으로 "/etc/security/passwd" 파일에 패스워드를 암호화하여 저장, 관리하므로 해당 디렉터리 권한을 기준에 맞게 설정
* Step 1) /etc/security/passwd 디렉터리의 소유자 및 권한 확인
  * #ls -ld /etc/security/passwd
* Step 2) "/etc/security/passwd" 파일의 소유자 및 권한 변경 (소유자 root, 권한 400)
  * #chown root /etc/security/passwd
  * #chmod 400 /etc/security/passwd

* **HP-UX**   
HP-UX 서버는 Trusted Mode로 전환할 경우 패스워드를 암호화하여 "/tcb/files/auth" 디렉터리에 계정 이니셜과 계정명에 따라 파일로 저장, 관리 가능
* Step 1) /tcb/files/auth 디렉터리의 소유자 및 권한 확인
  * #ls -ld /tcb/files/auth
* Step 2) "/tcb/file/auth" 파일의 소유자 및 권한 변경 (소유자 root, 권한 400)
  * #chown root /tcb/files/auth
  * #chmod 400 /tcb/files/auth

## 2.5 /etc/hosts 파일 소유자 및 권한 설정

||취약점 개요|
|:-:|:-|
|점검내용|/etc/hosts 파일의 권한 적절성 점검|
|점검목적|/etc/hosts 파일을 관리자만 제어할 수 있게 하여 비인가자들의 임의적인 파일 변조를 방지하기 위함|
|보안위협|* hosts 파일에 비인가자 쓰기 권한이 부여된 경우, 공격자는 hosts파일에 악의적인 시스템을 등록하여, 이를 통해 정상적인 DNS를 우회하여 악성사이트로의 접속을 유도하는 파밍(Pharming) 공격 등에 악용될 수 있음 </br>* hosts파일에 소유자외 쓰기 권한이 부여된 경우, 일반사용자 권한으로 hosts 파일에 변조된 IP주소를 등록하여 정상적인 DNS를 방해하고 악성사이트로의 접속을 유도하는 파밍 공격 등에 악용될 수 있음|
|참고|※ /etc/hosts: IP 주소와 호스트네임을 매핑하는 파일. 일반적으로 인터넷 통신 시 주소를 찾기 위해 도메인 네임 서비스(DNS)보다 hosts 파일을 먼저 참조함. hosts 파일은 문자열 주소로부터 IP 주소를 수신받는 DNS 서버와는 달리, 파일 내에 직접 문자열 주소와 IP 주소를 매칭하여 기록하며, DNS 서버 접근 이전에 확인하여 해당 문자열 주소가 목록에 존재할 시 그 문자열 주소에 해당하는 IP 주소로 연결함 </br>※ 파밍(Pharming): 사용자의 DNS 또는 hosts 파일을 변조함으로써 정상적인 사이트로 오인하여 접속하도록 유도한 뒤 개인정보를 훔치는 새로운 컴퓨터 범죄 수법|
||점검대상 및 판단기준|
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : /etc/hosts 파일의 소유자가 root이고, 권한이 600인 이하경우 </br>취약 : /etc/hosts 파일의 소유자가 root가 아니거나, 권한이 600 이상인 경우|
|조치방법|"/etc/hosts" 파일의 소유자 및 권한 변경 (소유자 root, 권한 600)|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|# ls -l /etc/hosts </br>rw------- root <hosts 파일>|
||"hosts" 파일의 소유자가 root가 아니거나 파일의 권한이 600이하가 아닌 경우 아래의 보안설정방법에 따라 설정을 변경함|

* **SOLARIS, LINUX, AIX, HP-UX**   
* "/etc/hosts" 파일의 소유자 및 권한 변경 (소유자 root, 권한 600)
  * #chown root /etc/hosts
  * #chmod 600 /etc/hosts

### 조치 시 영향
hosts 파일의 권한을 600으로 변경시 일반사용자 권한은 해당파일을 사용할 수 없음   
hosts 파일에 시스템 정보가 설정되어 있는 경우 hosts파일을 참조하는 서비스를 확인하는 것이 필요함

## 2.6 /etc/(x)inetd.conf 파일 소유자 및권한 설정

||취약점 개요|
|:-:|:-|
|점검내용|/etc/(x)inetd.conf 파일 권한 적절성 점검|
|점검목적|/etc/(x)inetd.conf 파일을 관리자만 제어할 수 있게 하여 비인가자들의 임의적인 파일 변조를 방지하기 위함|
|보안위협|(x)inetd.conf 파일에 소유자외 쓰기 권한이 부여된 경우, 일반사용자 권한으로 (x)inetd.conf 파일에 등록된 서비스를 변조하거나 악의적인 프로그램(서비스)를 등록할 수 있음|
|참고|※ (x)inetd (슈퍼데몬) : 자주 사용하지 않는 서비스가 상시 실행되어 메모리를 점유하는 것을 방지하기 위해 (x)inetd(슈퍼데몬)에 자주 사용하지 않는 서비스를 등록하여 요청이 있을시에만 해당 서비스를 실행하고 요청이 끝나면 서비스를 종료하는 역할 수행|
||점검대상 및 판단기준|
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : /etc/inetd.conf 파일의 소유자가 root이고, 권한이 600인 경우 </br>취약 : /etc/inetd.conf 파일의 소유자가 root가 아니거나, 권한이 600이 아닌 경우|
|조치방법|"/etc/(x)inetd.conf" 파일의 소유자 및 권한 변경 (소유자 root, 권한 600)|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|"etc/inetd.conf" 파일의 소유자 및 권한 확인 </br>#ls -al /etc/inetd.conf </br>rw------- root <inet.d.conf 파일>|
|LINUX </br>(Xinetd)|"/etc/xinetd.conf" 파일 및 "/etc/xinetd.d/" 하위 모든 파일의 소유자 및 권한 확인 </br>#ls -al /etc/xinetd.conf </br>#ls -al /etc/xinetd.d/* </br>rw------- root <xinetd.conf 파일> </br>rw------- root <xinetd 디렉터리 내 모든 파일>|
||인터넷 슈퍼데몬 서비스 설정파일의 소유자가 root가 아니거나 파일의 권한이 600이 아닌 경우 아래의 보안설정방법에 따라 설정을 변경함 </br>※ Linux 운영체제는 버전에 따라 inetd 또는 xinetd을 사용하고 있으므로 사용하고 있는 데몬 확인 필요|

* **SOLARIS, LINUX, AIX, HP-UX**   
* "/etc/inetd.conf" 파일의 소유자 및 권한 변경 (소유자 root, 권한 600)
  * #chown root /etc/inetd.conf
  * #chmod 600 /etc/inetd.conf

* **LINUX - xinetd**   
* "/etc/xinetd.conf" 파일의 소유자 및 권한 변경 (소유자 root, 권한 600)
  * #chown root /etc/xinetd.conf
  * #chmod 600 /etc/xinetd.conf
* ※ "/etc/xinetd.d/" 하위 디렉터리에 취약한 파일도 위와 동일한 방법으로 조치
  * #chown -R root /etc/xinetd.d
  * #chmod -R 640 /etc/xinetd.d

## 2.7 /etc/syslog.conf 파일 소유자 및 권한 설정

||취약점 개요|
|:-:|:-|
|점검내용|/etc/syslog.conf 파일 권한 적절성 점검|
|점검목적|/etc/syslog.conf 파일의 권한 적절성을 점검하여, 관리자 외 비인가자의 임의적인 syslog.conf 파일 변조를 방지하기 위함|
|보안위협|syslog.conf 파일의 설정내용을 참조하여 로그의 저장위치가 노출되며 로그를 기록하지 않도록 설정하거나 대량의 로그를 기록하게 하여 시스템 과부하를 유도할 수 있음|
|참고|※ /etc/syslog.conf : syslogd 데몬 실행시 참조되는 설정파일로 시스템 로그 기록의 종류, 위치 및 Level을 설정할 수 있음|
||점검대상 및 판단기준|
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : /etc/syslog.conf 파일의 소유자가 root(또는 bin, sys)이고, 권한이 640 이하인 경우 </br>취약 : /etc/syslog.conf 파일의 소유자가 root(또는 bin, sys)가 아니거나, 권한이 640이하가 아닌 경우|
|조치방법|"etc/syslog.conf" 파일의 소유자 및 권한 변경 (소유자 root(또는 bin, sys), 권한 644 이하)|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|"/etc/syslog.conf" 파일의 소유자 및 권한 확인 </br>#ls -al /etc/syslog.conf </br>rw-r----- root <syslog.conf 파일>|
||"syslog.conf" 파일의 소유자가 root가 아니거나 파일의 권한이 640가 아닌 경우 아래의 보안설정방법에 따라 설정을 변경함|

* **SOLARIS, LINUX, AIX, HP-UX**   
* Step 1) "/etc/syslog.conf" 파일의 소유자 및 권한 변경 (소유자 root, 권한 640)
  * #chown root /etc/syslog.conf
  * #chmod 640 /etc/syslog.conf

* **LINUX (CentOS 6 이상일 경우)**
  * #chown root /etc/rsyslog.conf
  * #chmod 640 /etc/rsyslog.conf
 
### 조치 시 영향
root, bin, sys 등 시스템에서 사용하는 계정이 아닌 일반 계정에서 소유 권한이 부여되지 않도록 하여야 함

## 2.8 /etc/services 파일 소유자 및 권한 설정

||취약점 개요|
|:-:|:-|
|점검내용|/etc/services 파일 권한 적절성 점검|
|점검목적|/etc/services 파일을 관리자만 제어할 수 있게 하여 비인가자들의 임의적인 파일 변조를 방지하기 위함|
|보안위협|Services 파일의 접근권한이 적절하지 않을 경우 비인가 사용자가 운영 포트번호를 변경하여 정상적인 서비스를 제한하거나, 허용되지 않은 포트를 오픈하여 악성 서비스를 의도적으로 실행할 수 있음|
|참고|※ /etc/services : 서비스 관리를 위해 사용되는 파일. 해당 파일에 서버에서 사용하는 모든 포트들에 대해 정의되어 있으며, 필요시 서비스 기본사용 포트를 변경하여 네트워크 서비스를 운용할 수 있음|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : /etc/services 파일의 소유자가 root(또는 bin, sys)이고, 권한이 644 이하인 경우 </br>취약 : /etc/services 파일의 소유자가 root(또는 bin, sys)가 아니거나, 권한이 644이하가 아닌 경우|
|조치방법|"/etc/services" 파일의 소유자 및 권한 변경 (소유자 root(또는 bin, sys), 권한 644 이하)|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|"/etc/services" 파일의 소유자 및 권한 확인 </br>#ls -al /etc/services </br>rw-r--r-- root <services 파일>|
||"services" 파일의 소유자가 root가 아니거나 파일의 권한이 644가 아닌 경우 아래의 보안설정방법에 따라 설정을 변경함|

* **SOLARIS, LINUX, AIX, HP-UX**   
* "/etc/services" 파일의 소유자 및 권한 변경 (소유자 root, 권한 644)
  * #chown root /etc/services
  * #chmod 644 /etc/services

## 2.9 SUID, SGID 설정 파일 점검

||취약점 개요|
|:-:|:-|
|점검내용|불필요하거나 악의적인 파일에 SUID, SGID 설정 여부 점검|
|점검목적|불필요한 SUID, SGID 설정 제거로 악의적인 사용자의 권한상승을 방지하기 위함|
|보안위협|SUID, SGID 파일의 접근권한이 적절하지 않을 경우 SUID, SGID 설정된 파일로 특정 명령어를 실행하여 root 권한 획득 가능함|
|참고|※ SUID: 설정된 파일 실행 시, 특정 작업 수행을 위하여 일시적으로 파일 소유자의 권한을 얻게 됨 </br>※ SGID: 설정된 파일 실행 시, 특정 작업 수행을 위하여 일시적으로 파일 소유 그룹의 권한을 얻게 됨|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 주요 실행파일의 권한에 SUID와 SGID에 대한 설정이 부여되어 있지 않은 경우 </br>취약 : 주요 실행파일의 권한에 SUID와 SGID에 대한 설정이 부여되어 있는 경우|
|조치방법|Step 1) 불필요한 SUID, SGID 파일 제거 </br>Step 2) 아래의 목록 이외에 애플리케이션에서 생성한 파일이나, 사용자가 임의로 생성한 파일 등 의심스럽거나 특이한 파일의 발견 시 SUID 제거 필요|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|OS별 주요 실행파일에 대한 SUID/SGID 설정 여부 확인 </br>#find / -user root \( -perm -4000 -o -perm -2000 \) -exec ls -al {} \;|
||주요 파일에 불필요한 SUID/SGID가 설정된 경우 아래의 보안설정방법에 따라 SUID/SGID를 제거함|

* **SOLARIS, LINUX, AIX, HP-UX**   
* Step 1) 제거 방법
  * #chmod -s <file_name>
* Step 2) 주기적인 검사 방법
  * #find / \( -perm -04000 -o -perm -02000 \) -exec ls -al {} \;
* Step 3) 반드시 사용이 필요한 경우 특정 그룹에서만 사용하도록 제한하는 방법
* 일반 사용자의 Setuid 사용을 제한함 (임의의 그룹만 가능)
  * #chgrp <group_name> <setuid_file_name>
  * #chmod 4750 <setuid_file_name>

### 조치 시 영향
SUID 제거 시 OS 및 응용 프로그램 등 서비스 정상작동 유무 확인 필요

## 2.10 사용자, 시스템 시작파일 및 환경파일 소유자 및 권한 설정

||취약점 개요|
|:-:|:-|
|점검내용|홈 디렉터리 내의 환경변수 파일에 대한 소유자 및 접근권한이 관리자 또는 해당 계정으로 설정되어 있는지 점검|
|점검목적|비인가자의 환경변수 조작으로 인한 보안 위험을 방지하기 위함|
|보안위협|홈 디렉터리 내의 사용자 파일 및 사용자별 시스템 시작파일 등과 같은 환경변수 파일의 접근권한 설정이 적절하지 않을 경우 비인가자가 환경변수 파일을 변조하여 정상 사용중인 사용자의 서비스가 제한 될 수 있음|
|참고|※ 환경변수 파일 종류: ".profile", ".kshrc", ".cshrc", ".bashrc", ".bash_profile", ".login", ".exrc", ".netrc" 등|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 홈 디렉터리 환경변수 파일 소유자가 root 또는, 해당 계정으로 지정되어 있고, 홈 디렉터리 환경변수 파일에 root와 소유자만 쓰기 권한이 부여된 경우 </br>취약 : 홈 디렉터리 환경변수 파일 소유자가 root 또는, 해당 계정으로 지정되지 않고, 홈 디렉터리 환경변수 파일에 root와 소유자 외에 쓰기 권한이 부여된 경우|
|조치방법|환경변수 파일의 권한 중 타 사용자 쓰기 권한 제거|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|홈 디렉터리 환경변수 파일의 소유자 및 권한 확인 </br>#ls -al <홈 디렉터리 환경변수 파일>|
||홈 디렉터리 환경변수 파일의 소유자가 root 또는, 해당 계정으로 설정되어 있는지 확인 후 소유자 이외의 사용자에게 쓰기 권한이 부여되어 있을 경우 아래의 보안 설정방법에 따라 설정을 변경함|

* **SOLARIS, LINUX, AIX, HP-UX**   
* Step 1) 소유자 변경 방법
  * #chown <user_name> <file_name>
* Step 2) 일반 사용자 쓰기 권한 제거 방법
  * #chmod o-w <file_name>

## 2.11 world writable 파일 점검

||취약점 개요|
|:-:|:-|
|점검내용|불필요한 world writable 파일 존재 여부 점검|
|점검목적|world writable 파일을 이용한 시스템 접근 및 악의적인 코드 실행을 방지하기 위함|
|보안위협|시스템 파일과 같은 중요 파일에 world writable 설정이 될 경우, 일반사용자 및 비인가자된 사용자가 해당 파일을 임의로 수정, 삭제가 가능함|
|참고|※ world writable 파일: 파일의 내용을 소유자나 그룹 외 모든 사용자에 대해 쓰기가 허용된 파일 (예 : rwxrwxrwx root root <파일명>|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 시스템 중요 파일에 world writable 파일이 존재하지 않거나, 존재 시 설정 이유를 확인하고 있는 경우 </br>취약 : 시스템 중요 파일에 world writable 파일이 존재하나 해당 설정 이유를 확인하고 있지 않는 경우|
|조치방법|world writable 파일 존재 여부를 확인하고 불필요한 경우 제거|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|world writable 파일 존재 여부 확인 </br>#find / -type f -perm -2 -exec ls -al {} \;|
||"world writable" 파일 존재 시 사용 목적을 확실히 알고 불필요 시 삭제, 필요 시 아래의 보안설정방법에 따라 설정을 변경함|

* **SOLARIS, LINUX, AIX, HP-UX**   
* Step 1) 일반 사용자 쓰기 권한 제거 방법
  * #chmod o-w <file_name>
* Step 2) 파일 삭제 방법
  * #rm -rf <world-writable 파일명>

## 2.12 /dev에 존재하지 않는 device 파일 점검

||취약점 개요|
|:-:|:-|
|점검내용|존재하지 않는 device 파일 존재 여부 점검|
|점검목적|실제 존재하지 않는 디바이스를 찾아 제거함으로써 root 파일 시스템 손상 및 다운 등의 문제를 방지하기 위함|
|보안위협|공격자는 rootkit 설정파일들을 서버 관리자가 쉽게 발견하지 못하도록 /dev에 device 파일인 것처럼 위장하는 수법을 많이 사용함|
|참고|※ /dev 디렉터리: 논리적 장치 파일을 담고 있는 /dev 디렉터리는 /devices 디렉터리에 있는 물리적 장치 파일에 대한 심볼릭 링크임. 예를 들어 rmt0를 rmto로 잘못 입력한 경우 rmto 파일이 새로 생성되는 것과 같이 디바이스 이름 입력 오류 시 root 파일 시스템이 에러를 일으킬 때까지 /dev 디렉터리에 계속해서 파일을 생성함 </br>※ /dev 디렉터리 내 불필요한 device 파일이 존재할 시 삭제 권고|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : dev에 대한 파일 점검 후 존재하지 않은 device 파일을 제거한 경우 </br>취약 : dev에 대한 파일 미점검 또는, 존재하지 않은 device 파일을 방치한 경우|
|조치방법|major, minor, number를 가지지 않는 device 파일 제거|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|dev에 존재하지 않는 device 파일 점검 </br>#find /dev -type f -exec ls -al {} \;|
||존재하지 않는 디바이스가 "dev" 디렉터리 내에 존재하는 경우 아래의 보안설정방법에 따라 제거함|

* **SOLARIS, LINUX, AIX, HP-UX**   
* Step 1) /dev 디렉터리 파일 점검
  * #find /dev -type f -exec ls -al {} \;
* Step 2) major, minor, number를 가지지 않는 device일 경우 삭제
  * #rm -rf <world-writable 파일명>
 
## 2.13 $HOME/.rhosts, hosts.equiv 사용 금지

||취약점 개요|
|:-:|:-|
|점검내용|/etc/hosts.equiv 파일 및 .rhosts 파일 사용자들 root 또는, 해당 계정으로 설정한 뒤 권한을 600으로 설정하고 해당파일 설정에 '+' 설정(모든 호스트 허용)이 포함되지 않도록 설정되어 있는지 점검|
|점검목적|'r' command 사용을 통한 원격 접속은 인증 없이 관리자 원격접속이 가능하므로 서비스 포트를 차단해야 함|
|보안위협|rlogin, rsh 등과 같은 'r' commmand의 보안 설정이 적용되지 않은 경우, 원격지의 공격자가 관리자 권한으로 목표 시스템상의 임의의 명령을 수행시킬 수 있으며, 명령어 원격 실행을 통해 중요 정보 유출 및 시스템 장애를 유발시킬 수 있음. 또한 공격자 백도어 등으로도 활용될 수 있음 </br>r-command(rlogin, rsh 등) 서비스의 접근통제에 관련된 파일로 권한설정을 미 적용한 경우 r-command 서비스 사용 권한을 임의로 등록하여 무단 사용이 가능함|
|참고|※ 'r'command: 인증 없이 관리자의 원격접속을 가능하게 하는 명령어들로 rsh(remsh), rlogin, rexec 등이 있으며, 포트번호 512, 513, 514 (TCP)를 사용함|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : login, shell, exec 서비스를 사용하지 않거나, 사용 시 아래와 같은 설정이 적용된 경우 </br> 1. /etc/hosts.equiv 및 $HOME/.rhosts 파일 소유자가 root 또는, 해당 계정인 경우 </br>2. /etc/hosts.equiv 및 $HOME/.rhosts 파일 권한이 600 이하인 경우 </br>3. /etc/hosts.equiv 및 $HOME/.rhosts 파일 설정에 '+' 설정이 없는 경우 </br>취약 : login, shell, exec 서비스를 사용하고, 위와 같은 설정이 적용되지 않은 경우|
|조치방법|Step 1) /etc/hosts.equiv 및 $HOME/.rhosts 파일 소유자를 root 또는, 해당 계정으로 변경 </br>Step 2) /etc/hosts.equiv 및 $HOME/.rhosts 파일 권한을 600 이하로 변경 </br>Step 3) /etc/hosts.equiv 및 $HOME/.rhosts 파일에서 "+"를 제거하고 반드시 필요한 호스트 및 계정만 등록 (해당 내역 요청)|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|Step 1) 파일 소유자 및 권한 확인 </br>#ls -al /etc/hosts.equiv </br>#ls -al $HOME/.rhosts </br> rw------- root <hosts.equiv 파일> </br>rw------- root <$HOME/.rhosts 파일> </br>Step 2) 계정 별 '+' 부여 적절성 확인 </br>#cat /etc/hosts.equiv </br>#cat $HOME/.rhosts </br>/etc/hosts.equiv : 서버 설정 파일 </br>$HOME/.rhosts : 개별 사용자의 설정 파일|
||"/etc/hosts.equiv 및 $HOME/.rhosts" 파일의 소유자가 root가 아니거나 파일의 권한이 600이 아닌 경우 아래의 보안설정방법에 따라 설정을 변경함|

* **SOLARIS, LINUX, AIX, HP-UX**   
* Step 1) "/etc/hosts.equiv" 및 $HOME/.rhosts" 파일의 소유자를 root 또는, 해당 계정으로 변경
  * #chown root /etc/hosts.equiv
  * #chown <user_name> $HOME/.rhosts
* Step 2) "/etc/hosts.equiv" 및 "$HOME/.rhosts" 파일의 권한을 600 이하로 변경
  * #chmod 600 /etc/hosts.equiv
  * #chmod 600 $HOME/.rhosts
* Step 3) "/etc/hosts.equiv" 및 "$HOME/.rhosts" 파일에서 "+"를 제거하고 허용 호스트 및 계정 등록
  * #cat /etc/hosts.equiv (or $HOME/.rhosts)

|++|모든 호스트의 계정을 신뢰|
|:-:|:-|
|+ test|모든 호스트의 test 계정을 신뢰|
|Web1 +|Web1 호스트의 모든 계정을 신뢰|

## 2.14 접속 IP 및 포트 제한

||취약점 개요|
|:-:|:-|
|점검내용|허용할 호스트에 대한 접속 IP 주소 제한 및 포트 제한 설정 여부 점검|
|점검목적|허용한 호스트만 서비스를 사용하게 하여 서비스 취약점을 이용한 외부자 공격을 방지하기 위함|
|보안위협|허용할 호스트에 대한 IP 및 포트제한이 적용되지 않은 경우, Telnet, FTP같은 보안에 취약한 네트워크 서비스를 통하여 불법적인 접근 및 시스템 침해사고가 발생할 수 있음|
|참고|접속 IP 및 포트제한 애플리케이션 종류 예시 </br>※ TCP Wrapper: 네트워크 서비스에 관련한 트래픽을 제어하고 모니터링할 수 있는 UNIX 기반의 방화벽 툴 </br>※ IPFilter: 유닉스 계열에서 사용하는 공개형 방화벽 프로그램으로써 Packet Filter로 시스템 및 네트워크 보안에 아주 강력한 기능을 보유한 프로그램 </br>※ IPtables: 리눅스 커널 방화벽이 제공하는 테이블들과 그것을 저장하는 체인, 규칙들을 구성할 수 있게 해주는 응용프로그램|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 접속을 허용할 특정 호스트에 대한 IP 주소 및 포트 제한을 설정한 경우 </br>취약 : 접속을 허용할 특정 호스트에 대한 IP 주소 및 포트 제한을 설정하지 않은 경우|
|조치방법|OS에 기본으로 제공하는 방화벽 애플리케이션이나 TCP Wrapper와 같은 호스트별 서비스 제한 애플리케이션을 사용하여 접근 허용 IP 등|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX|1. TCP Wrapper 사용할 경우 </br>All deny 적용 확인 및 접근 허용 IP 적절성 확인 </br>#cat /etc/hosts.deny </br>#cat /etc/hosts.allow </br>2. IPtables 사용할 경우 (Linux) </br>#iptables -L </br>3. IPfilter 사용할 경우 (SOLARIS) </br>#cat /etc/ipf/ipf.conf </br>4. TCP Wrapper (SOLARIS 10 이상) </br># inetadm -p </br>tcp_wrappers=true <- 현재 실행되어 있는 상태 </br>tcp_wrappers=false <- 현재 정지된 상태|
|HP-UX|All deny 적용 확인 및 서비스 접근 가능 IP 확인 </br>#cat /var/adm/inetd.sec|
||위에 제시한 파일이 존재하지 않거나 All deny 설정이 적용되지 않은 경우 또는, 시스템 접근 제한 IP 설정 필요 시 아래의 보안설정방법에 따라 설정을 변경함|

* **IPtables 사용하는 경우**   
* Step 1) iptables 명령어를 통해 접속할 IP 및 포트 정책 추가
  * (예) SSH 서비스 제한
  * #iptables -A INPUT -p tcp -s 192.168.1.0/24 --dport 22 -j ACCEPT
  * #iptables -A INPUT -p tcp --dport 22 -j DROP
* Step 2) iptables 설정 저장
  * #/etc/rc.d/init.d/iptables save

* **IPfilter 사용하는 경우**   
* Step 1) vi 편집기를 이용하여 "/etc/ipf/ipf.conf" 파일 열기
* Step 2) 접속할 IP 및 포트 정책 추가
  * (예) SSH 서비스 제한 
  * pass in quick proto tcp from 192.168.1.0/24 to any port = 22 keep state
  * block in quick proto tcp from any to any port = 22 keep state
* Step 3) IPfilter 서비스 재시작

* **TCP Wrapper 사용하는 경우**   
* Step 1) vi 편집기를 이용하여 "/etc/hosts.deny" 파일 열기 (해당 파일이 없을 경우 새로 생성)
* Step 2) 아래와 같이 수정 또는, 신규 삽입 (ALL Deny 설정)
  * (수정 전) 설정 없음
  * (수정 후) ALL:ALL
* Step 3) vi 편집기를 이용하여 "/etc/hosts.allow" 파일 열기 (해당 파일이 없을 경우 생성)
  * (수정 전) 설정 없음
  * (수정 후) sshd : 192.168.0.148, 192.168.0.6 (다른 서비스도 동일한 방식으로 설정)

* < TCP Wrapper 접근제어 가능 서비스 >
* SYSTAT, FINGER, FTP, TELNET, RLOGIN, RSH, TALK, EXEC, TFTP, SSH
* < TCP Wraaper는 다음 두 파일에 의해 접근이 제어됨 >
* /etc/hosts.deny --> 시스템 접근을 제한할 IP 설정
* /etc/hosts.allow --> 시스템 접근을 허용할 IP 설정
* 위의 두 파일이 존재하지 않을 시 --> 모든 접근 허용

* **HP-UX**   
* HP-UX 서버의 경우 "/var/adm/inetd.sec" 파일을 이용하여 서버 자체적으로 접근제어를 할 수 있으며, 해당 파일이 존재하지 않을 경우 "/usr/newconfig/var/adm/inetd.sec" 샘플 파일을 복사하여 사용함
* Step 1) vi 편집기를 이용하여 "/var/adm/inetd.sec" 파일 열기
  * (해당 파일이 없을 경우 새로 생성)
* Step 2) 아래와 같이 수정 또는, 신규 삽입 (ALL Deny 설정)
  * telnet 으로의 모든 접속 차단 => telnet deny \*.\*.\*.\*
  * telnet 접속을 허용할 IP 등록 => telnet allow [telnet 접속 허용 IP 등록]
