# 1. 계정관리
## 1.1 root 계정 원격접속 제한

||취약점 개요|
|:-:|:-|
|점검내용|시스템 정책에 root 계정의 원격터미널 접속차단 설정이 적용되어 있는지 점검|
|점검목적|관리자계정 탈취로 인한 시스템 장악을 방지하기 위해 외부 비인가자의 root 계정 접근 시도를 원천적으로 차단하기 위함|
|보안위협|root 계정은 운영체제의 모든기능을 설정 및 변경이 가능하여(프로세스, 커널변경 등) root 계정을 탈취하여 외부에서 원격을 이용한 시스템 장악 및 각종 공격으로(무작위 대입 공격) 인한 root 계정 사용 불가 위협|
|참고|※ root 계정: 여러 사용자가 사용하는 컴퓨터에서 모든 기능을 관리할 수 있는 총괄권한을 가진 유일한 특별 계정. 유닉스 시스템의 루트는 시스템 관리자인 운용 관리자(Super User)로서 윈도우의 Administrator 보다 높은 System 계정에 해당하며, 사용자 계정을 생성하거나 소프트웨어를 설치하고, 환경 및 설정을 변경하거나 시스템의 동작을 감시 및 제어할 수 있음 </br>무작위 대입 공격(Brute Force Attack): 특정한 암호를 풀기 위해 가능한 모든 값을 대입하는 공격 방법 </br>사전 대입 공격(Dictionary Attack): 사전에 있는 단어를 입력하여 암호를 알아내거나 암호를 해독하는 데 사용되는 공격 방법|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 원격 터미널 서비스를 사용하지 않거나, 사용 시 root 직접 접속을 차단한 경우 </br>취약 : 원격 터미널 서비스 사용 시 root 직접 접속을 허용한 경우|
|조치방법|원격 접속 시 root 계정으로 바로 접속 할 수 없도록 설정파일 수정|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS|**[Telnet]** </br>#cat /etc/default/login </br>CONSOLE=/dev/console </br>**[SSH]** </br>#cat /etc/ssh/sshd_config </br>PermitRootLogin no|
|LINUX|**[Telnet]** </br>#cat /etc/pam.d/login </br>auth required /lib/security/pam_securetty.so </br>#cat /etc/securetty </br>pts/0 ~ pts/x 관련 설정이 존재하지 않음 </br>**[SSH]** </br>#cat /etc/ssh/sshd_config </br>PermitRootLogin no|
|AIX|**[Telnet]** </br>#cat /etc/security/user </br>rlogin = false </br>**[SSH]** </br>#cat /etc/sshd_config </br>PermitRootLogin no|
|HP-UX|**[Telnet]** </br>#cat /etc/securetty </br>console </br>**[SSH]** </br>#cat /etc/sshd_config </br>PermitRootLogin no|
||위에 제시한 내용으로 설정되어 있을 경우 root 원격 접속이 차단됨 / 내용 설정에 대해서는 아래의 보안설정방법을 참고함|

* **SOLARIS**   
* [Telnet 서비스 사용시]   
* Step 1) vi 편집기를 이용하여 "/etc/default/login" 파일 열기   
* Step 2) 아래와 같이 주석 제거 또는, 신규 삽입   
  * (수정 전) #CONSOLE=/dev/console   
  * (수정 후) CONSOLE=/dev/console   
* [SSH 서비스 사용시]
* Step 1) vi 편집기를 이용하여 "/etc/ssh/sshd_config" 파일 열기   
* Step 2) 아래와 같이 주석 제거 또는, 신규 삽입   
  * (수정 전) #PermitRootLogin Yes   
  * (수정 후) PermitRootLogin No   

* **LINUX**   
* [Telnet 서비스 사용시]   
![image](https://github.com/zzzangmans1/Technical_vulnerability_analysis_evaluation_method_detailed_guide/assets/52357235/e68f290a-fda9-4492-8d51-a0c882e0dcf3)
* Step 1) "/etc/securetty" 파일에서 pts0/ ~ pts/x 설정 제거 또는, 주석 처리   

![image](https://github.com/zzzangmans1/Technical_vulnerability_analysis_evaluation_method_detailed_guide/assets/52357235/f4ecfb9f-9c18-4ec0-9443-8740e261a0f3)
* Step 2) "/etc/pam.d/login" 파일 수정 또는, 신규 삽입   
  * (수정 전) #auth required /lib/security/pam_securetty.so   
  * (수정 후) auth required /lib/security/pam_securetty.so   
   
※ /etc/securetty : Telnet 접속 시 root 접근 제한 설정 파일   
"/etc/securetty" 파일 내 *pts/x 관련 설정이 존재하는 경우 PAM 모듈 설정과 관계없이 root 계정 접속을 허용하므로 반드시 "securetty"파일에서 pts/x 관련 설정 제거 필요   
   
*pts/0 ~ pts/x 설정 :   
![image](https://github.com/zzzangmans1/Technical_vulnerability_analysis_evaluation_method_detailed_guide/assets/52357235/97eb5838-95b8-4bea-87d2-dd046933e84f)   
tty(terminal-teletype) : 서버와 연결된 모니터, 키보드 등을 통해 사용자가 콘솔로 직접 로그인함   
pts(pseudo-teminal, 가상터미널) : Telnet, SSH, 터미널 등을 이용하여 접속함   
</br>
* [SSH 서비스 사용시]   
* Step 1) vi 편집기를 이용하여 "/etc/ssh/sshd_config" 파일 열기   
* Step 2) 아래와 같이 주석 제거 또는, 신규 삽입   
  * (수정 전) #PermitRootLogin Yes   
  * (수정 후) PermitRootLogin No

* **AIX**   
* [Telnet 서비스 사용시]   
* Step 1) vi 편집기를 이용하여 "/etc/security/user" 파일 열기   
* Step 2) rlogin 설정을 아래와 같이 수정 또는, 신규 삽입 (root 설정에 해당되는 부분 수정)   
  * (수정 전) rlogin = true   
  * (수정 후) rlogin = false   
* rlogin(remote-login): 자주 접속하는 호스트에 대해 자동으로 원격 접속을 할 수 있도록 사용하는 명령어    

* [ssh 서비스 사용시]   
* Step 1) vi 편집기를 이용하여 "/etc/ssh/sshd_config" 파일 열기   
* Step 2) 아래와 같이 주석 제거 또는, 신규 삽입   
  * (수정 전) #PermitRootLogin Yes   
  * (수정 후) PermitRootLogin No   

* **HP-UX**   
* [Telnet 서비스 사용시]   
* Step 1) vi 편집기를 이용하여 "/etc/securetty" 파일 열기   
* Step 2) 아래와 같이 주석 제거 또는, 신규 삽입   
  * (수정 전) #console   
  * (수정 후) console

※ "/etc/securetty" 파일은 디폴트로 존재하지 않으므로 /etc 디렉터리 내에 "securetty" 파일이 존재하지 않는 경우 새로 생성한 후 적용함 (※ vi 편집기를 사용한 파일 내용 수정: 부록 참고)   
#vi /etc/securetty   
</br>
* [SSH 서비스 사용시]   
* Step 1) vi 편집기를 이용하여 "/etc/ssh/sshd_config" 파일 열기   
* Step 2) 아래와 같이 주석 제거 또는, 신규 삽입
  * (수정 전) #PermitRootLogin Yes   
  * (수정 후) PermitRootLogin No   

## 1.2 패스워드 복잡성 설정

||취약점 개요|
|:-:|:-|
|점검내용|시스템 정책에 사용자 계정(root 및 일반계정 모두 해당) 패스워드 복잡성 관련 설정이 되어 있는지 점검|
|점검목적|패스워드 복잡성 관련 정책이 설정되어 있는지 점검하여 비인가지의 공격(무작위 대입 공격, 사전 대입 공격 등)에 대비가 되어 있는지 확인하기 위함|
|보안위협|복잡성 설정이 되어있지 않은 패스워드는 사회공학적인 유추가 가능 할 수 있으며 암호화된 패스워드 해시값을 무작위 대입공격, 사전대입 공격 등으로 단시간에 패스워드 크렉이 가능함|
|참고|※ 패스워드 복잡성: 사용자 패스워드 설정 시 영문(대문자, 소문자), 숫자, 특수문자가 혼합된 일정 길이 이상으로 패스워드를 설정하는 방법|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 패스워드 최소길이 8자리 이상, 영문,숫자,특수문자 최소 입력 기능이 설정된 경우 </br>취약 : 패스워드 최소길이 8자리 이하로 설정된 경우|
|조치방법|계정과 유사하지 않은 8자 이상의 영문, 숫자, 특수문자의 조합으로 암호 설정 및 패스워드 복잡성 옵션 설정|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS|/etc/default/passwd|
|LINUX - RHEL5|/etc/pam.d/system-auth|
|LINUX - RHEL7|/etc/security/pwquality.conf|
|AIX|/etc/security/user|
|HP-UX|/etc/default/security|
||OS별 점검 파일을 열어 패스워드 복잡도 관련 설정 확인 후 아래의 보안설정방법에 따라 설정을 변경함(최소길이, 특수문자, 숫자 포함 등 설정|

* **SOLARIS, LINUX, AIX, HP-UX**
* <부적절한 패스워드 유형>
1. 사전에 나오는 단어나 이들의 조합
2. 길이가 너무 짧거나, NULL인 패스워드
3. 키보드 자판의 일련의 나열 (예) abcd, qwert, etc
4. 사용자 계정 정보에서 유추 가능한 단어들

* **< 패스워드 관리 방법 >**
1. 영문, 숫자, 특수문자를 조합하여 계정명과 상이한 8자 이상의 패스워드 설정
2. 시스템마다 상이한 패스워드 사용
3. 패스워드를 기록해 놓을 경우 변형하여 기록

* **< 패스워드 설정 파일 정리 >**
* **SOLARIS [10 이상버젼]**   
* Step 1) 패스워드 복잡성 설정 (/etc/default/passwd)   

|권장 값|기능|설명|
|-|-|-|
|HISTORY=10|이전 패스워드 기억 개수|이전 10개의 암호를 기억함|
|MINDIFF=4|이전 암호와 차이|이전 암호와 4자 이상 차이 요구|
|MINALPHA=1|최소 문자 요구|최소 1자 이상 문자 요구|
|MINNONALPHA=1|최소 숫자 또는 특수문자 요구|숫자 또는 특수문자 1자 이상 요구|
|MINUPPER=1|최소 대문자 요구|최소 1자 이상 대문자 요구|
|MINLOWER=1|최소 소문자 요구|최소 1자 이상 소문자 요구|
|MAXREPEATS=0|연속문자 사용 허용|0일 경우 문자 연속 사용이 불가|
|MINSPECIAL=1|최소 특수문자 요구|최소 1자 이상 특수문자 요구|
|MINDIGIT=1|최소 숫자 요구|최소 1자 이상 숫자 요구|
|NAMECHECK=YES|아이디와 패스워드 동일 검증|아이디와 동일한 패스워드 사용 불가|
|||※ DIGIT 이나 SPECAIL 이 설정되어 있을 경우 NONALPHA 설정 안 됨|

* **Linux - RHEL5**   
* Step 1) 패스워드 복잡성 설정 파일 확인 (/etc/pam.d/system-auth, /etc/login.defs 내용을 내부 정책에 맞도록 편집   
* Step 2) /etc/pam.d/system-auth 파일 설정   
  * 패스워드 정책 설정 예시
```
vi /etc/pam.d/system-auth

password requisite /lib/security/$ISA/pam_cracklib.so retry=3 minlen=8 lcredit=-1 ucredit=-1 dcredit=-1 ocredit=-1
```

* **LINUX - RHEL7**   
* Step 1) 패스워드 복잡성 설정 파일 확인 (/etc/security/pwquality.conf 파일 수정)   
  * 패스워드 정책 설정 예시
```
vi /etc/security/pwquality.conf

password requisite pam_cracklib.so try_first_pass retry=3 minlen=8 lcredit=-1 ucredit=-1 dcredit=-1 ocredit=-1
```
※ 각 변수에 대한 설명 / 각 항목에서 -1 값은 반드시 해당하는 문자를 포함시켜야 함   

|권장 값|기능|설명|
|-|-|-|
|lcredit=-1|최소 소문자 요구|소문자 최소 1자 이상 요구|
|ucredit=-1|최소 대문자 요구|최소 대문자 1자 이상 요구|
|dcredit=-1|최소 숫자 요구|최소 숫자 1자 이상 요구|
|ocredit=-1|최소 특수문자 요구|최소 특수문자 1자 이상 요구|
|minlen=8|최소 패스워드 길이 설정|최소 8자리 이상 설정|
|difok=N|기존 패스워드와 비교|기본값 10(50%)|

* **AIX**   
* Step 1) 패스워드 복잡성 설정 파일 확인 (/etc/security/user 파일 내용을 내부 정책에 맞도록 설정)   

|권장 값|기능|설명|
|-|-|-|
|dictionlist=/usr/share/dict/words|unix 명령어 포함 여부|검증경로 설정|
|histextpire=26|동일한 패스워드 재사용 기간|26주 후 사용가능|
|histsize=10|이전 패스워드 기억 개수|이전 10개 패스워드 기억(사용불가)|
|maxrepeats=2|반복 가능한 동일 문자의 최대 수|2개이상 동일문자 사용 금지|
|minalpha=2|최소 알파벳 문자 포함|2개 이상 알파벳 사용|
|minother=2|최소 알파벳 문자 이외의 문자 수|2개 이상 숫자, 특수문자 사용|
|mindiff=4|이전 패스워드와 동일문자 수|이전 패스워드와 4개까지 동일문자 사용|
|minlen=8|패스워드 최소 길이|8자리 이상 패스워드 작성|

* **HP-UX**   
* Step 1) 패스워드 복잡성 설정 (/etc/default/security 내용을 내부 정책에 맞도록 편집)   

|권장 값|기능|설명|
|-|-|-|
|MIN_PASSWORDE_LENGTH=8|암호의 최소 길이|최소 8자리 패스워드|
|PASSWORD_MIN_UPPER_CASE_CHARS=1|최소 대문자 필요 개수|최소 1개의 대문자|
|PASSWORD_MIN_LOWER_CASE_CHARS=1|최소 소문자 필요 개수|최소 1개의 소문자|
|PASSWORD_MIN_DIGIT_CHARS=1|최소 숫자 필요 개수|최소 1개의 숫자|
|PASSWORD_MIN_SPECIAL_CHARS=1|최소 특수문자 필요 개수|최소 1개의 특수문자|

* 조치 시 영향 : 패스워드 변경 시 Web, WAS, DB연동 구간에서 문제가 발생할 수 있으므로 연동 구간에 미칠 수 있는 영향을 고려하여 적용 필요

## 1.3 계정 잠금 임계값 설정

||취약점 개요|
|:-:|:-|
|점검내용|사용자 계정 로그인 실패 시 계정잠금 임계값이 설정되어 있는지 점검|
|점검목적|계정탈취 목적의 무작위 대입 공격 시 해당 계정을 잠금하여 인증 요청에 응답하는 리소스 낭비를 차단하고 대입 공격으로 인한 비밀번호 노출 공격을 무력화하기 위함|
|보안위협|패스워드 탈취 공격(무작위 대입 공격, 사전 대입 공격, 추측 공격 등)의 인증 요청에 대해 설정된 패스워드와 일치할 때까지 지속적으로 응답하여 해당 계정의 패스워드가 유출될 수 있음 |
|참고|※ 사용자 로그인 실패 임계 값: 시스템에 로그인 시 몇 번의 로그인 실패에 로그인을 차단할 것인지 결정하는 값|
||점검대상 및 판단기준|
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 계정 잠금 임계값이 10회 이하의 값으로 설정되어 있는 경우 </br>취약 : 계정 잠금 임계값이 설정되어 있지 않거나, 10회 이하의 값으로 설정되지 않은 경우|
|조치방법|계정 잠금 임계값을 10회 이하로 설정|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|

* **SOLARIS**
  * **- SOLARIS 5.9 이하 버전 -**
  * Step 1) vi 편집기를 이용하여 "/etc/default/login" 파일 열기
  * Step 2) 아래와 같이 수전 또는, 신규 삽입
    * (수정 전) #RETRIES=2
    * (수정 후) RETRIES=10 
  * **- SOLARIS 5.9 이상 버전 -** 
  * Step 1) vi 편집기를 이용하여 "/etc/default/login" 파일 열기
  * Step 2) 아래와 같이 수정 또는, 신규 삽입 (계정 잠금 횟수 설정)
    * (수정 전) #RETRIES=2
    * (수정 후) RETRIES=10
  * Step 3) vi 편집기를 이용하여 "/etc/security/policy.conf" 파일 열기
  * Step 4) 아래와 같이 수정 또는, 신규 삽입 (계정 잠금 정책사용 설정)
    * (수정 전) #LOCK_AFTER_RETRIES=NO
    * (수정 후) LOCK_AFTER_RETRIES=YES
* **LINUX**
  * Step 1) vi 편집기를 이용하여 "/etc/pam.d/system-auth" 파일 열기
  * Step 2) 아래와 같이 수정 또는, 신규 삽입
    * auth required /lib/security/pam_tally.so deny=5 unlock_time=120 no_magic_root
    * account required /lib/security/pam_tally.so no_magic_root reset

![image](https://github.com/zzzangmans1/Technical_vulnerability_analysis_evaluation_method_detailed_guide/assets/52357235/a3b4623d-ac04-4174-ad76-0aeb8a15954e)

|옵션|설명|
|:-:|:-|
|no_magic_root|root에게는 패스워드 잠금 설정을 적용하지 않음|
|deny=5|5회 입력 실패 시 패스워드 잠금|
|unlock_time|계정 잠김 후 마지막 게정 실패 시간부터 설정된 시간이 지나면 자동 계정 잠김 해제 (단위:초)|
|reset|접속 시도 성공 시 실패한 횟수 초기화|

* **AIX**
  * Step 1) vi 편집기를이용하여 "/etc/security/user" 파일 열기
  * Step 2) 아래와 같이 수정 또는, 신규 삽입
    * (수정 전) loginretries = 0
    * (수정 후) loginretries = 10

* **HP-UX**
  * **- HP-UX 11v2 이하 버전 -**
  * Step 1) vi 편집기를 이용하여 /tcb/files/auth/system/default 파일 열기
  * Step 2) 아래와 같이 수정 또는, 신규 삽입
    * (수정 전) u_maxtries#
    * (수정 후) u_maxtries#10

※ HP-UX 서버에 계정 잠금 정책 설정을 위해서는 HP-UX 서버가 Trusted Mode로 동작하고 있어야하므로 Trusted Mode로 전환한 후 잠금 정책 적용

  * **- HP-UX 11v3 이상 버전 -**
  * Step 1) vi 편집기를 이용하여 /etc/default/security 팡리 열기
  * Step 2) 아래와 같이 수정 또는, 신규 삽입
    * (수정 전) #AUTH_MAXTRIES=0
    * (수정 후) AUTH_MAXTRIES=10

※ Standard and Shadow modes only

### 조치 시 영향
HP-UX 경우 Trusted Mode로 전환 시 파일시스템 구조가 변경되어 운영 중인 서비스에 문제가 발생할 수 있으므로 충분한 테스트를 거친 후 Trusted Mode로의 전환이 필요함   
Linux의 pam.d/system-auth의 내용 수정 시 해당 라이브러리가 실제 존재하는지 확인 필요(/lib/security/pam_tally.so - 파일 미존재시 모든 계정 로그인 안되는 장애가 발생될수 있음) 

## 1.4 패스워드 파일 보호

||취약점 개요|
|:-:|:-|
|점검내용|시스템의 사용자 계정(root, 일반계정) 정보가저장된 파일(예 /etc/passwd, /etc/shadow)에 사용자 계정 패스워드가 암호화되어 있는지 점검|
|점검목적|일부 오래된 시스템의 경우 /etc/passwd 파일에 패스워드가 평문으로 저장되므로 사용자 계정 패스워드가 암호화되어 있는지 점검하여 비인가자의 패스워드 파일 접근 시에도 사용자 계정 패스워드가 안전하게 관리되고 있는지 확인하기 위함|
|보안위협|사용자 계정 패스워드가 저장된 파일이 유출 또는 탈취 시 평문으로 저장된 패스워드 정보가 노출될 수 있음|
||점검대상 및 판단기준|
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 쉐도우 패스워드를 사용하거나, 패스워드를 암호화하여 저장하는 경우 </br>취약 : 쉐도우 패스워드를 사용하지 않고, 패스워드를 암호화하여 저장하지 않는 경우|
|조치방법|패스워드 암호화 저장, 관리 설정 적용|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|

* **SOLARIS, LINUX**
  * Step 1) pwconv ---> 쉐도우 패스워드 정책 적용 방법
  * Step 2) pwunconv ---> 일반 패스워드 정책 적용 방법

* **AIX**
  * Step 1) #cat /etc/security/passwd
  * Step 2) 패스워드 암호화 여부 확인

※ AIX 서버는 기본적으로 "/etc/security/passwd" 파일에 패스워드를 암호화하여 저장, 관리

* **HP-UX**
  * HP-UX 서버는 Trusted Mode로 전환할 경우 패스워드를 암호화하여 "/tcb/files/auth" 디렉터리에 계정 이니셜과 계정 이름에 따라 파일로 저장,관리할 수 있으므로 Trusted Mode인지 확인 후 UnTrusted Mode인 경우 모드를 전환함
  * Step 1) Trusted Mode 전환 방법: root 계정으로 로그인한 후 아래 명령 수행
    * /etc/tsconvert 
  * Step 2) UnTrusted Mode 전환 방법: root 계정으로 로그인한 후 아래 명령 수행
    * /etc/tsconvert -r2

### 조치 시 영향
HP-UX 경우 Trusted Mode로 전환 시 파일시스템 구조가 변경되어 운영 중인 서비스에 문제가 발생할 수 있으므로 충분한 테스트를 거친 후 Trusted Mode로의 전환 필요

## 1.5 root 이외의 UID가 '0' 금지

||취약점 개요|
|:-:|:-|
|점검내용|사용자 계정 정보가 저장된 파일(예 /etc/passwd)에 root(UID=0) 계정과 동일한 UID(User Identification)를 가진 계정이 존재하는지 점검|
|점검목적|root 계정과 동일한 UID가 존재하는지 점검하여 root 권한이 일반 사용자 계정이나 비인가자의 접근 위협에 안전하게 보호되고 있는지 확인하기 위함|
|보안위협|root 계정과 동일 UID가 설정되어 있는 일반사용자 계정도 root 권한을 부여받아 관리자가 실행할 수 있는 모든 작업이 가능함(서비스 시작, 중지, 재부팅, root 권한 파일 편집 등) </br>root 동일한 UID를 사용하므로 사용자 감사 추적 시 어려움이 발생함|
|참고|※ UID(User Identification): 여러 명의 사용자가 동시에 사용하는 시스템에서 사용자가 자신을 대표하기 위해 쓰는 이름|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : root 계정과 동일한 UID를 갖는 계정이 존재하지 않는 경우 </br>취약 : root 계정과 동일한 UID를 갖는 계정이 존재하는 경우|
|조치방법|UID가 0인 계정 존재 시 변경할 UID를 확인 후 다른 UID로 변경 및 불필요 시 삭제, 계정이 사용 중이면 명령어 로 조치가 안 되므로 /etc/passwd 파일 설정 변경|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|#cat /etc/passwd </br>"/etc/passwd" 파일 내 UID 확인 (세 번째 필드값)|
||위에 제시한 설정이 적용되지 않은 경우 아래의 보안 설정 방법에 따라 설정을 변경함|

* **SOLARIS, LINUX, HP-UX**
* Step 1) usermod 명령으로 UID가 0인 일반 계정의 UID를 100 이상으로 수정
  * SOLARIS, HP-UX의 경우 100 이상
  * LINUX의 경우 500 이상
  * (예) test 계정의 UID를 100으로 바꿀 경우
```
usermod -u 100 test
```
※ 각 OS별로 사용자 UID 체계가 상이하여 시스템 계정 및 일반 사용자 계정이 부여받는 값의 범위에 차이가 있으며, 공통적으로 관리자는 "UID=0"을 부여받음

* **AIX**
* Step 1) chuser 명령으로 UID가 0인 일반 계정의 UID를 100 이상으로 수정
  * (예) test 계정의 UID를 100으로 바꿀 경우
```
chuser id=100 test
```

## 1.6 root 계정 su 제한

||취약점 개요|
|:-:|:-|
|점검내용|su 명령어 사용을 허용하는 사용자를 지정한 그룹이 설정되어 있는지 점검|
|점검목적|su 관련 그룹만 su 명령어 사용 권한이 부여되어 있는지 점검하여 su 그룹에 포함되지 않은 일반 사용자의 su 명령을 원천적으로 차단하는지 확인하기 위함|
|보안위협|무분별한 사용자 변경으로 타 사용자 소유의 파일을 변경할 수 있으며 root 계정으로 변경하는 경우 관리자 권한을 획득할 수 있음|
|참고|-|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : su 명령어를 특정 그룹에 속한 사용자만 사용하도록 제한되어 있는 경우 </br>※ 일반사용자 계정 없이 root 계정만 사용하는 경우 su 명령어 사용제한 불필요|
|조치방법|일반 사용자의 su 명령 사용 제한 </br>Step 1) Group 생성(생성할 그룹 요청, 일반적으로 wheel 사용) </br>Step 2) su 명령어의 그룹을 su 명령어 허용할 그룹으로 변경 </br>Step 3) su 명령어의 권한 변경(4750) </br>Step 4) su 명령어 사용이 필요한 계정을 새로 생성한 그룹에 추가(추가할 계정 요청) </br>※ LINUX의 경우, PAM(Pluggable Authentication Moudle)을 이용한 설정 가능 </br></br>PAM: 사용자를 인증하고 그 사용자의 서비스에 대한 액세스를 제어하는 모듈화 된 방법을 말하며, PAM은 관리자가 응용프로그램들의 사용자 인증 방법을 선택할 수 있도록 해줌|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|Step 1) "wheel" 그룹 (su 명령어 사용 그룹) 및 그룹 내 구성원 존재 여부 확인 </br>#cat /etc/group </br>Step 2) wheel 그룹이 su 명령어를 사용할 수 있는지 설정 여부 확인 </br>[SOLARIS] #ls -al /usr/bin/su </br>#chgrp security su </br>#chmod 4750 su </br>[AIX] #cat /etc/security/user ---> default의 "Sugroup=staff" 설정 확인 </br>[HP-UX] #vi /etc/default/security ---> SU_ROOT_GROUP=whell 설정 확인 </br>Step 3) 파일 권한 확인 </br>#ls -al /usr/bin/su (파일 권한이 4750인 경우 양호)|
|LINUX PAM 모듈 이용 시|Step 1) "wheel" 그룹 (su 명령어 사용 그룹) 및 그룹 내 구성원 존재 여부 확인 </br>#cat /etc/group </br>Step 2) 허용 그룹 (su 명령어 사용 그룹) 설정 여부 확인 </br>#cat /etc/pam.d/su </br>![image](https://github.com/zzzangmans1/Technical_vulnerability_analysis_evaluation_method_detailed_guide/assets/52357235/65a284f9-3e14-4400-a040-37f1af0358e4)|
||위에 제시한 설정이 적용되지 않은 경우 아래의 보안설정방법에 따라 설정을 변경함|

* **SOLARIS, LINUX, HP-UX**
* Step 1) wheel group 생성 (wheel 그룹이 존재하지 않는 경우)
```
groupadd wheel
```
* Step 2) su 명령어 그룹 변경
```
chgrp wheel /usr/bin/su
```
* Step 3) su 명령어 사용권한 변경
```
chmod 4750 /usr/bin/su
```
* Step 4) wheel 그룹에 su 명령 허용 계정 등록
```
usermod -G wheel <user_name>
```
  * 또는, 직접 /etc/group 파일을 수정하여 필요한 계정 등록

* **AIX**
* Step 1) wheel group 생성(wheel 그룹이 존재하지 않는 경우)
```
mkgroup wheel
```
* Step 2) su 명령어 그룹 변경
```
chgrp wheel /usr/bin/su
```
* Step 3) su 명령어 사용권한 변경
```
chmod 4750 /usr/bin/su
```
* Step 4) wheel 그룹에 su 명령 허용 계정 등록
```
chgroup users=<user_name> wheel
```

* **LINUX PAM 모듈을 이용한 설정 방법**
* Step 1) "/etc/pam.d/su" 파일을 아래와 같이 설정(주석제거)
```
auth sufficient /lib/security/pam_rootok.so
auth required /lib/security/pam_wheel.so debug group=wheel 또는,
auth sufficient /lib/security/$ISA/pam_rootok.so
auth required /lib/security/$ISA/pam_wheel.so use_uid
```
* Step 2) wheel 그룹에 su 명령어를 사용할 사용자 추가
```
usermod -G wheel <user_name>
# 또는, 직접 /etc/group 파일을 수정하여 필요한 계정 추가
```

### 조치 시 영향
그룹에 추가된 계정들은 모든 Session 종료 후 재로그인 시 su 명령어 사용 가능

## 1.7 패스워드 최소 길이 설정

||취약점 개요|
|:-:|:-|
|점검내용|시스템 정책에 패스워드 최소(8자 이상) 길이 설정이 적용되어 있는 점검|
|점검목적|패스워드 최소 길이 설정이 적용되어 있는지 점검하여 짧은(8자 미만) 패스워드 길이로 발생한느 취약점을 이용한 공격(무작위 대입 공격, 사전 대입 공격 등)에 대한 대비(사용자 패스워드 유출)가 되어 있는지 확인하기 위함|
|보안위협|패스워드 문자열이 짧은 경우 유추가 가능 할 수 있으며 암호화된 패스워드 해시값을 무작위 대입공격, 사전대입 공격 등으로 단시간에 패스워드 크랙이 가능함|
|참고|※ 패스워드 최소길이를 8자리 이상으로 설정하여도 특수문자, 대소문자, 숫자를 혼합하여 사용하여야함|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 패스워드 최소 길이가 8자 이상으로 설정되어 있는 경우 </br>취약 : 패스워드 최소 길이가 8자 미만으로 설정되어 있는 경우|
|조치방법|패스워드 정책 설정파일을 수정하여 패스워드 최소 길이를 8자 이상으로 설정|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS|#cat /etc/default/passwd|
|LINUX|#cat /etc/login.defs|
|AIX|#cat /etc/security/user|
|HP-UX|#cat /etc/default/security|
||위에 제시한 설정이 해당 파일에 적용되지 않은 경우 아래의 보안설정방법에 따라 설정을 변경함|

* **SOLARIS**
* Step 1) vi 편집기를 이용하여 "/etc/default/passwd" 파일 열기
* Step 2) 아래와 같이 수정 또는, 신규 삽입
  * (수정 전) PASSLENGTH=6
  * (수정 후) PASSLENGTH=8 (8 이상 권장)
 
* **LINUX**
* Step 1) vi 편집기를 이용하여 "/etc/login.defs" 파일 열기
* Step 2) 아래와 같이 수정 또는, 신규 삽입
  * (수정 전) PASS_MIN_LEN 6
  * (수정 후) PASS_MIN_LEN 8 (8 이상 권장)

* **AIX**
* Step 1) vi 편집기를 이용하여 "/etc/security/user" 파일 열기
* Step 2) default: 부분을 아래와 같이 수정 또는, 신규 삽입
  * (수정 전) minlen=6
  * (수정 후) minlen=8 (8 이상 권장)
 
* **HP-UX**
* Step 1) vi 편집기를 이용하여 "/etc/default/security" 파일 열기
* Step 2) 아래와 같이 수정 또는, 신규 삽입
  * (수정 전) MIN_PASSWORD_LENGTH=
  * (수정 후) MIN_PASSWORD_LENGTH=8 (8 이상 권장)

## 1.8 패스워드 최대 사용기간 설정

||취약점 개요|
|:-:|:-|
|점검내용|시스템 정책에 패스워드 최대(90일 이하) 사용기간 설정이 적용되어 있는지 점검|
|점검목적|패스워드 최대 사용 기간 설정이 적용되어 있는지 점검하여 시스템 정책에서 사용자 계정의 장기간 패스워드 사용을 방지하고 있는지 확인하기 위함|
|보안위협|패스워드 최대 사용기간을 설정하지 않은 경우 비인가자의 각종 공격(무작위 대입 공격, 사전 대입 공격 등)을 시도할 수 있는 기간 제한이 없으므로 공격자 입장에서는 장기적인 공격을 시행할 수 있어 시행한 기간에 비례하여 사용자 패스워드가 유출될 수 있는 확률이 증가함|
|참고|※|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 패스워드 최대 사용기간이 90일(12주) 이하로 설정되어 있는 경우 </br>취약 : 패스워드 최대 사용기간이 90일(12주) 이하로 설정되어 있지 않는 경우|
|조치방법|패스워드 정책 설정파일을 수정하여 패스워드 최대 사용기간을 90일(12주)로 설정|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS|#cat /etc/default/passwd|
|LINUX|#cat /etc/login.defs|
|AIX|#cat /etc/security/user|
|HP-UX|#cat /etc/default/security|
||위에 제시한 설정이 해당 파일에 적용되지 않은 경우 아래의 보안설정방법에 따라 설정을 변경함|

* **SOLARIS**
* Step 1) vi 편집기를 이용하여 "/etc/default/passwd" 파일 열기
* Step 2) 아래와 같이 수정 또는, 신규 삽입
  * (수정 전) MAXWEEKS=
  * (수정 후) MAXWEEKS=12 (단위: 주) 

* **LINUX**
* Step 1) vi 편집기를 이용하여 "/etc/login.defs" 파일 열기
* Step 2) 아래와 같이 수정 또는, 신규 삽입
  * (수정 전) PASS_MAX_DAYS 99999
  * (수정 후) PASS_MAX_DAYS 90 (단위: 일)
 
* **AIX**
* Step 1) vi 편집기를 이용하여 "/etc/security/user" 파일 열기
* Step 2) 아래와 같이 수정 또는, 신규 삽입
  * (수정 전) maxage=
  * (수정 후) maxage=12 (단위: 주)
 
* **HP-UX**
* Step 1) vi 편집기를 이용하여 "/etc/default/security" 파일 열기
* Step 2) 아래와 같이 수정 또는, 신규 삽입
  * (수정 전) PASSWORD_MAXDAYS=99999
  * (수정 후) PASSWORD_MAXDAYS=90 (단위: 일)

## 1.9 패스워드 최소 사용기간 설정

||취약점 개요|
|:-:|:-|
|점검내용|시스템 정책에 패스워드 최소 사용기간 설정이 적용되어 있는지 점검|
|점검목적|사용자가 자주 패스워드를 변경할 수 없도록 하고 관련 설정(최근 암호 기억)과 함께 시스템에 적용하여 패스워드 변경 전에 사용했던 패스워드를 재사용 할 수 없도록 방지하는지 확인하기 위함|
|보안위협|최소 사용기간이 설정되어 있지 않아 반복적으로 즉시 변경이 가능한 경우 이전 패스워드 기억 횟수를 설정하여도 반복적으로 즉시 변경하여 이전 패스워드로 설정이 가능함|
|참고|※ 최근 암호 기억: 사용자가 현재 암호 또는 최근에 사용했던 암호와 동일한 새 암호를 만드는 것을 방지하는 설정. 예를 들어 값 1은 마지막 암호만 기억한다는 의미이며 값 5는 이전 암호 5개를 기억한다는 의미임|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 패스워드 최소 사용기간이 1일 이상 설정되어 있는 경우 </br>취약 : 패스워드 최소 사용기간이 설정되어 있지 않는 경우|
|조치방법|패스워드 정책 설정파일을 수정하여 패스워드 최소 사용기간을 1일(1주)로 설정|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS|#cat /etc/default/passwd|
|LINUX|#cat /etc/login.defs|
|AIX|#cat /etc/security/user|
|HP-UX|#cat /etc/default/security|
||위에 제시한 설정이 해당 파일에 적용되지 않은 경우 아래의 보안설정방법에 따라 설정을 변경함

* **SOLARIS**
* Step 1) vi 편집기를 이용하여 "/etc/default/passwd" 파일 열기
* Step 2) 아래와 같이 수정 또는, 신규 삽입
  * (수정 전) MINWEEKS=
  * (수정 후) MINWEEKS=1 (단위: 주) 

* **LINUX**
* Step 1) vi 편집기를 이용하여 "/etc/login.defs" 파일 열기
* Step 2) 아래와 같이 수정 또는, 신규 삽입
  * (수정 전) PASS_MIN_DAYS
  * (수정 후) PASS_MIN_DAYS 1 (단위: 일) 

* **AIX**
* Step 1) vi 편집기를 이용하여 "/etc/security/user" 파일 열기
* Step 2) 아래와 같이 수정 또는, 신규 삽입
  * (수정 전) minage=
  * (수정 후) minage=1 (단위: 주) 

* **HP-UX**
* Step 1) vi 편집기를 이용하여 "/etc/default/security" 파일 열기
* Step 2) 아래와 같이 수정 또는, 신규 삽입
  * (수정 전) PASSWORD_MINDAYS=
  * (수정 후) PASSWORD_MINDAYS=1 (단위: 일) 

## 1.10 불필요한 계정 제거

||취약점 개요|
|:-:|:-|
|점검내용|시스템 계정 중 불필요한 계정(퇴직, 전직, 휴직 등의 이유로 사용하지 않는 계정 및 장기적으로 사용하지 않는 계정 등)이 존재하는지 점검|
|점검목적|불필요한 계정이 존재하는지 점검하여 관리되지 않은 계정에 의한 침입에 대비하는지 확인하기 위함|
|보안위협|로그인이 가능하고 현재 사용하지 않는 불필요한 계정은 사용중인 계정보다 상대적으로 관리가 취약하여 공격자의 목표가 되어 계정이 탈취될 수 있음 </br>퇴직, 전직, 휴직 등의 사유발생시 즉시 권한을 회수|
|참고|※ Default 계정: OS나 Package 설치 시 기본적으로 생성되는 계정(예 lp, uucp, nuucp 등) </br>※ 불필요한 default 계정 삭제 시 업무 영향도 파악 후 삭제 권고|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 불필요한 계정이 존재하지 않는 경우 </br>취약 : 불필요한 계정이 존재하는 경우|
|조치방법|현재 등록된 계정 현황 확인 후 불필요한 계정 삭제|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|Step 1) 미사용 계정 및 의심스러운 계정존재 여부 확인 </br>#cat /etc/passwd </br>Step 2) 사용하지 않는 Default 계정 점검 </br>#cat /etc/passwd \| egrep "lp\|uucp\|nuucp"|
|LOG를 통한 확인|Step 1) 최근 로그인하지 않은 계정 및 의심스러운 계정 확인 ```cat /var/adm/wtmp (SOLARIS, AIX, HP-UX``` </br>```cat /var/log/wtmp (LINUX)``` </br>```cat /var/adm/authlog (AIX, HP-UX)``` </br>```cat /var/log/authlog (SOLARIS)``` </br>```cat /var/adm/sulog (SOLARIS, AIX, HP-UX)``` </br>```cat /var/log/sulog (LINUX)``` </br>파일의 위치는 버전마다 다를 수 있음|
||위에 제시한 점검 방법에 의해 불필요한 계정 발견 시 아래의 보안설정방법에 따라 조치함|

* **SOLARIS, LINUX, HP-UX**
* Step 1) 서버에 등록된 불필요한 사용자 계정 확인
* Step 2) userdel 명령으로 불필요한 사용자 계정 삭제
```userdel <user_name>```

※ /etc/passwd 파일에서 계정 앞에 #을 삽입하여도 주석처리가 되지 않으므로 조치 시에는
반드시 계정을 삭제하도록 권고함

* **AIX**
* Step 1) 서버에 등록된 불필요한 사용자 계정 확인
* Step 2) rmuser 명령으로 불필요한 사용자 계정 삭제
```rmuser <user_name>```

## 1.11 관리자 그룹에 최소한의 계정 포함

||취약점 개요|
|:-:|:-|
|점검내용|시스템 관리자 그룹에 최소한(root 계정과 시스템 관리에 허용된 계정)의 계정만 존재하는지 점검|
|점검목적|관리자 그룹에 최소한의 계정만 존재하는지 점검하여 불필요하게 권한이 남용되고 있는지 확인하기 위함|
|보안위협|시스템을 관리하는 root 계정이 속한 그룹은 시스템 운영 파일에 대한 접근권한이 부여되어 있으므로 해당 관리자 그룹에 속한 계정이 비인가자에게 유출될 경우 관리자 권한으로 시스템에 접근하여 계정 정보 유출, 환경설정 파일 및 디렉터리 변조 등의 위협이 존재함|
|참고|-|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 관리자 그룹에 불필요한 계정이 등록되어 있지 않은 경우 </br>취약 : 관리자 그룹에 불필요한 계정이 등록되어 있는 경우|
|조치방법|현재 등록된 계정 현황 확인 후 불필요한 계정 삭|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, HP-AX|```cat /etc/group```![image](https://github.com/zzzangmans1/Technical_vulnerability_analysis_evaluation_method_detailed_guide/assets/52357235/dcb3d505-cf0a-4efe-96ef-9f116172f362)|
|AIX|```cat /etc/group```|
||관리자 용도 외의 계정이 root 그룹에 포함되어 있는 경우 아래의 보안설정방법에 따라 설정을 변경함|

* **SOLARIS, LINUX, HP-US**
* Step 1) vi 편집기를 이용하여 "/etc/group" 파일 열기
* Step 2) root 그룹에 등록된 불필요한 계정 삭제
  * (예) root 그룹에 등록된 불필요한 test 계정 삭제
  * (수정 전) ```root:x:0:root, test```
  * (수정 후) ```root:x:0:root```

* **AIX**
* Step 1) vi 편집기를 이용하여 "/etc/group" 파일 열기
* Step 2) system 그룹에 등록된 불필요한 계정 삭제
  * (예) system 그룹에 등록된 불필요한 test 계정 삭제
  * (수정 전) system\:!\:0\:root, test
  * (수정 후) system\:!\:0\:root

## 1.12 계정이 존재하지 않는 GID 금지

||취약점 개요|
|:-:|:-|
|점검내용|그룹(예 /etc/group) 설정 파일에 불필요한 그룹(계정이 존재하지 않고 시스템 관리나 운용에 사용되지 않는 그룹, 계정이 존재하고 시스템 관리나 운용에 사용되지 않는 그룹 등)이 존재하는지 점검|
|점검목적|시스템에 불필요한 그룹이 존재하는지 점검하여 불필요한 그룹의 소유권으로 설정되어 있는 파일의 노출에 의해 발생할 수 있는 위험에 대한 대비가 되어 있는지 확인하기 위함|
|보안위협|계정이 존재하지 않는 그룹은 현재 사용되고 있는 그룹이 아닌 불필요한 그룹으로 삭제 조치가 필요함.|
|참고|※ GID(Group Identification): 다수의 사용자가 특정 개체를 공유할 수 있게 연계시키는 특정 그룹의 이름으로 주로 계정처리 목적으로 사용되며, 한 사용자는 여러 개의 GID를 가질 수 있음. </br>※ /etc/group 파일과 /etc/passwd 파일을 비교하여 점검하기를 권고함|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 시스템 관리나 운용에 불필요한 그룹이 삭제 되어있는 경우 </br>취약 : 시스템 관리나 운용에 불필요한 그룹이 존재할 경우|
|조치방법|불필요한 그룹이 있을 경우 관리자와 검토하여 제거|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, HP-UX, AIX|```cat /etc/group``` </br>```cat /etc/passwd```|
|LINUX|```cat /etc/gshadow``` </br>\*gshadow 파일: "shadow" 파일에 사용자 계정의 암호가 저장되어 있는 것처럼 시스템 내 존재하는 그룹의 암호 정보 저장파일로 그룹 관리자 및 구성원 설정 가능 </br>"gshadow" 파일 내 필드는 다음과 같은 구조로 구성됨 </br> [그룹명 \: 패스워드 \: 관리자, 관리자, ... \: 멤버, 멤버, ... ]|
||계정이 존재하지 않고 시스템 관리나 운용에 사용되지 않는 그룹, 계정이 존재하고 시스템 관리나 운용에 사용되지 않는 그룹 등의 경우 아래의 보안설정 방법에 따라 그룹을 제거|

* **SOLARIS, LINUX, AIX, HP-UX**
 </br> ```groupdel <group_name>``` </br>
※ 해당 그룹 삭제시 그룹권한으로 존재하는 파일이 존재하는지 확인이 필요하며 사용자가 없는 그룹이라 하더라도 추후 권한 할당을 위해 그룹을 먼저 생성하였을 가능성도 존재하므로 무분별한 삭제는 권장하지 않으며 신규 생성된 그룹(GID 500 이상)을 중점적으로 점검 권고
