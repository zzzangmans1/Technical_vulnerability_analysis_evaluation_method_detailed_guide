# 3.서비스 관리
## 3.1 Finger 서비스 비활성

||취약점 개요|
|:-:|:-|
|점검내용|finger 서비스 비활성화 여부 점검|
|점검목적|Finger(사용자 정보 확인 서비스)를 통해서 네트워크 외부에서 해당 시스템에 등록된 사용자 정보를 확인할 수 있어 비인가자에게 사용자 정보가 조회되는 것을 차단하고자 함|
|보안위협|비인가자에게 사용자 정보가 조회되어 패스워드 공격을 통한 시스템 권한 탈취 가능성이 있으므로 사용하지 않는다면 해당 서비스를 중지하여야 함|
|참고|※ Finger(사용자 정보 확인 서비스): who 명령어가 현재 사용 중인 사용자들에 대한 간단한 정보만을 보여주는 데 반해 Finger 명령은 옵션에 따른 시스템에 등록된 사용자뿐만 아니라 네트워크를 통하여 연결되어 있는 다른 시스템에 등록된 사용자들에 대한 자세한 정보를 보여줌|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : Finger 서비스가 비활성화 되어 있는 경우 </br>취약 : Finger 서비스가 활성화 되어 있는 경우|
|조치방법|Finger 서비스 비활성화|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|LINUX, AIX, HP-UX, SOLARIS 5.9 이하 버전|#cat /etc/inetd.conf </br>#finger stream tcp nowait bin /usr/lbin/fingered </br>finered 주석처리 확인|
|SOLARIS 5.10 이상 버전|#inetadm | grep "finger"|
|LINUX (xinetd일 경우)|#ls -alL /etc/xinetd.d/* \| egrep "echo finger"|
||위에 제시된 파일 내 "finger" 서비스가 활성화된 경우 아래의 보안설정방법에 따라 서비스 중지|

* **LINUX, AIX, HP-UX, SOLARIS 5.9 이하 버전**
* Step 1) "/etc/inetd.conf" 파일에서 finger 서비스 라인 주석처리
  * (수정 전) #finger stream tcp nowait bin /usr/lbin/fingered fingerd
  * (수정 후) #finger stream tcp nowait bin /usr/lbin/fingered fingerd
* Step 2) inetd 서비스 재시작
  * #ps -ef | grep inetd
  * kill -HUP [PID]
 
* **SOLARIS 5.10 이상 버전**
  * inetadm -d "중지하고자 하는 데몬" 명령으로 서비스 데몬 중지
  * #inetadm -d svc:/network/finger:default
 
* **LINUX (xinetd일 경우)**
* Step 1) vi 편집기를 이용하여 "/etc/C/finger" 파일 열기
* Step 2) 아래와 같이 설정 (disable = yes 설정)
```
service finger
{
  socket_type    = stream
  wait           = no
  user           = nobody
  server         = /usr/sbin/in.fingerd
  disable        = yes
}
```
* Step 3) xinetd 서비스 재시작
  * #service xinetd restart

## 3.2 Anonymous FTP 비활성화

||취약점 개요|
|:-:|:-|
|점검내용|익명 FTP 접속 허용 여부 점검|
|점검목적|실행중인 FTP 서비스에 익명 FTP 접속이 허용되고 있는지 확인하여 접속허용을 차단하는 것을 목적으로 함|
|보안위협|Anonymous FTP(익명 FTP)를 사용 시 anonymous 계정으로 로그인 후 디렉터리에 쓰기 권한이 설정되어 있다면 악의적인 사용자가 local exploit을 사용하여 시스템에 대한 공격을 가능하게 함|
|참고|※ Anonymous FTP(익명 FTP): 파일 전송을 위해서는 원칙적으로 상대방 컴퓨터를 사용할 수 있는 계정이 필요하나 누구든지 계정이 없이도 anonymous 또는 ftp라는 로그인 명과 임의의 비밀번호를 사용하여 FTP를 실행할 수 있음|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : Anonymous FTP 접속을 차단한 경우 </br>취약 : Anonymous FTP 접속을 차단하지 않은 경우|
|조치방법|Anonymous FTP를 사용하지 않는 경우 Anonymous FTP 접속 차단 설정 적용|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|/etc/passwd 파일에 ftp 계정 존재 여부 확인 </br>#cat /etc/passwd | grep "ftp"|
||"passwd" 파일 내 ftp 계정이 존재하는 경우 아래의 보안설정방법에 따라 서비스 접속 제한|

* **SOLARIS, LINUX, AIX, HP-UX**
* Case 1) 일반 FTP - Anonymous FTP 접속 제한 설정 방법
  * "/etc/passwd" 파일에서 ftp 또는, anonymous 계정 삭제
  * SOLARIS, LINUX, HP-UX 설정: #userdel ftp
  * AIX 설정: #rmuser ftp
* Case 2) proFTP - Anonymous FTP 접속 제한 설정 방법
  * conf/proftpd.conf 파일의 anonymous 관련 설정 중 User, Useralias 항목 주석처리
  * (proftpd.conf 파일의 위치는 운영체제 종류별로 상이함)
  * <Anonymous ~ftp>          <- Anonymous 설정 구간
  * \# User   ftp             <- anonymous로 사용되는 계정
  * Group     ftp
  * \# UserAlias anonymous ftp <- 별칭으로 사용되는 계정
  * 이하생략
  * \</Anonymous>
* Case 3) vsFTP - Anonymous FTP 접속 제한 설정 방법
 * vsFTP 설정파일("/etc/vsftpd/vsftpd.conf" 또는, "/etc/vsftpd.conf")에서 anonymous_enable=NO 설정
 
## 3.3 r 계열 서비스 비활성화

||취약점 개요|
|:-:|:-|
|점검내용|r-command 서비스 비활성화 여부 점검|
|점검목적|r-command 사용을 통한 원격 접속은 NET Backup 또는 클러스터링 등 용도로 사용되기도 하나, 인증 없이 관리자 원격접속이 가능하여 이에 대한 보안위협을 방지하고자 함|
|보안위협|rsh, rlogin, rexec 등의 r command를 이용하여 원격에서 인증절차 없이 터미널 접속, 쉘 명령어를 실행이 가능함|
|참고|※ r-command: 인증 없이 관리자의 원격접속을 가능하게 하는 명령어들로 rsh(remsh), rlogin, rexec, rsync 등이 있음|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 불필요한 r 계열 서비스가 비활성화 되어 있는 경우 </br>취약 : 불필요한 r 계열 서비스가 활성화 되어 있는 경우|
|조치방법|NET Backup등 특별한 용도로 사용하지 않는다면 아래의 서비스 중지 </br> [shell(514)] [login(513)] [exec(512)]|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS 5.9 이하 버전|r-command 서비스 활성화 여부 확인 </br>#vi /etc/inetd.conf|
|AIX|#cat /etc/inetd.conf \| grep rlogin (#처리 되어 있으면 비활성화) </br>#cat /etc/inetd.conf \| grep rsh (#처리 되어 있으면 비활성화)|
|HP-UX|#vi /etc/inetd.conf </br>r로 시작하는 필드 존재 시 취약|
|SOLARIS 5.10 이상 버전|#inetadm \| egrep "shell\|rlogin\|rexec" </br>r command 관련 데몬 확인|
|LINUX (xinetd일 경우)|rsh, rlogin, rexec (shell, login, exec) 서비스 구동 확인 </br>#ls -alL /etc/xinetd.d/* \| egrep "rsh\|rlogin\|rexec" \| egrep -v "grep\|klogin\|kshell\|kexec"|
||위에 제시된 파일 내 "r-command계열" 서비스가 활성화 된 경우 아래의 보안설정 방법에 따라 서비스 지|

* **SOLARIS 5.9 이하, HP-UX**
* Step 1) r 계열 서비스 활성화 여부 확인
  * vi /etc/inetd.conf
* Step 2) r로 시작하는 필드 주석처리 후 재가동
  * (수정 전) shell stream tcp nowait root /usr/sbin/in.rshd in.rshd
  * (수정 후) #shell stream tcp nowait root /usr/sbin/in.rshd in.rshd
* SOLARIS) #kill -HUP [inetd PID]
* HP-UX #inetd -c
* **AIX**
* Step 1) r 계열 서비스 활성화 여부 확인
  * #cat /etc/inetd.conf | grep rlogin (# 처리 되어 있으면 비활성화)
  * #cat /etc/inetd.conf | grep rsh (# 처리 되어 있으면 비활성화)
  * #cat /etc/inetd.conf | grep exec (# 처리 되어 있으면 비활성화)
* Step 2) /etc/hosts.equiv 파일은 TRUSTED 시스템을 등록
* Step 3) .rhosts 파일은 사용자 별로 'r'command를 통해 접근이 가능하도록 설정할 수 있음 ($HOME/.rhosts)

* **SOLARIS 5.10 이상 버전**
* Step 1) r'command 관련 데몬 확인
  * svc\:/network/login\:rlogin
  * svc\:/network/rexec\:default
  * svc\:/network/shell\:kshell
* Step 2) inetadm -d "중지하고자 하는 데몬" 명령으로 데몬 중지
  * #inetadm -d svc\:/network/login\:rlogin
  * #inetadm -d svc\:/network/rexec\:default
  * #inetadm -d svc\:/network/shell\:kshell
 
* **LINUX (xinetd일 경우)**
* Step 1) vi 편집기를 이용하여 "/etc/xinetd.d/"
* Step 2) 아래와 같이 설정 (Disable = yes 설정)
```
/etc/xinetd.d/rlogin 파일
/etc/xinetd.d/rsh 파일
/etc/xinetd.d/rexec 파일

service rlogin
{
 socket_type     = stream
 wait            = no
 user            = nobody
 log_on_success += USERID
 log_on_failure += USERID
 server          = /usr/sdin/in.fingerd
 disable         = yes
}
```
* Step 3) xinetd 서비스 재시작
  * #service xinetd restart
* r-command 사용시 보안설정
* Step 1) r command 사용을 허용하는 호스트 및 계정 설정
  * -.rhosts, hosts.equiv 파일에 접근을 허용하는 hostname(IP) 명시
  * IP 등록시 공인 IP 설정은 금지
  * .rhosts, hosts.equiv 파일의 퍼미션을 600 이하로 설정
  * 필요시 TCP Wrapper를 이용하여 접근을 허용하는 IP를 등록하여 추가 보안 설정
 
### 조치 시 영향
rlogin, rshell, rexec 서비스는 backup, 클러스터링 등의 용도로 종종 사용되고 있으므로 해당 서비스 사용 유무를 확인하여 미사용시 서비스 중지 </br> (/etc/hosts.equiv 또는 각 홈 디렉터리 밑에 있는 .rhosts 파일에 설정 유무를 확인하여 해당 서비스 사용여부 확인 - 파일이 존재하지 않거나 해당파일 내에 설정이 없다면 사용하지 않는것으로 파악)

## 3.4 crond 파일 소유자 및 권한 설정

||취약점 개요|
|:-:|:-|
|점검내용|Cron 관련 파일의 권한 적절성 점검|
|점검목적|관리자외 cron 서비스를 사용할 수 없도록 설정하고 있는지 점검하는 것을 목적으로 함|
|보안위협|root 외 일반사용자에게도 crontab 명령어를 사용할 수 있도록 할 경우, 고의 또는 실수로 불법적인 예약 파일 실행으로 시스템 피해를 일으킬 수 있음|
|참고|※ Cron 시스템: 특정 작업을 정해진 시간에 주기적이고 반복적으로 실행하기 위한 데몬 및 설정 </br>※ cron.allow: 사용자 ID를 등록하면 등록된 사용자는 crontab 명령어 사용이 가능함 </br>※ cron.deny: 사용자 ID를 등록하면 등록된 사용자는 crontab 명령어 사용이 불가능함|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : crontab 명령어 일반사용자 금지 및 cron 관련 파일 640 이하인 경우 </br>취약 : crontab 명령어 일반사용자 사용가능하거나, crond 관련 파일 640 이상인 경우|
|조치방법|crontab 명령어 750 이하, cron 관련 파일 소유자 및 권한 변경(소유자 root, 권한 640 이하)|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|Cron 관련 파일 권한 확인 </br>#ls -al /usr/bin/crontab </br>rw-r----- root <cron 접근제어 파일>|

||OS별 점검 파일 위치||
|-|-|-|
|SOLARIS|/etc/cron.d/|crontab  <- 예약작업을 등록하는 파일 </br>cron.hourly  <- 시간단위 실행 스크립트 등록 </br>cron.daily  <- 일단위 실행 스크립트 등록 </br>cron.weekly  <- 주단위 실행 스크립트 등록 </br>cron.monthly  <- 월 단위 실행 스크립트 등록 </br>cron.allow  <- crontab 명령어 허용 사용자 </br>cron.deny  <- crontab 명령어 차단 사용자|
|LINUX|/etc/||
|AIX, HP-UX|/var/adm/cron/||
|공통|/var/spool/cron/ 또는 /var/spool/cron/crontabs/|사용자별 설정된 cron 작업 목록|
||"cron" 접근제어 설정이 적절하지 않은 경우 아래의 보안설정방법에 따라 설정을 변경함||

* **공통설정**
* Step 1) crontab 명령어 일반사용자 권한 삭제 (crontab 명령어 위치는 OS별 다를 수 있음)
* crontab 명령어는 SUID가 설정되어 있으므로 SUID 설정 제거
  * #ls -al /usr/bin/crontab
  * #chmod 750 /usr/bin/crontab
* Step 2) cron 관련 설정파일 소유자 및 권한 설정
  * chown root <cron 관련 파일>
  * chmod 640 <cron 관련 파일>

* **crontab 명령어를 일반사용자에게 허용하는 경우**
* Step 1) "/etc/cron.d/corn.allow" 및 "/etc/cron.d/cron.deny" 파일의 소유자 및 권한 변경
  * #chown root /etc/cron.d/cron.allow
  * #chmod 640 /etc/cron.d/cron.allow
  * #chown root /etc/cron.d/cron.deny
  * #chmod 640 /etc/cron.d/cron.deny
* Step 2) "/etc/cron.d/cron.allow" 및 "/etc/cron.d/cron.deny" 파일에 사용자 등록
  * #cat /etc/cron.allow (crontab 명령어 사용을 허용하는 사용자 등록)
  * #cat /etc/cron.deny (crontab 명령어 사용을 차단하는 사용자 등록)  

## 3.5 DoS 공격에 취약한 서비스 비활성화

||취약점 개요|
|:-:|:-|
|점검내용|사용하지 않는 DoS 공격에 취약한 서비스의 실행 여부 점검|
|점검목적|시스템 보안성을 높이기 위해 취약점이 많이 발표된 echo, discard, daytime, chargen, ntp, snmp 등 서비스를 중지함|
|보안위협|해당 서비스가 활성화되어 있는 경우 시스템 정보 유출 및 DoS(서비스 거부 공격)의 대상이 될 수 있음|
|참고|※ DoS(Denial of Service): 시스템을 악의적으로 공격해 해당 시스템의 자원을 부족하게 하여 원래 의도된 용도로 사용하지 못하게 하는 공격. 특정 서버에게 수많은 접속시도를 만들어 다른 이용자가 정상적으로 서비스 이용을 하지 못하게 하거나, 서버의 TCP 연결을 바닥내는 등의 공격이 이 범위에 포함됨|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 사용하지 않는 DoS 공격에 취약한 서비스가 비활성화 된 경우 </br>취약 : 사용하지 않는 DoS 공격에 취약한 서비스가 활성화 된 경우|
|조치방법|echo, discard, daytime, charge, ntp, dns, snmp 등 서비스 비활성화 설정|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS|#svcs -a \| grep echo </br>#svcs -a \| grep daytime </br>#svcs -a \| grep discard </br>#svcs -a \|chargen </br>echo, discard, daytime, chargen 서비스 활성 여부 확인|
|AIX, HP-UX|#vi /etc/inetd.conf </br>echo, discard, daytime, chargen 필드 주석처리 확인|
|SOLARIS 5.10 이상 버전|#inetadm \| grep enable \| egrep "echo\|discard\|daytime\|chargen" 명령으로 기타 서비스 데몬 확인|
||아래 제시된 DoS 공격에 취약한 서비스 중 사용하지 않는 서비스가 활성화 된 경우 아래의 보안설정방법에 따라 서비스 중지|

||DoS 공격에 취약한 서비스 예시|
|:-:|:-|
|echo(7)|클라이언트에서 보내는 메시지를 단순히 재전송|
|discard(9)|수신되는 임의 사용자의 데이터를 폐기하는 서비스|
|daytime(13)|daytime은 클라이언트의 질의에 응답하여 아스키 형태로 현재 시간과 날짜를 출력하는 데몬|
|chargen(19)|임의 길이의 문자열을 반환하는 서비스|
|NTP(123)|네트워크로 연결되어 있는 컴퓨터들끼리 클록 시각을 동기화시키는데 사용되는 서비스|
|DNS(53)|호스트의 도메인 이름을 호스트의 네트워크 주소로 바꾸거나 그 반대의 변환을 수행하는데 사용되는 서비스|
|SNMP(161/162)|네트워크 장비들로부터 필요한 정보를 가져와 장비 상태를 모니터링 하거나 설정값을 변경하는 등의 작업을 하여 네트워크 장비를 관리하는데 사용되는 서비스|
|SMTP(25)|인터넷에서 메일을 보내기 위해 사용되는 서비스|

* **SOLARIS**
* Step 1) echo 서비스 비활성화 설정
  * svcs -a | grep echo
  * svcadm disable svc\:/network/echo\:dgrm
  * svcadm disable svc\:/network/echo\:stream 
* Step 2) discard 서비스 비활성화 설정
  * svcs -a | grep discard
  * svcadm disable svc\:/network/discard\:dgrm
  * svcadm disable svc\:/network/discard\:stream
* Step 3) daytime 서비스 비활성화 설정
  * svcs -a | grep daytime
  * svcadm disable svc\:/network/daytime\:dgrm
  * svcadm disable svc\:/network/daytime\:stream
* Step 4) chargen 서비스 비활성화 설정
  * svcs -a | grep chargen
  * svcadm disable svc\:/network/chargen\:dgrm
  * svcadm disable svc\:/network/chargen\:stream

* **AIX**
* Step 1) vi 편집기를 이용하여 echo, discard, daytime, chargen 필드 주석처리
  * #vi /etc/inetd.conf
  * #echo  stream  tcp  nowait  root  internal
  * #discard  stream  tcp  nowait  root  internal
  * #daytime  stream  tcp  nowait  root  internal
  * #chargen  stream  tcp  nowait  root  internal
  * #echo  dgram  udp  wait  root  internal
  * #discard  dgram  udp  wait  root  internal
  * #daytime  dgram  udp  wait  root  internal 
  * #chargen  dgram  udp  wait  root  internal
* Step 2) 필드 주석처리 후 재가동
  * #refresh -s inetd

* **HP-UX**
* Step 1) vi 편집기를 이용하여 echo, discard, daytime, chargen 필드 주석처리
  * #vi /etc/inetd.conf
  * #echo  stream  tcp6  nowait  root  internal
  * #discard  stream  tcp6  nowait  root  internal
  * #daytime  stream  tcp6  nowait  root  internal
  * #chargen  stream  tcp6  nowait  root  internal
  * #echo  dgram  udp  nowait  root  internal
  * #discard  dgram  udp6  nowait  root  internal
  * #daytime  dgram  udp6  nowait  root  internal 
  * #chargen  dgram  udp6  nowait  root  internal
* Step 2) 필드 주석처리 후 재가동
  * #inetd -c

* **SOLARIS 5.10 이상 버전**
* Step 1) 기타 서비스 데몬 확인
  * #inetadm | grep echo
  * #inetadm | grep daytime
  * #inetadm | grep discard
  * #inetadm | grep chargen
* Step 2) inetadm -d "중지하고자 하는 데몬" 명령으로 서비스 데몬 중지
  * #inetadm -d svc\:/network/echo\:stream
 
* **LINUX (xinetd일 경우)**
* Step 1) vi 편집기를 이용하여 "/etc/xinetd.d/" 디렉터리 내 echo, discard, daytime, chargen 파일 열기
* Step 2) 아래와 같이 설정 (Disable = yes 설정)
```
/etc/xinetd.d/echo 파일(echo-dgram, echo-stream)
/etc/xinetd.d/discard 파일(discard-dgram, discard-stream)
/etc/xinetd.d/daytime 파일(daytime-dgram, daytime-stream)
/etc/xinetd.d/chargen 파일(chargen-dgram, chargen-stream)

service echo
{
  disable     = yes
  id          = echo-stream
  type        = internal
  wait        = no
  socket_type = stream
}
```
* Step 3) xinetd 서비스 재시작
  * #service xinetd restart 

## 3.6 NFS 서비스 비활성화


||취약점 개요|
|:-:|:-|
|점검내용|불필요한 NFS 서비스 사용여부 점검|
|점검목적|NFS(Network File System) 서비스는 한 서버의 파일을 많은 서비스 서버들이 공유하여 사용할 때 많이 이용되는 서비스이지만 이를 이용한 침해사고 위험성이 높으므로 사용하지 않는 경우 중지함|
|보안위협|NFS 서비스는 서버의 디스크를 클라이언트와 공유하는 서비스로 적정한 보안설정이 적용되어 있지 않다면 불필요한 파일 공유로 인한 유출위험이 있음|
|참고|※ NFS: 원격 컴퓨터의 파일시스템을 로컬 시스템에 마운트하여 마치 로컬 파일시스템처럼 사용할 수 있는 프로그램임 </br>※ NFS 서비스 사용은 원칙적으로 금지되어 있지만 불가피하게 필요한 경우 통제해야함|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 불필요한 NFS 서비스 관련 데몬이 비활성화 되어 있는 경우 </br>취약 : 불필요한 NFS 서비스 관련 데몬이 활성화 되어 있는 경우|
|조치방법|사용하지 않는다면 NFS 서비스 중지 </br>아래의 방법으로 NFS 서비스를 제거한 후 시스템 부팅 시, 스크립트 실행 방지가능 </br>1. /etc/dfs/dfstab(또는 /etx/exports)의 모든 공유 제거 </br>2. NFS 데몬(nfsd, statd, mountd) 중지 </br>3. 시동 스크립트 삭제 또는, 스크립트 이름 변경|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|LINUX, AIAX, HP-UX, SOLARIS 5.9 이하 버전|NFS 서비스 데몬 확인 (NFS 동작 SID 확인) </br>#ps -ef | egrep "nfs\|statd\|lockd"|
|SOLARIS 5.10 이상 버전|#inetadm \| egrep "nfs\|statd\|locked"|
||불필요한 "NFS" 서비스가 활성화된 경우 아래의 보안설정방법에 따라 서비스 데몬 중지|

* **LINUX, AIX, SOLARIS 5.9 이하 버전**
* Step 1) NFS 서비스 데몬 중지
  * #kill -9 [PID]
* Step 2) 시동 스크립트 삭제 또는, 스크립트 이름 변경
  * 1. 위치 확인
  * #ls -al /etc/rc.d/rc\*.d/\* | grep nfs
  * 2. 이름 변경
  * #mv /etc/rc.d/rc2.d/S60nfs /etc/rc.d/rc2.d/_S60nfs
* Step 3) 서비스 종료 후 비활성화
  * systemctl stop nfs
  * systemctl disable nfs 

* **HP-UX**
* Step 1) NFS 서비스 데몬 중지
  * kill -9 [PID]
* Step 2) /etc/rc.config.d/nfsconf 파일 설정 수정
  * vi /etc/rc.config.d/nfsconf
  * (수정 전) NFS_SERVER=1
  * (수정 후) NFS_SERVER=0

* **SOLARIS 5.10 이상 버전 설정 방법**
* Step 1) NFS 서비스 데몬 확인
  * svc\:/network/nfs/server\:default
* Step 2) inetadm -d "중지하고자 하는 데몬" 명령으로 서비스 데몬 중지
  * inetaadm -d svc\:/network/nfs/server\:default
 
### 조치 시 영향
showmount, share, exportfs 등의 명령어를 사용하여 로컬 서버에 마운트 되어 있는 디렉터리 확인 및 NFS 설정파일에 공유디렉터리 설정 여부 확인 후 해당 디렉터리가 존재하지 않을 경우 서비스 중지 가능

## 3.7 NFS 접근 통제

||취약점 개요|
|:-:|:-|
|점검내용|NFS 사용 시 허가된 사용자만 접속할 수 있도록 접근제한 설정 적용 여부 점검|
|점검목적|접근권한이 없는 비인가자의 접근을 통제함|
|보안위협|접근제한 설정이 적절하지 않을 경우 인증절차 없이 비인가자의 디렉터리나 파일의 접근이 가능하며, 해당 공유 시스템에 원격으로 마운트하여 중요 파일을 변조하거나 유출할 위험이 있음|
|참고|※ NFS: 원격 컴퓨터의 파일시스템을 로컬 시스템에 마운트하여 마치 로컬 파일시스템처럼 사용할 수 있는 프로그램임 </br>※ NFS 서비스 사용 금지가 원칙이나 불가피하게 사용이 필요한 경우 NFS v2, v3은 평문으로 전송되는 취약점이 있기 때문에 암호화되는 v4를 사용하는 것을 권고함|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 불필요한 NFS 서비스를 사용하지 않거나, 불가피하게 사용 시 everyone 공유를 제한한 경우 </br>취약 : 불필요한 NFS 서비스를 사용하고 있고, everyone 공유를 제한하지 않은 경우|
|조치방법|사용하지 않는다면 NFS 서비스 중지, 사용할 경우 NFS 설정파일에 everyone 공유 설정 제거|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, HP-UX|/etc/dfs/dfstab, /etc/dfs/sharetab 파일|
|LINUX, AIX, HP-UX|/etc/exoirts 파일|
||불가피하게 NFS 서비스를 사용하여야 하는 경우 NFS 접근제어 파일에 꼭 필요한 공유 디렉터리만 나열하고, everyone으로 시스템이 마운트 되지 않도록 설정|

* **/etc/dfs/dfstab 설정 예문**
* rw=client, ro=client 형식으로 접속 허용 client 지정
  * 사용자의 읽기, 쓰기 권한 접속 허용 : share -F nfs -o rw, ro /export/home/test
  * 사용자의 권한 접속 제한: share -F nfs -o rw=client1\:client2, ro=client1\:client2 /export/home/test
  * 읽기(ro), 쓰기(rw) 권한에 각각 사용자를 설정하여야 읽기, 쓰기 권한 모두 제한 가능

* **/etc/export 설정 예문**
* Step 1) /etc/exports 파일에 접근 가능한 호스트명 추가
  * (예) /stand host1(또는 IP주소) host2
* Step 2) 접속 시 인증 및 클라이언트 권한 nobody 설정
  * vi /etc/export
  * /stand host1 (root_squash)
  * () 옵션에 인증되지 않은 액세스를 허용하는 "insecure" 구문 설정 금지
* Step 3) NFS 서비스 재구동
  * #/etc/exportfs -u
  * #/etc/exportfs -a

### 조치 시 영향
showmount, share, exportfs 등의 명령어를 사용하여 로컬 서버에 마운트 되어 있는 디렉터리 확인 및 NFS 설정파일에 공유디렉터리 설정 여부 확인 후 해당 디렉터리가 존재하지 않을 경우 서비스 중지 가능

## 3.8 automountd 제거

||취약점 개요|
|:-:|:-|
|점검내용|automountd 서비스 데몬의 실행 여부 점검|
|점검목적|로컬 공격자가 automountd 데몬에 RPC(Remote Procedure Call)를 보낼 수 있는 취약점이 존재하기 때문에 해당 서비스가 실행중일 경우 서비스를 중지시키기 위함|
|보안위협|파일 시스템의 마운트 옵션을 변경하여 root 권한을 획득할 수 있으며, 로컬 공격자가 automountd 프로세스 권한으로 임의의 명령을 실행할 수 있음|
|참고|※ automountd: 클라이언트에서 자동으로 서버에 마운트를 시키고 일정 시간 사용하지 않으면 unmount 시켜 주는 기능을 말함 </br>※ RPC: 별도의 원격 제어를 위한 코딩 없이 다른 주소 고|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : automountd 서비스가 비활성화 되어 있는 경우 </br> 취약 : automountd 서비스가 활성화 되어 있는 경우|
|조치방법|automountd 서비스 비활성|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|LINUX, AIX, HP-UX, SOLARIS 5.9 이하 버전|automountd 서비스 데몬 확인 (automountd 동작 SID 확인) </br>#ps -ef \| grep automount(or autofs)|
|SOLARIS 5.10 이상 버전|automount 서비스 데몬 확인 </br>#svcs -a | grep "autofs"|

* **LINUX, AIX, SOLARIS 5.9 이하 버전**
* Step 1) automount 서비스 데몬 중지
  * #kill -9 [PID]
* Step 2) 시동 스크립트 삭제 또는, 스크립트 이름 변경
  *  위치 확인
  *  #ls -al /etc/rc.d/rc*.d/* | grep automount(or autofs)
  *  이름 변경
  *  #mv /etc/rc.d/rc2.d/S28automountd /etc/rc.d/rc2.d/_S28automountd
 
* **HP-UX**
* Step 1) automount 서비스 데몬 중지
  * #kill -9 [PID] 
* Step 2) /etc/rc.config.d/nfsconf 파일 설정 수정
  * #vi /etc/rc.config.d/nfsconf
  * (수정 전) AUTOFS=1
  * (수정 후) AUTOFS=0

* **SOLARIS 5.10 이상 버전**
* Step 1) autofs 서비스 데몬 확인
  * #svc\:/system/filesystem/autofs\:default
* Step 2) svcadm disable "중지하고자 하는 데몬" 명령으로 서비스 데몬 중지
  * #svcadm disable svc\:/system/filesystem/autofs\:default

### 조치 시 영향
NFS 및 삼바(Samba) 서비스에서 사용 시 automountd 사용 여부 확인 필요하며, 적용 시 CDROM의 자동 마운트는 이뤄지지 않음 (/etc/auto.\*, /etc/auto_\* 파일을 확인하여 필요 여부 확인)   
※ 삼바(Samba) : 서로 다른 운영체제 간의 자원 공유를 위해 이용하는 서버로 같은 네트워크 내 연결된 PC는 서로 운영체제가 달라도 네트워크로 파일을 주고받을 수 있고 자원을 공유할 수 있음

## 3.9 RPC 서비스 확인

||취약점 개요|
|:-:|:-|
|점검내용|불필요한 RPC 서비스의 실행 여부 점검|
|점검목적|다양한 취약성(버퍼 오버플로우, DoS, 원격실행 등)이 존재하는 RPC 서비스를 점검하여 해당 서비스를 비활성화 하도록 함|
|보안위협|버퍼 오버플로우, DoS, 원격실행 등의 취약성이 존재하는 RPC 서비스를 통해 비인가자의 root 권한 획득 및 침해사고 발생 위험이 있으므로 서비스를 중지하여야 함|
|참고|※ RPC(Remote Procedure Call): 별도의 원격 제어를 위한 코딩 없이 다른 주소 공간에서 함수나 프로시저를 실행할 수 있게 하는 프로세스 간 프로토콜 </br>※ 불필요한 RPC 서비스: rpc.cmsd, rpc.ttdbserverd, sadmind, rusersd, walld, sprayd, rstatd, rpc.nisd, rexd, rpc.pcnfsd, rpc.statd, rpc.ypupdated, rpc.rquotad, kcms_server, cachefsd (※ 각 서비스 설명은 부록 참조)|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 불필요한 RPC 서비스가 비활성화 되어 있는 경우 </br>취약 : 불필요한 RPC 서비스가 활성화 되어 있는 경우|
|조치방법|일반적으로 사용하지 않는 RPC 서비스들을 inetd.conf 파일에서 주석 처리한 후 inetd 재구동 (진단 보고서에 발견된 RPC 서비스 조치)|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|LINUX, AIX, HP-UX, SOLARIS 5.9 이하 버전|불필요한 RPC 서비스 비활성화 여부 확인 </br>#cat /etc/inetd.conf|
|LINUX(xinetd)|"/etc/xinetd.d" 디렉터리 내 서비스별 파일 비활성화 여부 확인 </br>#vi /etc/xinetd.d/{서비스별 파일명}|
|SOLARIS 5.10 이상 버전|RPC 서비스 관련 데몬 확인 </br>#inetadm \| grep rpc \| grep enabled \| egrep "ttdbserver\|rex\|rstart\|rusers\|spray\|wall\|rquota\|"|
||불필요한 "RPC" 서비스가 활성화된 경우 아래의 보안설정방법에 따라 서비스 데몬 중지|

* **LINUX, AIX, HP-UX, SOLARIS 5.9 이하 버전**
* Step 1) "/etc/inetd.conf" 파일에서 해당 라인 주석처리
  * (수정 전) #rpc.cmsd/2-4 dgram rpc/udp wait root /usr/dt/bin/rpc.cmsd rpc.cmsd
  * (수정 후) #rpc.cmsd/2-4 dgram rpc/udp wait root /usr/dt/bin/rpc.cmsd rpc.cmsd
* Step 2) inetd 서비스 재시작
  * #ps -ef | grep inetd
  * kill -HUP {PID}

* **LINUX (xinetd일 경우)**
* Step 1) vi 편집기를 이용하여 "/etc/xinetd.d/" 디렉터리 내의 불필요한 RPC 서비스 파일 열기
* Step 2) 아래와 같이 설정 (Disable = yes 설정)
```
service finger
{
  disable     = yes
  socket_type = stream
  wait        = no
}
```
* Step 3) xinetd 서비스 재시작
  * #service xinetd restart

* **SOLARIS 5.10 이상 버전**
* Step 1) 불필요한 rpc 서비스 관련 데몬 확인
  * svc\:/network/rpc/cde-ttdbserver\:tcp
  * svc\:/network/rpc/rex\:default
  * svc\:/network/rpc/rstat\:default
  * svc\:/network/rpc/rusers\:default
  * svc\:/network/rpc/spray\:default
  * svc\:/network/rpc/wall\:default
  * svc\:/network/rpc/rquota\"default
* Step 2) svcadm disable "중지하고자 하는 데몬" 명령으로 서비스 데몬 중지
  * inetadm -d svc\:/network/rpc/rusers\:default  

## 3.10 NIS, NIS+ 점검

||취약점 개요|
|:-:|:-|
|점검내용|안전하지 않은 NIS 서비스의 비활성화, 안전한 NIS+ 서비스의 활성화 여부 점검|
|점검목적|안전하지 않은 NIS 서비스를 비활성화 하고 안전한 NIS+ 서비스를 활성화하여 시스템 보안수준을 향상하고자 함|
|보안위협|보안상 취약한 서비스인 NIS를 사용하는 경우 비인가자가 타시스템의 root 권한 획득이 가능하므로 사용하지 않는 것이 가장 바람직하나 만약 NIS를 사용해야 하는 경우 사용자 정보보안에 많은 문제점을 내포하고 있는 NIS보다 NIS+를 사용하는 것을 권장함|
|참고|※ NIS 주 서버는 정보표를 소유하여 NIS 대응 파일들로 변환하고, 이 대응 파일들이 네트워크를 통해 제공됨으로써 모든 컴퓨터에 정보가 갱신되도록 함. 네트워크를 통한 공유로부터 관리자와 사용자들에게 일관성 있는 시스템 환경을 제공함|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : NIS 서비스가 비활성화 되어 있거나, 필요 시 NIS+를 사용하는 경우 </br>취약 : NIS 서비스가 활성화 되어 있는 경우|
|조치방법|NIS 관련 서비스 비활성화|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|LINUX, AIX, HP-UX, SOLARIS 5.9 이하 버전|NIS, NIS+ 서비스 구동 확인 </br>#ps -ef \| egrep "ypserv\|ypbind\|ypxfrd\|rpc.yppasswdd\|rpc.ypupdated"|
|SOLARIS 5.10 이상 버전|서비스 데몬 구동 여부 확인 </br>#svcs -a \| grep nis|
||불필요한 "NIS" 서비스가 활성화된 경우 아래의 보안설정방법에 따라 서비스 데몬 중지|

||NIS 관련 서비스 데몬|
|:-:|:-|
|ypserv|master와 slave 서버에서 실행되며 클라이언트로부터의 ypbind 요청에 응답|
|ypbind|모든 NIS 시스템에서 실행되며 클라이언트와 서버를 바인딩하고 초기화함|
|rpc.yppasswdd|사용자들이 패스워드를 변경하기 위해 사용|
|ypxfrd|NIS 마스터 서버에서만 실행되며 고속으로 NIS 맵 전송|
|rpc.ypupdated|NIS 마스터 서버에서만 실행되며 고속으로 암호화하여 NIS 맵전송|

* **LINUX, AIX, SOLARIS 5.9 이하 버전**
* Step 1) NFS 서비스 데몬 중지
  * #kill -9 [PID]
* Step 2) 시동 스크립트 삭제 또는, 스크립트 이름 변경
  * 1. 위치 확인
  * #ls -al /etc/rc.d/rc*.d/* | egrep "ypserv\|ypbind\|ypxfrd\|rpc.yppasswdd\|rpc.ypupdated"
  * 2. 이름 변경
  * #mv /etc/rc.d/rc2.d/S73ypbind /etc/rc.d/rc2.d/_S73ypbind

* **HP-UX**
* Step 1) NFS 서비스 데몬 중지
  * #kill -9 [PID]
* Step 2) 시동 스크립트 삭제 또는, 스크립트 이름 변경
  * 1. 위치 확인
  * #ls -al /etc/rc.d/rc*.d/* \| egrep "ypserv\|ypbind\|ypxfrd\|rpc.yppasswdd\|rpc.ypupdated"
  * 2. /etc/rc.config.d/namesvrs 파일에서 NIS_MASTER_SERVER, NIS_SLAVE_SERVER, NIS_CLIENT 값을 0으로 설정
  * NIS_MASTER_SERVER=0
  * NIS_SLAVE_SERVER=0
  * NIS_CLIENT_SERVER=0
 
* **SOLARIS 5.10 이상 버전**
* Step 1) NIS 관련 서비스 데몬 확인
  * online 16\:44\:06 svc\:/network/nis/client\:default
  * online 16\:44\:07 svc\:/network/nis/passwd\:default
  * online 16\:44\:07 svc\:/network/nis/server\:default
  * online 16\:44\:07 svc\:/network/nis/update\:default
  * online 16\:44\:07 svc\:/network/nis/xfr\:default
* Step 2) svcadm disable "중지하고자 하는 데몬" 명령으로 서비스 데몬 중지
  * svcadm disable svc\:/network/nis/server\:default
  * svcadm disable svc\:/network/nis/client\:default
  * svcadm disable svc\:/network/nis/passwd\:default
  * svcadm disable svc\:/network/nis/update\:default
  * svcadm disable svc\:/network/nis/xfr\:default

※ NIS 사용이 반드시 필요 시 NIS+ 사용

## 3.11 tftp, talk 서비스 비활성화

||취약점 개요|
|:-:|:-|
|점검내용|tftp, talk 등의 서비스를 사용하지 않거나 취약점이 발표된 서비스의 활성화 여부 점검|
|점검목적|안전하지 않거나 불필요한 서비스를 제거함으로써 시스템 보안성 및 리소스의 효율적 운용|
|보안위협|사용하지 않는 서비스나 취약점이 발표된 서비스 운용 시 공격 시도 가능|
|참고|※|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : tftp, talk, ntalk 서비스가 비활성화 되어 있는 경우 </br>취약 : tftp, talk, ntalk 서비스가 활성화 되어 있는 경우|
|조치방법|시스템 운영에 불필요한 서비스 비활성화|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|LINUX, AIX, HP-UX, SOLARIS 5.9 이하 버전|불필요한 서비스 데몬 확인 </br>#cat /etc/inetd.conf \| grep "tftp\|talk\|ntalk"|
|LINUX(xinetd)|tftp, talk, ntalk 서비스 활성화 여부 확인 </br>#vi /etc/xinetd.d/tftp </br>#vi /etc/xinetd.d/talk </br>#vi /etc/xinetd.d/ntalk|
|SOLARIS 5.10 이상 버전|서비스 데몬 확인 </br>#inetadm \| egrep "tftp\|talk"|
||불필요한 "tftp, talk, ntalk" 서비스가 활성화된 경우 아래의 보안설정방법에 따라 서비스 데몬 중지|

||OS별 점검 파일 위치 및 점검 방법|
|:-:|:-|
|tftp(69)|파일 전송을 위한 프로토콜로서 FTP서비스 보다 구조가 단순하며 적은 양의 데이터를 보낼 때 사용됨, 주로 원격의 부팅파일을 불러오거나 설치 프로세스를 시작하기 위한 초기 데이터 호출 용도로 사용. 서비스 사용시 인증절차가 없어 보안에 취약함.|
|talk(517)|사용자가 시스템에 원격으로 연결하여 다른 시스템에 로그인하고 있는 사용자와 대화 세션을 시작할 수 있음|
|ntalk(518)|서로 다른 시스템 간에 채팅을 가능하게 하는 서비스|

* **LINUX, AIX, HP-UX, SOLARIS 5.9 이하 버전**
* Step 1) vi 편집기를 이용하여 "/etc/inetd.conf" 파일 열기
  * #vi /etc/inetd.conf
* Step 2) tftp, talk, ntalk 서비스 주석 처리
  * #tftp dgram udp6 SRC nobody /usr/sbin/tftpd tftpd -n
  * #talk dgram udp wait root /usr/sbin/talkd talkd
  * #ntalk dgram udp wait root /usr/sbin/talkd talkd
* Step 3) inetd 데몬 재시작
  * AIX) #refresh -s inetd
  * HP-UX) #inetd -c
  * LINUX, SOLARIS) #kill -HUP [inetd pid]
 
* **LINUX (xinetd일 경우)**
* Step 1) vi 편집기를 이용하여 "/etc/xinetd.d/" 디렉터리 내 tftp, talk, ntalk 파일 열기
* Step 2) 아래와 같이 설정 (Disable = yes 설정)
```
/etc/xinetd.d/tftp 파일
/etc/xinetd.d/talk 파일
/etc/xinetd.d/ntalk 파일

service tftp
{
  socket_type          = dgram
  protocol             = udp
  wait                 = yes
  user                 = root
  server               = /usr/sbin/in.tftpd
  server_args          = -s /tftpboot
  disable              = yes
}
```
* Step 3) xinetd 서비스 재시작
  * #service xinetd restart
 
* **SOLARIS 5.10 이상 버전**
* Step 1) 불필요한 서비스 데몬 확인
  * svc\:/network/tftp\:default
  * svc\:/network/talk\:default
  * svc\:/network/ntalk\:default
* Step 2) inetadm -d "중지하고자 하는 데몬" 명령으로 서비스 데몬 중지
  * #inetadm -d svc\:/network/tftp\:default
  * #inetadm -d svc\:/network/talk\:default
  * #inetadm -d svc\:/network/ntalk\:default   

## 3.12 Sendmail 버전 점검

||취약점 개요|
|:-:|:-|
|점검내용|취약한 버전의 Sendmail 서비스 이용 여부 점검|
|점검목적|Sendmail 서비스 사용 목적 검토 및 취약점이 없는 버전의 사용 유무 점검으로 최적화된 Sendmail 서비스의 운영|
|보안위협|취약점이 발견된 Sendmail 버전의 경우 버퍼 오버플로우 공격에 의한 시스템 권한 획득 및 주요 정보 요출 가능성이 있음|
|참고|※ Sendmail 서비스의 경우 최신버전(2016.01 기준 8.15.2) 이하 대부분의 버전에서 취약점이 보고되고 있기 떄문에 O/S 관리자, 서비스 개발자가 패치 적용에 따른 서비스 영향 정도를 정확히 파악하고 주기적인 패치 적용 정책을 수립하여 적용함|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : Sendmail 버전이 최신버전인 경우 </br>취약 : Sendmail 버전이 최신버전이 아닌 경우|
|조치방법|Sendmail 서비스를 사용하지 않을 경우 서비스 중지, 재부팅 후 다시 시작하지 않도록 시작 스크립트 변경, 사용할 경우 패치 관리 정책을 수립하여 주기적으로 패치 적용|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|1. Sendmail 서비스 실행 여부 점검 </br>#ps -ef \| grep sendmail </br>2. Sendmail 버전 점검 </br>#telnet localhost 25|
||"Sendmail" 서비스가 활성화된 경우 아래의 보안설정방법에 따라 서비스 중지 또는, 버전 업그레이드|

* **SOLARIS, LINUX, AIX, HP-UX**
* Snedmail 서비스 실행 여부 및 버전 점검 후, http://www.sendmail.org/ 또는, 각 OS 벤더사의 보안 패치 설치

### 조치 시 영향
패치를 적용할 경우 시스템 및 서비스의 영향 정도를 충분히 고려하여야 함

## 3.13 스팸 메일 릴레이 제한

||취약점 개요|
|:-:|:-|
|점검내용|SMTP 서버의 릴레이 기능 제한 여부 점검|
|점검목적|스팸 메일 서버로의 악용방지 및 서버 과부하의 방지를 위함|
|보안위협|SMTP 서버의 릴레이 기능을 제한하지 않는 경우, 악의적인 사용목적을 가진 사용자들이 스팸메일 서버로 사용하거나 DoS공격의 대상이 될 수 있음|
|참고|※ SMTP(Simple Mail Transfer Protocol) 서버: 인터넷상에서 전자우편을 전송할 때 이용하게 되는 표준 통신 규약을 SMTP라고 하며, SMTP에 의해 전자 메일을 발신하는 서버를 SMTP 서버라고 함|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : SMTP 서비스를 사용하지 않거나 릴레이 제한이 설정되어 있는 경우 </br>취약 : SMTP 서비스를 사용하며 릴레이 제한이 설정되어 있지 않은 경우|
|조치방법|Sendmail 서비스를 사용하지 않을 경우 서비스 중지 </br>사용할 경우 릴레이 방지 설정 또는, 릴레이 대상 접근 제어|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|SMTP 서비스 사용 여부 및 릴레이 제한 옵션 확인 </br>#ps -ef \| grep sendmail \| grep -v "grep" </br>#cat /etc/mail/sendmail.cf \| grep "R$\\\*" \| grep "Relaying denied"|
||"SMTP" 서비스가 실행중이며, 위에 제시한 설정이 적용되지 않은 경우 아래의 보안설정방법에 따라 설정을 변경함|

||sendmail.cf 설정파일 위치|
|:-:|:-|
|SOLARIS, LINUX, AIX, HP-UX|"/etc/mail/sendmail.cf"|
||sendmail 버전에 따라 /etc/sendmail.cf 존재함|

* **SOLARIS, LINUX, HP-UX, AIX**
* Step 1) vi 편집기를 이용하여 sendmail.cf 설정파일 열기
* Step 2) 아래와 같이 주석 제거
  * (수정 전) #R\$\* \$\# error \$ \@ 5.7.1 \$\: "550 Relaying denied"
  * (수정 후) R\$\* \$\# error \$ \@ 5.7.1 \$\: "550 Relaying denied"
* Step 3) 특정 IP, domain, Email Address 및 네트워크에 대한 sendmail 접근 제한 확인 (없을 시 파일생성)
  * cat /etc/mail/access
```
예)
 localhost.localdomain RELAY
 localhost             RELAY
 127.0.0.1             RELAY
 spam.com              REJECT
```
* Step 4) 수정을 했거나 생성했을 경우 DB 파일 생성
  * #makemap hash /etc/mail/access.db < /etc/mail/access 

## 3.14 일반사용자의 Sendmail 실행 방지

||취약점 개요|
|:-:|:-|
|점검내용|SMTP 서비스 사용 시 일반사용자의 q 옵션 제한 여부 점검|
|점검목적|일반사용자의 q 옵션을 제한하여 Sendmail 설정 및 메일큐를 강제적으로 drop 시킬 수 없게 하여 비인가자에 의한 SMTP 서비스 오류 방지|
|보안위협|일반 사용자가 q 옵션을 이용해서 메일큐, Sendmail 설정을 보거나 메일큐를 강제적으로 drop 시킬 수 있어 악의적으로 SMTP 서버의 오류를 발생시킬 수 있음|
|참고|※ SMTP: 인터넷상에서 전자우편을 전송할 떄 이용하게 되는 표준 통신 규약을 말함|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : SMTP 서비스 미사용 또는, 일반 사용자의 Sendmail 실행 방지가 설정된 경우 </br>취약 : SMTP 서비스 사용 및 일반 사용자의 Sendmail 실행 방지가 설정되어 있지 않은 경우|
|조치방법|Sendmail 서비스를 사용하지 않을 경우 서비스 중지 </br>Sendmail 서비스를 사용 시 sendmail.cf 설정파일에 restrictqrun 옵션 추가 설정|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|SMTP 서비스 사용 여부 및 restrictqrun 옵션 확인 </br>#ps -ef | grep sendmail | grep -v "grep" </br>#grep -v '\^ \*\#' /etc/mail/sendmail.cf \| grep PrivacyOptions|
||"SMTP" 서비스가 실행중이며, 위에 제시한 설정이 적용되지 않은 경우 아래의 보안설정방법에 따라 설정을 변경함|

* **SOLARIS, LINUX, AIX, HP-UX**
* Step 1) vi 편집기를 이용하여 sendmail.cf 설정파일 열기
* Step 2) O PrivacyOptions= 설정 부분에 restrictqrun 옵션 추가
  * (수정 전) O PrivacyOptions=authwarnings, novrfy, noexpn
  * (수정 후) O PrivacyOptions=authwarnings, novrfy, noexpn, restrictqrun
* Step 3) Sendmail 서비스 재시작

## 3.15 DNS 보안 버전 패치

||취약점 개요|
|:-:|:-|
|점검내용|BIND 최신버전 사용 유무 및 주기적 보안 패치 여부 점검|
|점검목적|취약점이 발표되지 않은 BIND 버전의 사용을 목적으로 함|
|보안위협|최신버전(2016.01 기준 9.10.3-P2) 이하의 버전에서는 서비스거부 공격, 버퍼 오버플로우 및 DNS 서버 원격 침입 등의 취약성 존재함|
|참고|※ BIND(Berkeley Internet Name Domain): BIND는 BSD 기반의 유닉스 시스템을 위해 설계된 DNS로 서버와 resolver 라이브러리로 구성되어 있음. 네임서버는 클라이언트들이 이름 자원들이나 객체들에 접근하여, 네트워크 내의 다른 객체들과 함께 정보를 공유할 수 있게 해주는 네트워크 서비스로 사실상 컴퓨터 네트워크 내의 객체들을 위한 분산 데이터베이스 시스템임|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : DNS 서비스를 사용하지 않거나 주기적으로 패치를 관리하고 있는 경우 </br>취약 : DNS 서비스를 사용하며 주기적으로 패치를 관리하고 있지 않는 경우|
|조치방법|DNS 서비스를 사용하지 않을 경우 서비스 중지, 사용할 경우 패치 관리 정책을 수립하여 주기적으로 패치 적용 </br>※ DNS 서비스의 경우 대부분의 버전에서 취약점이 보고되고 있기 때문에 O/S 관리자, 서비스 개발자가 패치 적용에 따른 서비스 영향 정도를 정확히 파악하여 주기적인 패치 적용 정책 수립 후 적용|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|DNS 서비스 사용 및 BIND 버전 확인 </br>#ps -ef \| grep named |
||"DNS" 서비스를 사용하지 않는 경우 서비스 중지 </br>"DNS" 서비스 사용 시 BIND 버전 확인 후 아래의 보안설정방법에 따라 최신 버전으로 업데이트|

* **SOLARIS, LINUX, AIX, HP-UX**
1. BIND는 거의 모든 버전이 취약한 상태로서 최신 버전으로 업데이트가 요구됨
2. 다음은 구체적인 BIND 취약점들이며, 취약점 관련 버전을 사용하는 시스템에서는 버전
업그레이드를 하여야 함
* Inverse Query 취약점 (Buffer Overflow) : BIND 4.9.7이전 버전과 BIND 8.1.2 이전 버전
* NXT버그 (buffer overflow) : BIND 8.2, 8.2 p1, 8.2.1버전
* solinger버그 (Denial of Service) : BIND 8.1 이상버전
* fdmax 버그 (Denial of Service) : BIND 8.1 이상버전
* Remote Execution of Code(Buffer Overflow) : BIND 4.9.5 to 4.9.10, 8.1, 8.2 to 8.2.6,
8.3.0 to 8.3.3 버전
* Multiple Denial of Service: BIND 8.3.0 - 8.3.3, 8.2 - 8.2.6 버전
* LIBRESOLV: buffer overrun(Buffer Overflow) : BIND 4.9.2 to 4.9.10 버전
* OpenSSL (buffer overflow) : BIND 9.1, BIND 9.2 if built with OpenSSL(configure
--with-openssl)
* libbind (buffer overflow) : BIND 4.9.11, 8.2.7, 8.3.4, 9.2.2 이외의 모든 버전
* DoS internal consistency check (Denial of Service) : BIND 9 ~ 9.2.0 버전
* tsig bug (Access possible) : BIND 8.2 ~ 8.2.3 버전
* complain bug (Stack corruption, possible remote access) : BIND 4.9.x 거의 모든 버전
* zxfr bug (Denial of service) : BIND 8.2.2, 8.2.2 patchlevels 1 through 6 버전
* sigdiv0 bug (Denial of service) : BIND 8.2, 8.2 patchlevel 1, 8.2.2 버전
* srv bug(Denial of service): BIND 8.2, 8.2 patchlevel 1, 8.2.1, 8.2.2, 8.2.2 patchlevels 1-6
버전
* nxt bug (Access possible) : BIND 8.2, 8.2 patchlevel 1, 8.2.1 버전
* BIND 4.9.8 이전 버전, 8.2.3 이전 버전과 관련된 취약점
* TSIG 핸들링 버퍼오버플로우 취약점
* nslookupComplain() 버퍼오버플로우 취약점
* nslookupComplain() input validation 취약점
* information leak 취약점
* sig bug Denial of service 취약점
* naptr bug Denial of service 취약점
* maxdname bug enial of service 취약점

※ Bind 최신버전 다운로드 사이트   
http://www.isc.org/downloads/   
※ 각 버전에 대한 취약점 정보 사이트   
(1) BIND 8 Vulnerability matrix :   
https://kb.isc.org/article/AA-00959/0/BIND-8-Security-Vulnerability-Matrix.html   
(2) BIND 9 Vulnerability matrix :   
https://kb.isc.org/article/AA-00913/74/BIND-9-Security-Vulnerability-Matrix.html   

### 조치 후 영향
패치를 적용 시 시스템 및 서비스 영향 정도를 충분히 고려하여야 함

## 3.16 DNS Zone Transfer 설정

||취약점 개요|
|:-:|:-|
|점검내용|Secondary Name Server로만 Zone 정보 전송 제한 여부 점검|
|점검목적|허가되지 않는 사용자에게 Zone Transfer를 제한함으로써 호스트 정보, 시스템 정보 등 정보 유출의 방지를 목적으로 함|
|보안위협|비인가자 Zone Transfer를 이용해 Zone 정보를 전송받아 호스트 정보, 시스템 정보, 네트워크 구성 형태 등의 많은 정보를 파악할 수 있음|
|참고|※ DNS Zone Transfer는 Primary Name Server와 Secondary Name Server 간에 Zone 정보를 일관성 있게 유지하기 위하여 사용하는 기능|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : DNS 서비스 미사용 또는, Zone Transfer를 허가된 사용자에게만 허용한 경우 </br>취약 : DNS 서비스를 사용하며 Zone Transfer를 모든 사용자에게 허용한 경우|
|조치방법|DNS 서비스를 사용하지 않을 경우 서비스 중지, 사용한다면 DNS 설정을 통해 내부 Zone 파일을 임의의 외부 서버에서 전송 받지 못하게 하고, 아무나 쿼리 응답을 받을 수 없도록 수정|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|

||< DNS 서비스를 사용할 경우 >|
|:-:|:-|
|SOLARIS, LINUX, AIX, HP-UX|DNS 서비스 사용 시 /etc/named.conf 파일의 allow-transfer 및 xfrnets 확인 </br>#ps -ef \| grep named \| grep -v "grep" </br>#cat /etc/named.conf \| grep 'allow-transfer' </br>#cat /etc/named.boot \| grep "xfrnets"|
||"DNS" 서비스 사용 시 위에 제시된 파일의 DNS 설정을 아래의 보안설정방법에 따라 수정함|

* **BIND8 DNS 설정(named.conf) 수정 예**
```
OPtions {
  allow-transfer (존 파일 전송을 허용하고자 하는 IP;);
};
```

* **BIND4.9 DNS 설정(named.conf) 수정 예**
```
OPtions 
  xfrnets 허용하고자 하는 IP
```

||< DNS 서비스를 사용하지 않는 경우 >|
|:-:|:-|
|LINUX, AIX, HP-UX, SOLARIS 5.9 이하 버전|DNS 서비스 데몬 확인 (DNS 동작 SID 확인) </br>#ps -ef \| grep named|
|SOLARIS 5.10 이상 버전|#svcs -a \| egrep "dns"|
||"DNS" 서비스를 사용하지 않는 경우 서비스 데몬 중지|

* **LINUX, AIX, HP-UX, SOLARIS 5.9 이하 버전**
* DNS 서비스 데몬 중지
  * #kill -9 [PID]
 
* **SOLARIS 5.10 이상 버전**
* Step 1) DNS 서비스 데몬 확인
  * enabled 16\:22\:31 svc\:/network/dns/server\:default
* Step 2) svcadm disable "중지하고자 하는 데몬" 명령으로 서비스 데몬 중지
  * svcadm disable svc\:/network/dns/server\:default  


## 3.17 웹서비스 디렉토리 리스팅 제거

||취약점 개요|
|:-:|:-|
|점검내용|디렉터리 검색 기능의 활성화 여부 점검|
|점검목적|외부에서 디렉터리 내의 모든 파일에 대한 접근 및 열람을 제한함을 목적으로 함|
|보안위협|디렉터리 검색 기능이 활성화 되어 있을 경우, 사용자에게 디렉터리내 파일이 표시되어 WEB 서버 구조 노출뿐만 아니라 백업 파일이나 소스파일, 공개되어서는 안되는 파일 등이 노출 가능함|
|참고|-|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 디렉터리 검색 기능을 사용하지 않는 경우 </br>취약 : 디렉터리 검색 기능을 사용하는 경우|
|조치방법|디렉터리 검색 기능 제거 (/[Apache_home]/conf/httpd.conf 파일에 설정된 모든 디렉터리의 Options 지시자에게 Indexes 옵션 제거)|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|Indexes 옵션 사용 여부 확인 </br>#vi /[Apache_home]/conf/httpd.conf|
||위에 제시한 파일에 "Indexes" 옵션이 설정된 경우 아래의 보안설정방법에 따라 옵션 설정 변경|

* **SOLARIS, LINUX, AIX, HP-UX**
* Step 1) vi 편집기를 이용하여 /[Apache_home]/conf/htpd.conf 파일 열기
  * #vi /[Apache_home]/conf/httpd.conf
* Step 2) 설정된 모든 디렉터리의 Options 지시자에서 Indexed 옵션 제거
  * (수정 전) Options 지시자에 Indexes 옵션이 설정되어 있음
```
<Directory />
  Options Indexes FollowSymLinks
  AllowOverride None
  Order allow, deny
  Allow from all
</Directory>
```
  * (수정 후) Option 지시자에 Indexes 삭제 또는 -Indexes 변경 후 저장
```
<Directory />
  Options Indexes 삭제 (또는 -Indexes)
  AllowOverride None
  Order allow, deny
  Allow from all
</Directory>
```
