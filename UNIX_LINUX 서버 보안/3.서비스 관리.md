# 3.서비스 관리
## 3.1 Finger 서비스 비활성

||취약점 개요|
|:-:|:-|
|점검내용|finger 서비스 비활성화 여부 점검|
|점검목적|Finger(사용자 정보 확인 서비스)를 통해서 네트워크 외부에서 해당 시스템에 등록된 사용자 정보를 확인할 수 있어 비인가자에게 사용자 정보가 조회되는 것을 차단하고자 함|
|보안위협|비인가자에게 사용자 정보가 조회되어 패스워드 공격을 통한 시스템 권한 탈취 가능성이 있으므로 사용하지 않는다면 해당 서비스를 중지하여야 함|
|참고|※ Finger(사용자 정보 확인 서비스): who 명령어가 현재 사용 중인 사용자들에 대한 간단한 정보만을 보여주는 데 반해 Finger 명령은 옵션에 따른 시스템에 등록된 사용자뿐만 아니라 네트워크를 통하여 연결되어 있는 다른 시스템에 등록된 사용자들에 대한 자세한 정보를 보여줌|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : Finger 서비스가 비활성화 되어 있는 경우 </br>취약 : Finger 서비스가 활성화 되어 있는 경우|
|조치방법|Finger 서비스 비활성화|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|LINUX, AIX, HP-UX, SOLARIS 5.9 이하 버전|#cat /etc/inetd.conf </br>#finger stream tcp nowait bin /usr/lbin/fingered </br>finered 주석처리 확인|
|SOLARIS 5.10 이상 버전|#inetadm | grep "finger"|
|LINUX (xinetd일 경우)|#ls -alL /etc/xinetd.d/* \| egrep "echo finger"|
||위에 제시된 파일 내 "finger" 서비스가 활성화된 경우 아래의 보안설정방법에 따라 서비스 중지|

* **LINUX, AIX, HP-UX, SOLARIS 5.9 이하 버전**
* Step 1) "/etc/inetd.conf" 파일에서 finger 서비스 라인 주석처리
  * (수정 전) #finger stream tcp nowait bin /usr/lbin/fingered fingerd
  * (수정 후) #finger stream tcp nowait bin /usr/lbin/fingered fingerd
* Step 2) inetd 서비스 재시작
  * #ps -ef | grep inetd
  * kill -HUP [PID]
 
* **SOLARIS 5.10 이상 버전**
  * inetadm -d "중지하고자 하는 데몬" 명령으로 서비스 데몬 중지
  * #inetadm -d svc:/network/finger:default
 
* **LINUX (xinetd일 경우)**
* Step 1) vi 편집기를 이용하여 "/etc/C/finger" 파일 열기
* Step 2) 아래와 같이 설정 (disable = yes 설정)
```
service finger
{
  socket_type    = stream
  wait           = no
  user           = nobody
  server         = /usr/sbin/in.fingerd
  disable        = yes
}
```
* Step 3) xinetd 서비스 재시작
  * #service xinetd restart

## 3.2 Anonymous FTP 비활성화

||취약점 개요|
|:-:|:-|
|점검내용|익명 FTP 접속 허용 여부 점검|
|점검목적|실행중인 FTP 서비스에 익명 FTP 접속이 허용되고 있는지 확인하여 접속허용을 차단하는 것을 목적으로 함|
|보안위협|Anonymous FTP(익명 FTP)를 사용 시 anonymous 계정으로 로그인 후 디렉터리에 쓰기 권한이 설정되어 있다면 악의적인 사용자가 local exploit을 사용하여 시스템에 대한 공격을 가능하게 함|
|참고|※ Anonymous FTP(익명 FTP): 파일 전송을 위해서는 원칙적으로 상대방 컴퓨터를 사용할 수 있는 계정이 필요하나 누구든지 계정이 없이도 anonymous 또는 ftp라는 로그인 명과 임의의 비밀번호를 사용하여 FTP를 실행할 수 있음|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : Anonymous FTP 접속을 차단한 경우 </br>취약 : Anonymous FTP 접속을 차단하지 않은 경우|
|조치방법|Anonymous FTP를 사용하지 않는 경우 Anonymous FTP 접속 차단 설정 적용|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|/etc/passwd 파일에 ftp 계정 존재 여부 확인 </br>#cat /etc/passwd | grep "ftp"|
||"passwd" 파일 내 ftp 계정이 존재하는 경우 아래의 보안설정방법에 따라 서비스 접속 제한|

* **SOLARIS, LINUX, AIX, HP-UX**
* Case 1) 일반 FTP - Anonymous FTP 접속 제한 설정 방법
  * "/etc/passwd" 파일에서 ftp 또는, anonymous 계정 삭제
  * SOLARIS, LINUX, HP-UX 설정: #userdel ftp
  * AIX 설정: #rmuser ftp
* Case 2) proFTP - Anonymous FTP 접속 제한 설정 방법
  * conf/proftpd.conf 파일의 anonymous 관련 설정 중 User, Useralias 항목 주석처리
  * (proftpd.conf 파일의 위치는 운영체제 종류별로 상이함)
  * <Anonymous ~ftp>          <- Anonymous 설정 구간
  * \# User   ftp             <- anonymous로 사용되는 계정
  * Group     ftp
  * \# UserAlias anonymous ftp <- 별칭으로 사용되는 계정
  * 이하생략
  * \</Anonymous>
* Case 3) vsFTP - Anonymous FTP 접속 제한 설정 방법
 * vsFTP 설정파일("/etc/vsftpd/vsftpd.conf" 또는, "/etc/vsftpd.conf")에서 anonymous_enable=NO 설정
 
## 3.3 r 계열 서비스 비활성화

||취약점 개요|
|:-:|:-|
|점검내용|r-command 서비스 비활성화 여부 점검|
|점검목적|r-command 사용을 통한 원격 접속은 NET Backup 또는 클러스터링 등 용도로 사용되기도 하나, 인증 없이 관리자 원격접속이 가능하여 이에 대한 보안위협을 방지하고자 함|
|보안위협|rsh, rlogin, rexec 등의 r command를 이용하여 원격에서 인증절차 없이 터미널 접속, 쉘 명령어를 실행이 가능함|
|참고|※ r-command: 인증 없이 관리자의 원격접속을 가능하게 하는 명령어들로 rsh(remsh), rlogin, rexec, rsync 등이 있음|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 불필요한 r 계열 서비스가 비활성화 되어 있는 경우 </br>취약 : 불필요한 r 계열 서비스가 활성화 되어 있는 경우|
|조치방법|NET Backup등 특별한 용도로 사용하지 않는다면 아래의 서비스 중지 </br> [shell(514)] [login(513)] [exec(512)]|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS 5.9 이하 버전|r-command 서비스 활성화 여부 확인 </br>#vi /etc/inetd.conf|
|AIX|#cat /etc/inetd.conf \| grep rlogin (#처리 되어 있으면 비활성화) </br>#cat /etc/inetd.conf \| grep rsh (#처리 되어 있으면 비활성화)|
|HP-UX|#vi /etc/inetd.conf </br>r로 시작하는 필드 존재 시 취약|
|SOLARIS 5.10 이상 버전|#inetadm \| egrep "shell\|rlogin\|rexec" </br>r command 관련 데몬 확인|
|LINUX (xinetd일 경우)|rsh, rlogin, rexec (shell, login, exec) 서비스 구동 확인 </br>#ls -alL /etc/xinetd.d/* \| egrep "rsh\|rlogin\|rexec" \| egrep -v "grep\|klogin\|kshell\|kexec"|
||위에 제시된 파일 내 "r-command계열" 서비스가 활성화 된 경우 아래의 보안설정 방법에 따라 서비스 지|

* **SOLARIS 5.9 이하, HP-UX**
* Step 1) r 계열 서비스 활성화 여부 확인
  * vi /etc/inetd.conf
* Step 2) r로 시작하는 필드 주석처리 후 재가동
  * (수정 전) shell stream tcp nowait root /usr/sbin/in.rshd in.rshd
  * (수정 후) #shell stream tcp nowait root /usr/sbin/in.rshd in.rshd
* SOLARIS) #kill -HUP [inetd PID]
* HP-UX #inetd -c
* **AIX**
* Step 1) r 계열 서비스 활성화 여부 확인
  * #cat /etc/inetd.conf | grep rlogin (# 처리 되어 있으면 비활성화)
  * #cat /etc/inetd.conf | grep rsh (# 처리 되어 있으면 비활성화)
  * #cat /etc/inetd.conf | grep exec (# 처리 되어 있으면 비활성화)
* Step 2) /etc/hosts.equiv 파일은 TRUSTED 시스템을 등록
* Step 3) .rhosts 파일은 사용자 별로 'r'command를 통해 접근이 가능하도록 설정할 수 있음 ($HOME/.rhosts)

* **SOLARIS 5.10 이상 버전**
* Step 1) r'command 관련 데몬 확인
  * svc\:/network/login\:rlogin
  * svc\:/network/rexec\:default
  * svc\:/network/shell\:kshell
* Step 2) inetadm -d "중지하고자 하는 데몬" 명령으로 데몬 중지
  * #inetadm -d svc\:/network/login\:rlogin
  * #inetadm -d svc\:/network/rexec\:default
  * #inetadm -d svc\:/network/shell\:kshell
 
* **LINUX (xinetd일 경우)**
* Step 1) vi 편집기를 이용하여 "/etc/xinetd.d/"
* Step 2) 아래와 같이 설정 (Disable = yes 설정)
```
/etc/xinetd.d/rlogin 파일
/etc/xinetd.d/rsh 파일
/etc/xinetd.d/rexec 파일

service rlogin
{
 socket_type     = stream
 wait            = no
 user            = nobody
 log_on_success += USERID
 log_on_failure += USERID
 server          = /usr/sdin/in.fingerd
 disable         = yes
}
```
* Step 3) xinetd 서비스 재시작
  * #service xinetd restart
* r-command 사용시 보안설정
* Step 1) r command 사용을 허용하는 호스트 및 계정 설정
  * -.rhosts, hosts.equiv 파일에 접근을 허용하는 hostname(IP) 명시
  * IP 등록시 공인 IP 설정은 금지
  * .rhosts, hosts.equiv 파일의 퍼미션을 600 이하로 설정
  * 필요시 TCP Wrapper를 이용하여 접근을 허용하는 IP를 등록하여 추가 보안 설정
 
### 조치 시 영향
rlogin, rshell, rexec 서비스는 backup, 클러스터링 등의 용도로 종종 사용되고 있으므로 해당 서비스 사용 유무를 확인하여 미사용시 서비스 중지 </br> (/etc/hosts.equiv 또는 각 홈 디렉터리 밑에 있는 .rhosts 파일에 설정 유무를 확인하여 해당 서비스 사용여부 확인 - 파일이 존재하지 않거나 해당파일 내에 설정이 없다면 사용하지 않는것으로 파악)

## 3.4 crond 파일 소유자 및 권한 설정

||취약점 개요|
|:-:|:-|
|점검내용|Cron 관련 파일의 권한 적절성 점검|
|점검목적|관리자외 cron 서비스를 사용할 수 없도록 설정하고 있는지 점검하는 것을 목적으로 함|
|보안위협|root 외 일반사용자에게도 crontab 명령어를 사용할 수 있도록 할 경우, 고의 또는 실수로 불법적인 예약 파일 실행으로 시스템 피해를 일으킬 수 있음|
|참고|※ Cron 시스템: 특정 작업을 정해진 시간에 주기적이고 반복적으로 실행하기 위한 데몬 및 설정 </br>※ cron.allow: 사용자 ID를 등록하면 등록된 사용자는 crontab 명령어 사용이 가능함 </br>※ cron.deny: 사용자 ID를 등록하면 등록된 사용자는 crontab 명령어 사용이 불가능함|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : crontab 명령어 일반사용자 금지 및 cron 관련 파일 640 이하인 경우 </br>취약 : crontab 명령어 일반사용자 사용가능하거나, crond 관련 파일 640 이상인 경우|
|조치방법|crontab 명령어 750 이하, cron 관련 파일 소유자 및 권한 변경(소유자 root, 권한 640 이하)|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, LINUX, AIX, HP-UX|Cron 관련 파일 권한 확인 </br>#ls -al /usr/bin/crontab </br>rw-r----- root <cron 접근제어 파일>|

||OS별 점검 파일 위치||
|-|-|-|
|SOLARIS|/etc/cron.d/|crontab  <- 예약작업을 등록하는 파일 </br>cron.hourly  <- 시간단위 실행 스크립트 등록 </br>cron.daily  <- 일단위 실행 스크립트 등록 </br>cron.weekly  <- 주단위 실행 스크립트 등록 </br>cron.monthly  <- 월 단위 실행 스크립트 등록 </br>cron.allow  <- crontab 명령어 허용 사용자 </br>cron.deny  <- crontab 명령어 차단 사용자|
|LINUX|/etc/||
|AIX, HP-UX|/var/adm/cron/||
|공통|/var/spool/cron/ 또는 /var/spool/cron/crontabs/|사용자별 설정된 cron 작업 목록|
||"cron" 접근제어 설정이 적절하지 않은 경우 아래의 보안설정방법에 따라 설정을 변경함||

* **공통설정**
* Step 1) crontab 명령어 일반사용자 권한 삭제 (crontab 명령어 위치는 OS별 다를 수 있음)
* crontab 명령어는 SUID가 설정되어 있으므로 SUID 설정 제거
  * #ls -al /usr/bin/crontab
  * #chmod 750 /usr/bin/crontab
* Step 2) cron 관련 설정파일 소유자 및 권한 설정
  * chown root <cron 관련 파일>
  * chmod 640 <cron 관련 파일>

* **crontab 명령어를 일반사용자에게 허용하는 경우**
* Step 1) "/etc/cron.d/corn.allow" 및 "/etc/cron.d/cron.deny" 파일의 소유자 및 권한 변경
  * #chown root /etc/cron.d/cron.allow
  * #chmod 640 /etc/cron.d/cron.allow
  * #chown root /etc/cron.d/cron.deny
  * #chmod 640 /etc/cron.d/cron.deny
* Step 2) "/etc/cron.d/cron.allow" 및 "/etc/cron.d/cron.deny" 파일에 사용자 등록
  * #cat /etc/cron.allow (crontab 명령어 사용을 허용하는 사용자 등록)
  * #cat /etc/cron.deny (crontab 명령어 사용을 차단하는 사용자 등록)  

## 3.5 DoS 공격에 취약한 서비스 비활성화

||취약점 개요|
|:-:|:-|
|점검내용|사용하지 않는 DoS 공격에 취약한 서비스의 실행 여부 점검|
|점검목적|시스템 보안성을 높이기 위해 취약점이 많이 발표된 echo, discard, daytime, chargen, ntp, snmp 등 서비스를 중지함|
|보안위협|해당 서비스가 활성화되어 있는 경우 시스템 정보 유출 및 DoS(서비스 거부 공격)의 대상이 될 수 있음|
|참고|※ DoS(Denial of Service): 시스템을 악의적으로 공격해 해당 시스템의 자원을 부족하게 하여 원래 의도된 용도로 사용하지 못하게 하는 공격. 특정 서버에게 수많은 접속시도를 만들어 다른 이용자가 정상적으로 서비스 이용을 하지 못하게 하거나, 서버의 TCP 연결을 바닥내는 등의 공격이 이 범위에 포함됨|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 사용하지 않는 DoS 공격에 취약한 서비스가 비활성화 된 경우 </br>취약 : 사용하지 않는 DoS 공격에 취약한 서비스가 활성화 된 경우|
|조치방법|echo, discard, daytime, charge, ntp, dns, snmp 등 서비스 비활성화 설정|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS|#svcs -a \| grep echo </br>#svcs -a \| grep daytime </br>#svcs -a \| grep discard </br>#svcs -a \|chargen </br>echo, discard, daytime, chargen 서비스 활성 여부 확인|
|AIX, HP-UX|#vi /etc/inetd.conf </br>echo, discard, daytime, chargen 필드 주석처리 확인|
|SOLARIS 5.10 이상 버전|#inetadm \| grep enable \| egrep "echo\|discard\|daytime\|chargen" 명령으로 기타 서비스 데몬 확인|
||아래 제시된 DoS 공격에 취약한 서비스 중 사용하지 않는 서비스가 활성화 된 경우 아래의 보안설정방법에 따라 서비스 중지|

||DoS 공격에 취약한 서비스 예시|
|:-:|:-|
|echo(7)|클라이언트에서 보내는 메시지를 단순히 재전송|
|discard(9)|수신되는 임의 사용자의 데이터를 폐기하는 서비스|
|daytime(13)|daytime은 클라이언트의 질의에 응답하여 아스키 형태로 현재 시간과 날짜를 출력하는 데몬|
|chargen(19)|임의 길이의 문자열을 반환하는 서비스|
|NTP(123)|네트워크로 연결되어 있는 컴퓨터들끼리 클록 시각을 동기화시키는데 사용되는 서비스|
|DNS(53)|호스트의 도메인 이름을 호스트의 네트워크 주소로 바꾸거나 그 반대의 변환을 수행하는데 사용되는 서비스|
|SNMP(161/162)|네트워크 장비들로부터 필요한 정보를 가져와 장비 상태를 모니터링 하거나 설정값을 변경하는 등의 작업을 하여 네트워크 장비를 관리하는데 사용되는 서비스|
|SMTP(25)|인터넷에서 메일을 보내기 위해 사용되는 서비스|

* **SOLARIS**
* Step 1) echo 서비스 비활성화 설정
  * svcs -a | grep echo
  * svcadm disable svc\:/network/echo\:dgrm
  * svcadm disable svc\:/network/echo\:stream 
* Step 2) discard 서비스 비활성화 설정
  * svcs -a | grep discard
  * svcadm disable svc\:/network/discard\:dgrm
  * svcadm disable svc\:/network/discard\:stream
* Step 3) daytime 서비스 비활성화 설정
  * svcs -a | grep daytime
  * svcadm disable svc\:/network/daytime\:dgrm
  * svcadm disable svc\:/network/daytime\:stream
* Step 4) chargen 서비스 비활성화 설정
  * svcs -a | grep chargen
  * svcadm disable svc\:/network/chargen\:dgrm
  * svcadm disable svc\:/network/chargen\:stream

* **AIX**
* Step 1) vi 편집기를 이용하여 echo, discard, daytime, chargen 필드 주석처리
  * #vi /etc/inetd.conf
  * #echo  stream  tcp  nowait  root  internal
  * #discard  stream  tcp  nowait  root  internal
  * #daytime  stream  tcp  nowait  root  internal
  * #chargen  stream  tcp  nowait  root  internal
  * #echo  dgram  udp  wait  root  internal
  * #discard  dgram  udp  wait  root  internal
  * #daytime  dgram  udp  wait  root  internal 
  * #chargen  dgram  udp  wait  root  internal
* Step 2) 필드 주석처리 후 재가동
  * #refresh -s inetd

* **HP-UX**
* Step 1) vi 편집기를 이용하여 echo, discard, daytime, chargen 필드 주석처리
  * #vi /etc/inetd.conf
  * #echo  stream  tcp6  nowait  root  internal
  * #discard  stream  tcp6  nowait  root  internal
  * #daytime  stream  tcp6  nowait  root  internal
  * #chargen  stream  tcp6  nowait  root  internal
  * #echo  dgram  udp  nowait  root  internal
  * #discard  dgram  udp6  nowait  root  internal
  * #daytime  dgram  udp6  nowait  root  internal 
  * #chargen  dgram  udp6  nowait  root  internal
* Step 2) 필드 주석처리 후 재가동
  * #inetd -c

* **SOLARIS 5.10 이상 버전**
* Step 1) 기타 서비스 데몬 확인
  * #inetadm | grep echo
  * #inetadm | grep daytime
  * #inetadm | grep discard
  * #inetadm | grep chargen
* Step 2) inetadm -d "중지하고자 하는 데몬" 명령으로 서비스 데몬 중지
  * #inetadm -d svc\:/network/echo\:stream
 
* **LINUX (xinetd일 경우)**
* Step 1) vi 편집기를 이용하여 "/etc/xinetd.d/" 디렉터리 내 echo, discard, daytime, chargen 파일 열기
* Step 2) 아래와 같이 설정 (Disable = yes 설정)
```
/etc/xinetd.d/echo 파일(echo-dgram, echo-stream)
/etc/xinetd.d/discard 파일(discard-dgram, discard-stream)
/etc/xinetd.d/daytime 파일(daytime-dgram, daytime-stream)
/etc/xinetd.d/chargen 파일(chargen-dgram, chargen-stream)

service echo
{
  disable     = yes
  id          = echo-stream
  type        = internal
  wait        = no
  socket_type = stream
}
```
* Step 3) xinetd 서비스 재시작
  * #service xinetd restart 

## 3.6 NFS 서비스 비활성화


||취약점 개요|
|:-:|:-|
|점검내용|불필요한 NFS 서비스 사용여부 점검|
|점검목적|NFS(Network File System) 서비스는 한 서버의 파일을 많은 서비스 서버들이 공유하여 사용할 때 많이 이용되는 서비스이지만 이를 이용한 침해사고 위험성이 높으므로 사용하지 않는 경우 중지함|
|보안위협|NFS 서비스는 서버의 디스크를 클라이언트와 공유하는 서비스로 적정한 보안설정이 적용되어 있지 않다면 불필요한 파일 공유로 인한 유출위험이 있음|
|참고|※ NFS: 원격 컴퓨터의 파일시스템을 로컬 시스템에 마운트하여 마치 로컬 파일시스템처럼 사용할 수 있는 프로그램임 </br>※ NFS 서비스 사용은 원칙적으로 금지되어 있지만 불가피하게 필요한 경우 통제해야함|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 불필요한 NFS 서비스 관련 데몬이 비활성화 되어 있는 경우 </br>취약 : 불필요한 NFS 서비스 관련 데몬이 활성화 되어 있는 경우|
|조치방법|사용하지 않는다면 NFS 서비스 중지 </br>아래의 방법으로 NFS 서비스를 제거한 후 시스템 부팅 시, 스크립트 실행 방지가능 </br>1. /etc/dfs/dfstab(또는 /etx/exports)의 모든 공유 제거 </br>2. NFS 데몬(nfsd, statd, mountd) 중지 </br>3. 시동 스크립트 삭제 또는, 스크립트 이름 변경|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|LINUX, AIAX, HP-UX, SOLARIS 5.9 이하 버전|NFS 서비스 데몬 확인 (NFS 동작 SID 확인) </br>#ps -ef | egrep "nfs\|statd\|lockd"|
|SOLARIS 5.10 이상 버전|#inetadm \| egrep "nfs\|statd\|locked"|
||불필요한 "NFS" 서비스가 활성화된 경우 아래의 보안설정방법에 따라 서비스 데몬 중지|

* **LINUX, AIX, SOLARIS 5.9 이하 버전**
* Step 1) NFS 서비스 데몬 중지
  * #kill -9 [PID]
* Step 2) 시동 스크립트 삭제 또는, 스크립트 이름 변경
  * 1. 위치 확인
  * #ls -al /etc/rc.d/rc\*.d/\* | grep nfs
  * 2. 이름 변경
  * #mv /etc/rc.d/rc2.d/S60nfs /etc/rc.d/rc2.d/_S60nfs
* Step 3) 서비스 종료 후 비활성화
  * systemctl stop nfs
  * systemctl disable nfs 

* **HP-UX**
* Step 1) NFS 서비스 데몬 중지
  * kill -9 [PID]
* Step 2) /etc/rc.config.d/nfsconf 파일 설정 수정
  * vi /etc/rc.config.d/nfsconf
  * (수정 전) NFS_SERVER=1
  * (수정 후) NFS_SERVER=0

* **SOLARIS 5.10 이상 버전 설정 방법**
* Step 1) NFS 서비스 데몬 확인
  * svc\:/network/nfs/server\:default
* Step 2) inetadm -d "중지하고자 하는 데몬" 명령으로 서비스 데몬 중지
  * inetaadm -d svc\:/network/nfs/server\:default
 
### 조치 시 영향
showmount, share, exportfs 등의 명령어를 사용하여 로컬 서버에 마운트 되어 있는 디렉터리 확인 및 NFS 설정파일에 공유디렉터리 설정 여부 확인 후 해당 디렉터리가 존재하지 않을 경우 서비스 중지 가능

## 3.7 NFS 접근 통제

||취약점 개요|
|:-:|:-|
|점검내용|NFS 사용 시 허가된 사용자만 접속할 수 있도록 접근제한 설정 적용 여부 점검|
|점검목적|접근권한이 없는 비인가자의 접근을 통제함|
|보안위협|접근제한 설정이 적절하지 않을 경우 인증절차 없이 비인가자의 디렉터리나 파일의 접근이 가능하며, 해당 공유 시스템에 원격으로 마운트하여 중요 파일을 변조하거나 유출할 위험이 있음|
|참고|※ NFS: 원격 컴퓨터의 파일시스템을 로컬 시스템에 마운트하여 마치 로컬 파일시스템처럼 사용할 수 있는 프로그램임 </br>※ NFS 서비스 사용 금지가 원칙이나 불가피하게 사용이 필요한 경우 NFS v2, v3은 평문으로 전송되는 취약점이 있기 때문에 암호화되는 v4를 사용하는 것을 권고함|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : 불필요한 NFS 서비스를 사용하지 않거나, 불가피하게 사용 시 everyone 공유를 제한한 경우 </br>취약 : 불필요한 NFS 서비스를 사용하고 있고, everyone 공유를 제한하지 않은 경우|
|조치방법|사용하지 않는다면 NFS 서비스 중지, 사용할 경우 NFS 설정파일에 everyone 공유 설정 제거|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|SOLARIS, HP-UX|/etc/dfs/dfstab, /etc/dfs/sharetab 파일|
|LINUX, AIX, HP-UX|/etc/exoirts 파일|
||불가피하게 NFS 서비스를 사용하여야 하는 경우 NFS 접근제어 파일에 꼭 필요한 공유 디렉터리만 나열하고, everyone으로 시스템이 마운트 되지 않도록 설정|

* **/etc/dfs/dfstab 설정 예문**
* rw=client, ro=client 형식으로 접속 허용 client 지정
  * 사용자의 읽기, 쓰기 권한 접속 허용 : share -F nfs -o rw, ro /export/home/test
  * 사용자의 권한 접속 제한: share -F nfs -o rw=client1\:client2, ro=client1\:client2 /export/home/test
  * 읽기(ro), 쓰기(rw) 권한에 각각 사용자를 설정하여야 읽기, 쓰기 권한 모두 제한 가능

* **/etc/export 설정 예문**
* Step 1) /etc/exports 파일에 접근 가능한 호스트명 추가
  * (예) /stand host1(또는 IP주소) host2
* Step 2) 접속 시 인증 및 클라이언트 권한 nobody 설정
  * vi /etc/export
  * /stand host1 (root_squash)
  * () 옵션에 인증되지 않은 액세스를 허용하는 "insecure" 구문 설정 금지
* Step 3) NFS 서비스 재구동
  * #/etc/exportfs -u
  * #/etc/exportfs -a

### 조치 시 영향
showmount, share, exportfs 등의 명령어를 사용하여 로컬 서버에 마운트 되어 있는 디렉터리 확인 및 NFS 설정파일에 공유디렉터리 설정 여부 확인 후 해당 디렉터리가 존재하지 않을 경우 서비스 중지 가능

## 3.8 automountd 제거

||취약점 개요|
|:-:|:-|
|점검내용|automountd 서비스 데몬의 실행 여부 점검|
|점검목적|로컬 공격자가 automountd 데몬에 RPC(Remote Procedure Call)를 보낼 수 있는 취약점이 존재하기 때문에 해당 서비스가 실행중일 경우 서비스를 중지시키기 위함|
|보안위협|파일 시스템의 마운트 옵션을 변경하여 root 권한을 획득할 수 있으며, 로컬 공격자가 automountd 프로세스 권한으로 임의의 명령을 실행할 수 있음|
|참고|※ automountd: 클라이언트에서 자동으로 서버에 마운트를 시키고 일정 시간 사용하지 않으면 unmount 시켜 주는 기능을 말함 </br>※ RPC: 별도의 원격 제어를 위한 코딩 없이 다른 주소 고|
||점검대상 및 판단기준| 
|대상|SOLARIS, LINUX, AIX, HP-UX 등|
|판단기준|양호 : automountd 서비스가 비활성화 되어 있는 경우 </br> 취약 : automountd 서비스가 활성화 되어 있는 경우|
|조치방법|automountd 서비스 비활성|
||점검 및 조치 사례|
||OS별 점검 파일 위치 및 점검 방법|
|LINUX, AIX, HP-UX, SOLARIS 5.9 이하 버전|automountd 서비스 데몬 확인 (automountd 동작 SID 확인) </br>#ps -ef \| grep automount(or autofs)|
|||
